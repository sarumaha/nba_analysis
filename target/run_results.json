{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-11-21T00:11:30.533453Z", "invocation_id": "51d43b90-cbfe-40df-a614-bdd55dd963d5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:10:50.510572Z", "completed_at": "2024-11-21T00:10:50.519580Z"}, {"name": "execute", "started_at": "2024-11-21T00:10:50.519954Z", "completed_at": "2024-11-21T00:10:52.277954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.3139169216156006, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820a-0102-3547-0006-c35e00066366"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.src_games", "compiled": true, "compiled_code": "with raw_games AS (\nSELECT * FROM NBA_GAMES.RAW.GAMES\n)\nSELECT \nCAST(GAME_DATE_EST AS DATE) as game_date_est,\nCAST(GAME_ID AS INT) as games_game_id,\nGAME_STATUS_TEXT as game_status_text,\nCAST(HOME_TEAM_ID AS INT) as home_team_id, \nCAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,\nSEASON as season,\nCAST(\"TEAM_ID_home\" AS INT) as team_id_home,\n\"PTS_home\" as pts_home,\n\"FT_PCT_home\" as ft_pct_home,\n\"FG3_PCT_home\" as fg3_pct_home,\n\"AST_home\" as ast_home,\n\"REB_home\" as reb_home,\nCAST(\"TEAM_ID_away\" AS INT) as team_id_away,\n\"PTS_away\" as pts_away,\n\"FG_PCT_away\" as fg_pct_away,\n\"FT_PCT_away\" as ft_pct_away,\n\"FG3_PCT_away\" as fg3_pct_away,\n\"AST_away\" as ast_away,\n\"REB_away\" as reb_away,\nHOME_TEAM_WINS as home_team_wins\nFROM raw_games", "relation_name": "NBA_GAMES.DEV.src_games"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:10:52.829363Z", "completed_at": "2024-11-21T00:10:52.833045Z"}, {"name": "execute", "started_at": "2024-11-21T00:10:52.833660Z", "completed_at": "2024-11-21T00:10:54.990406Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.6681928634643555, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820a-0102-3549-0006-c35e0006556a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.src_games_details", "compiled": true, "compiled_code": "WITH raw_games_details as (\nSELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS\n)\n\nSELECT \nCAST(GAME_ID AS INT) as details_game_id,\nCAST(TEAM_ID AS INT) as details_team_id,\nTEAM_ABBREVIATION as team_abbreviation,\nTEAM_CITY as team_city,\nCAST(PLAYER_ID AS INT) as player_id,\nPLAYER_NAME as player_name,\nNICKNAME as player_nickname,\nSTART_POSITION as player_start_position,\nCOMMENT as comment_text, \nMIN as games_min,\nFGM as fgm,\nFGA as fga,\nFG_PCT as fg_pct,\nFG3M as fg3m,\nFG3A as fg3a,\nFG3_PCT as fg3_pct,\nFTM as ftm,\nFTA as fta,\nFT_PCT as ft_pct,\nOREB as oreb,\nDREB as dreb,\nREB as reb,\nAST as ast,\nSTL as stl,\nBLK as blk,\n\"TO\" as turnover,\nPF as pf,\nPTS as pts,\nPLUS_MINUS as plus_minus\n\n\nFROM raw_games_details", "relation_name": "NBA_GAMES.DEV.src_games_details"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:10:55.501770Z", "completed_at": "2024-11-21T00:10:55.504616Z"}, {"name": "execute", "started_at": "2024-11-21T00:10:55.505165Z", "completed_at": "2024-11-21T00:10:57.127083Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.214235305786133, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820a-0102-3549-0006-c35e0006556e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.src_player_information", "compiled": true, "compiled_code": "WITH player_information AS (\n    SELECT * FROM NBA_GAMES.RAW.PLAYER_INFORMATION\n)\nSELECT \n    \"TeamID\" AS TEAM_ID,\n    SEASON,\n    \"LeagueID\" AS LEAGUE_ID,\n    PLAYER AS player_name,\n    POSITION AS PLAYER_POSITION,\n    HEIGHT,\n    WEIGHT,\n    -- Convert the birth_date string to a valid DATE\n    TO_DATE(BIRTH_DATE, 'MON DD, YYYY') AS BIRTH_DATE,\n    AGE AS AGE, \n    SCHOOL AS SCHOOL\nFROM player_information", "relation_name": "NBA_GAMES.DEV.src_player_information"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:10:57.718918Z", "completed_at": "2024-11-21T00:10:57.721633Z"}, {"name": "execute", "started_at": "2024-11-21T00:10:57.721992Z", "completed_at": "2024-11-21T00:10:59.207973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.9809658527374268, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820a-0102-3549-0006-c35e00065572"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.src_players", "compiled": true, "compiled_code": "with players as (\nSELECT * FROM NBA_GAMES.RAW.PLAYERS\n)\nSELECT \nPLAYER_NAME as player_name,\nCAST(TEAM_ID AS INT) as team_id,\nCAST(PLAYER_ID as INT) as player_id,\nCAST(SEASON as INT) as season\n\nfrom players", "relation_name": "NBA_GAMES.DEV.src_players"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:10:59.704462Z", "completed_at": "2024-11-21T00:10:59.709433Z"}, {"name": "execute", "started_at": "2024-11-21T00:10:59.710051Z", "completed_at": "2024-11-21T00:11:01.496893Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.3075969219207764, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3547-0006-c35e0006636a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.src_ranking", "compiled": true, "compiled_code": "with ranking as (\nSELECT * FROM NBA_GAMES.RAW.ranking\n)\nSELECT \nCAST(TEAM_ID AS INT) as team_id,\nCAST(LEAGUE_ID AS INT) as league_id,\nCAST(SEASON_ID AS INT) as season_id,\nCAST(STANDINGSDATE AS DATE) as standings_date,\nCONFERENCE as conference, \nTEAM as team,\nG as g,\nW as w,\nL as l,\nW_PCT as w_pct,\nHOME_RECORD as home_record,\nROAD_RECORD as road_record,\nRETURNTOPLAY as return_to_play\nfrom ranking", "relation_name": "NBA_GAMES.DEV.src_ranking"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:02.016428Z", "completed_at": "2024-11-21T00:11:02.019657Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:02.020205Z", "completed_at": "2024-11-21T00:11:03.667980Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0178277492523193, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3547-0006-c35e0006636e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.src_teams", "compiled": true, "compiled_code": "with teams as (\nSELECT * FROM NBA_GAMES.RAW.TEAMS\n)\nSELECT \nCAST(LEAGUE_ID AS INT) as league_id,\nCAST(TEAM_ID AS INT) as team_id,\nCAST(MIN_YEAR AS INT) as min_year,\nCAST(MAX_YEAR AS INT) as max_year,\nABBREVIATION as team_abbreviation,\nNICKNAME as team_nickname,\nCAST(YEARFOUNDED AS INT) as year_founded,\nCITY as city,\nARENA as arena,\nARENACAPACITY as arena_capacity,\nOWNER as team_owner,\nGENERALMANAGER as general_manager,\nHEADCOACH as head_coach,\nDLEAGUEAFFILIATION as dleague_affiliation\n\nfrom teams", "relation_name": "NBA_GAMES.DEV.src_teams"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:05.038099Z", "completed_at": "2024-11-21T00:11:05.041963Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:05.042580Z", "completed_at": "2024-11-21T00:11:06.586948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0401601791381836, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3549-0006-c35e00065576"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.stg_player_information", "compiled": true, "compiled_code": "WITH player_information AS (\n    SELECT \n        \"TeamID\" AS TEAM_ID,\n        SEASON,\n        \"LeagueID\" AS LEAGUE_ID,\n        PLAYER AS player_name,\n        POSITION AS PLAYER_POSITION,\n        HEIGHT,\n        WEIGHT,\n        TO_DATE(BIRTH_DATE, 'MON DD, YYYY') AS BIRTH_DATE,\n        AGE,\n        SCHOOL\n    FROM NBA_GAMES.RAW.PLAYER_INFORMATION\n),\nplayer_information_cleaned AS (\n    SELECT \n        TEAM_ID,\n        SEASON,\n        LEAGUE_ID,\n        player_name,\n        PLAYER_POSITION,\n        -- Convert height from \"feet-inches\" to centimeters\n        CAST(SPLIT_PART(HEIGHT, '-', 1) AS INTEGER) * 30.48 + \n        CAST(SPLIT_PART(HEIGHT, '-', 2) AS INTEGER) * 2.54 AS HEIGHT_CM,\n        WEIGHT,\n        BIRTH_DATE,\n        AGE,\n        SCHOOL\n    FROM player_information\n    WHERE player_name IS NOT NULL -- Filter out rows with missing player names\n)\n\nSELECT \n    TEAM_ID,\n    SEASON,\n    LEAGUE_ID,\n    player_name,\n    PLAYER_POSITION,\n    HEIGHT_CM,\n    WEIGHT,\n    BIRTH_DATE,\n    AGE,\n    SCHOOL\nFROM player_information_cleaned", "relation_name": "NBA_GAMES.DEV.stg_player_information"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:07.081476Z", "completed_at": "2024-11-21T00:11:07.087065Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:07.087454Z", "completed_at": "2024-11-21T00:11:08.715617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.125757932662964, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3549-0006-c35e0006557a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.dim_seasons", "compiled": true, "compiled_code": "WITH seasons AS (\n    SELECT * FROM NBA_GAMES.DEV.src_games\n)\nSELECT DISTINCT\n    SEASON AS season_id,\n    SEASON AS season_name,\n    MIN(GAME_DATE_EST) AS start_date,\n    MAX(GAME_DATE_EST) AS end_date\nFROM seasons\nGROUP BY SEASON", "relation_name": "NBA_GAMES.DEV.dim_seasons"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:09.211254Z", "completed_at": "2024-11-21T00:11:09.216575Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:09.217531Z", "completed_at": "2024-11-21T00:11:11.097589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.394876003265381, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3547-0006-c35e00066372"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.dim_players_cleansed", "compiled": true, "compiled_code": "with players as (\nSELECT * FROM NBA_GAMES.DEV.src_players\n)\nSELECT \nPLAYER_NAME as player_name,\nCAST(TEAM_ID AS INT) as team_id,\nCAST(PLAYER_ID as INT) as player_id,\nCAST(SEASON as INT) as season\n\nfrom players", "relation_name": "NBA_GAMES.DEV.dim_players_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:11.611506Z", "completed_at": "2024-11-21T00:11:11.627258Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:11.627575Z", "completed_at": "2024-11-21T00:11:20.882497Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 9.921341896057129, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3549-0006-c35e0006557e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.int_player_stats", "compiled": true, "compiled_code": "\n\nWITH players_data AS (\n    SELECT\n        PLAYER_ID,\n        PLAYER_NAME,\n        TEAM_ID as PLAYER_TEAM_ID,\n        SEASON\n    FROM NBA_GAMES.DEV.src_players\n), \n\ngames_data AS (\n    SELECT\n        GAMES_GAME_ID,\n        GAME_DATE_EST,\n        SEASON,\n        HOME_TEAM_ID,\n        VISITOR_TEAM_ID,\n        HOME_TEAM_WINS,\n        GAME_STATUS_TEXT,\n        ROW_NUMBER() OVER (PARTITION BY SEASON, HOME_TEAM_ID, VISITOR_TEAM_ID ORDER BY GAME_DATE_EST) as rn \n    FROM NBA_GAMES.DEV.src_games\n),\n\nplayer_game_data AS (\n    SELECT  \n        p.PLAYER_ID,\n        p.PLAYER_NAME,\n        p.PLAYER_TEAM_ID,\n        g.GAMES_GAME_ID,\n        p.SEASON,\n        g.GAME_DATE_EST,\n        g.HOME_TEAM_WINS,\n        g.GAME_STATUS_TEXT\n    FROM players_data p\n    JOIN games_data g \n        ON p.SEASON = g.SEASON \n        AND (p.PLAYER_TEAM_ID = g.HOME_TEAM_ID OR p.PLAYER_TEAM_ID = g.VISITOR_TEAM_ID)\n        AND g.rn = 1 \n), \ngames_details_data AS (\n    SELECT\n        CAST(DETAILS_GAME_ID AS INT) AS DETAILS_GAME_ID,\n        CAST(DETAILS_TEAM_ID AS INT) AS DETAILS_TEAM_ID,\n        PLAYER_ID,\n        FGM,\n        FGA,\n        FG_PCT,\n        FG3M,\n        FG3A,\n        FG3_PCT,\n        FTM,\n        FTA,\n        FT_PCT,\n        PTS,\n        AST,\n        REB,\n        STL,\n        BLK,\n        TURNOVER as turnover,\n        PF,\n        PLUS_MINUS\n        \n    FROM NBA_GAMES.DEV.src_games_details\n)\n\nSELECT \n    pgd.PLAYER_ID AS player_id,\n    pgd.PLAYER_NAME AS player_name,\n    pgd.GAMES_GAME_ID AS details_game_id,\n    pgd.GAME_DATE_EST AS game_date_est,\n    pgd.SEASON AS season,\n    pgd.HOME_TEAM_WINS AS home_team_wins,\n    pgd.GAME_STATUS_TEXT AS game_status_text,\n    COALESCE(MAX(gdd.FGM), 0) AS fgm,\n    COALESCE(MAX(gdd.FGA), 0) AS fga,\n    COALESCE(MAX(gdd.FG_PCT), 0) AS fg_pct,\n    COALESCE(MAX(gdd.FG3M), 0) AS fg3m,\n    COALESCE(MAX(gdd.FG3A), 0) AS fg3a,\n    COALESCE(MAX(gdd.FG3_PCT), 0) AS fg3_pct,\n    COALESCE(MAX(gdd.FTM), 0) AS ftm,\n    COALESCE(MAX(gdd.FTA), 0) AS fta,\n    COALESCE(MAX(gdd.FT_PCT), 0) AS ft_pct,\n    COALESCE(MAX(gdd.PTS), 0) AS pts,\n    COALESCE(MAX(gdd.AST), 0) AS ast,\n    COALESCE(MAX(gdd.REB), 0) AS reb,\n    COALESCE(MAX(gdd.STL), 0) AS stl,\n    COALESCE(MAX(gdd.BLK), 0) AS blk,\n    COALESCE(MAX(gdd.turnover), 0) AS turnover,\n    COALESCE(MAX(gdd.PF), 0) AS pf,\n    COALESCE(MAX(gdd.PLUS_MINUS), 0) AS plus_minus\nFROM player_game_data pgd\nJOIN games_details_data gdd \n    ON pgd.GAMES_GAME_ID = gdd.DETAILS_GAME_ID \n    AND pgd.PLAYER_ID = gdd.PLAYER_ID\n    AND pgd.PLAYER_TEAM_ID = gdd.DETAILS_TEAM_ID\nGROUP BY \n    pgd.PLAYER_ID,\n    pgd.PLAYER_NAME,\n    pgd.GAMES_GAME_ID,\n    pgd.GAME_DATE_EST,\n    pgd.SEASON,\n    pgd.HOME_TEAM_WINS,\n    pgd.GAME_STATUS_TEXT\n\n", "relation_name": "NBA_GAMES.DEV.int_player_stats"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:21.539232Z", "completed_at": "2024-11-21T00:11:21.545376Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:21.545880Z", "completed_at": "2024-11-21T00:11:23.950757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.947955846786499, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3547-0006-c35e0006637a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.dim_teams_cleansed", "compiled": true, "compiled_code": "WITH teams AS (\n    SELECT * FROM NBA_GAMES.DEV.src_teams\n)\nSELECT\n    CASE\n        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)\n        ELSE NULL\n    END AS league_id,\n    CASE\n        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)\n        ELSE NULL\n    END AS team_id,\n    CASE\n        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)\n        ELSE NULL\n    END AS min_year,\n    CASE\n        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)\n        ELSE NULL\n    END AS max_year,\n    TEAM_ABBREVIATION AS team_abbreviation,\n    TEAM_NICKNAME AS team_nickname,\n    CASE\n        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)\n        ELSE NULL\n    END AS year_founded,\n    CITY AS city,\n    ARENA AS arena,\n    NVL(arena_capacity, 0) AS arena_capacity,\n    team_owner AS team_owner,\n    general_manager AS general_manager,\n    head_coach AS head_coach,\n    dleague_affiliation AS dleague_affiliation\nFROM teams", "relation_name": "NBA_GAMES.DEV.dim_teams_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:24.489878Z", "completed_at": "2024-11-21T00:11:24.493768Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:24.494070Z", "completed_at": "2024-11-21T00:11:26.794140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.817300319671631, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3547-0006-c35e0006637e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.int_season_stats", "compiled": true, "compiled_code": "\n\nWITH season_stats AS (\n    SELECT\n        PLAYER_ID,\n        PLAYER_NAME,\n        SEASON,\n        SUM(PTS) AS total_points,\n        SUM(AST) AS total_assists,\n        SUM(REB) AS total_rebounds,\n        AVG(FG_PCT) AS avg_field_goal_pct,\n        AVG(FT_PCT) AS avg_free_throw_pct,\n        AVG(FG3_PCT) AS avg_three_point_pct,\n        SUM(FGM) AS total_field_goals_made,\n        SUM(FGA) AS total_field_goals_attempted,\n        SUM(FG3M) AS total_three_points_made,\n        SUM(FG3A) AS total_three_points_attempted,\n        SUM(FTM) AS total_free_throws_made,\n        SUM(FTA) AS total_free_throws_attempted,\n        SUM(STL) AS total_steals,\n        SUM(BLK) AS total_blocks,\n        SUM(turnover) AS total_turnovers,\n        SUM(PF) AS total_personal_fouls,\n        COUNT(DISTINCT DETAILS_GAME_ID) AS games_played,\n        -- Calculate missed shots\n        SUM(FGA - FGM) AS missed_field_goals,\n        SUM(FTA - FTM) AS missed_free_throws\n    FROM NBA_GAMES.DEV.int_player_stats\n    GROUP BY PLAYER_ID, PLAYER_NAME, SEASON\n)\n\nSELECT\n    PLAYER_ID,\n    PLAYER_NAME,\n    SEASON,\n    total_points,\n    total_assists,\n    total_rebounds,\n    avg_field_goal_pct,\n    avg_free_throw_pct,\n    avg_three_point_pct,\n    total_field_goals_made,\n    total_field_goals_attempted,\n    total_three_points_made,\n    total_three_points_attempted,\n    total_free_throws_made,\n    total_free_throws_attempted,\n    total_steals,\n    total_blocks,\n    total_turnovers,\n    total_personal_fouls,\n    games_played,\n    missed_field_goals,\n    missed_free_throws,\n    -- Calculate Efficiency (EFF)\n    CASE\n        WHEN games_played > 0 THEN\n            (total_points + total_rebounds + total_assists + total_steals + total_blocks \n             - (missed_field_goals + missed_free_throws + total_turnovers)) / games_played\n        ELSE NULL\n    END AS efficiency_rating\nFROM season_stats", "relation_name": "NBA_GAMES.DEV.int_season_stats"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-21T00:11:27.311872Z", "completed_at": "2024-11-21T00:11:27.317450Z"}, {"name": "execute", "started_at": "2024-11-21T00:11:27.317833Z", "completed_at": "2024-11-21T00:11:29.935112Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.2145729064941406, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b8820b-0102-3549-0006-c35e00065582"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nba_analysis.fct_player_performance", "compiled": true, "compiled_code": "\n\nSELECT\n    -- Player performance data\n    s.PLAYER_ID,\n    s.PLAYER_NAME,\n    s.SEASON,\n    s.total_points,\n    s.total_assists,\n    s.total_rebounds,\n    s.avg_field_goal_pct,\n    s.avg_free_throw_pct,\n    s.avg_three_point_pct,\n    s.total_field_goals_made,\n    s.total_field_goals_attempted,\n    s.total_three_points_made,\n    s.total_three_points_attempted,\n    s.total_free_throws_made,\n    s.total_free_throws_attempted,\n    s.total_steals,\n    s.total_blocks,\n    s.total_turnovers,\n    s.total_personal_fouls,\n    s.games_played,\n    s.efficiency_rating,\n    -- Per-game averages\n    CASE WHEN s.games_played > 0 THEN s.total_points / s.games_played END AS points_per_game,\n    CASE WHEN s.games_played > 0 THEN s.total_assists / s.games_played END AS assists_per_game,\n    CASE WHEN s.games_played > 0 THEN s.total_rebounds / s.games_played END AS rebounds_per_game,\n    CASE WHEN s.games_played > 0 THEN s.total_steals / s.games_played END AS steals_per_game,\n    CASE WHEN s.games_played > 0 THEN s.total_blocks / s.games_played END AS blocks_per_game,\n    CASE WHEN s.games_played > 0 THEN s.total_turnovers / s.games_played END AS turnovers_per_game,\n    -- Effective Field Goal Percentage\n    CASE WHEN s.total_field_goals_attempted > 0 THEN\n        (s.total_field_goals_made + 0.5 * s.total_three_points_made) / s.total_field_goals_attempted\n    END AS effective_field_goal_pct,\n    -- True Shooting Percentage\n    CASE WHEN (2 * (s.total_field_goals_attempted + 0.44 * s.total_free_throws_attempted)) > 0 THEN\n        s.total_points / (2 * (s.total_field_goals_attempted + 0.44 * s.total_free_throws_attempted))\n    END AS true_shooting_pct,\n    -- Additional information from the seed\n    p.PLAYER_POSITION,\n    p.HEIGHT_CM as HEIGHT,\n    p.WEIGHT,\n    p.BIRTH_DATE,\n    p.AGE,\n    p.SCHOOL\nFROM NBA_GAMES.DEV.int_season_stats s\nLEFT JOIN NBA_GAMES.DEV.stg_player_information p\n    ON s.PLAYER_NAME = p.PLAYER_NAME", "relation_name": "NBA_GAMES.DEV.fct_player_performance"}], "elapsed_time": 46.172919034957886, "args": {"require_resource_names_without_spaces": false, "partial_parse_file_diff": true, "empty": false, "log_level": "info", "macro_debugging": false, "use_colors": true, "quiet": false, "invocation_command": "dbt run --full-refresh", "cache_selected_only": false, "introspect": true, "print": true, "favor_state": false, "log_level_file": "debug", "log_format": "default", "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "write_json": true, "log_format_file": "debug", "enable_legacy_logger": false, "full_refresh": true, "show_resource_report": false, "log_file_max_bytes": 10485760, "vars": {}, "select": [], "profiles_dir": "/Users/yogisharosarumaha/.dbt", "indirect_selection": "eager", "defer": false, "partial_parse": true, "version_check": true, "log_path": "/Users/yogisharosarumaha/Documents/nba_analysis/logs", "printer_width": 80, "send_anonymous_usage_stats": true, "which": "run", "exclude": [], "strict_mode": false, "static_parser": true, "project_dir": "/Users/yogisharosarumaha/Documents/nba_analysis", "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true}}