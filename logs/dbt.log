[0m11:51:06.087068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ea0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f16a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f17210>]}


============================== 11:51:06.089669 | 95b188ad-2cf4-4157-84af-e55c504f9a3c ==============================
[0m11:51:06.089669 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:51:06.089968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:06.099170 [info ] [MainThread]: Setting up your profile.
[0m11:51:33.341591 [error] [MainThread]: Encountered an error:

[0m11:51:33.348030 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/cli/main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/task/init.py", line 321, in run
    self.setup_profile(profile_name)
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/task/init.py", line 262, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/task/init.py", line 243, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/click/termui.py", line 166, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/click/termui.py", line 149, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m11:51:33.376747 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 27.323221, "process_user_time": 2.787009, "process_kernel_time": 0.191244, "process_mem_max_rss": "120979456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:51:33.377643 [debug] [MainThread]: Command `dbt init` failed at 11:51:33.377490 after 27.32 seconds
[0m11:51:33.378109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ea1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f16ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d12010>]}
[0m11:51:33.378514 [debug] [MainThread]: Flushing usage events
[0m11:51:50.496995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c165390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c1af350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c1db690>]}


============================== 11:51:50.499921 | 11190bcc-0e70-43e4-91ab-48e766e8f58f ==============================
[0m11:51:50.499921 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:51:50.500291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m11:51:58.781393 [debug] [MainThread]: Starter project path: /Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/include/starter_project
[0m11:51:58.793710 [info ] [MainThread]: 
Your new dbt project "nba_analysis" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:51:58.794247 [info ] [MainThread]: Setting up your profile.
[0m11:52:09.574609 [error] [MainThread]: Encountered an error:

[0m11:52:09.580651 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/cli/main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/task/init.py", line 347, in run
    self.setup_profile(profile_name)
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/task/init.py", line 262, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/dbt/task/init.py", line 243, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/click/termui.py", line 166, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/site-packages/click/termui.py", line 149, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m11:52:09.583075 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 19.121927, "process_user_time": 2.425166, "process_kernel_time": 0.161134, "process_mem_max_rss": "124174336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:52:09.583772 [debug] [MainThread]: Command `dbt init` failed at 11:52:09.583654 after 19.12 seconds
[0m11:52:09.584191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c1df450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c1afa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103902010>]}
[0m11:52:09.584534 [debug] [MainThread]: Flushing usage events
[0m11:53:07.510413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ba4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c16790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c16f50>]}


============================== 11:53:07.513007 | 77ae9ba5-d528-4b06-9375-cd995a6db35f ==============================
[0m11:53:07.513007 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:53:07.513305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init nba_analysis', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:07.522438 [info ] [MainThread]: A project called nba_analysis already exists here.
[0m11:53:07.523454 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 0.042484708, "process_user_time": 2.597463, "process_kernel_time": 0.173262, "process_mem_max_rss": "117112832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:07.523775 [debug] [MainThread]: Command `dbt init` succeeded at 11:53:07.523724 after 0.04 seconds
[0m11:53:07.523969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ba5c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c16f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101535d50>]}
[0m11:53:07.524140 [debug] [MainThread]: Flushing usage events
[0m11:55:05.498708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e9b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158f16910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158f170d0>]}


============================== 11:55:05.501268 | 9ab8884a-36ba-4729-8424-4f04ad94af1d ==============================
[0m11:55:05.501268 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:55:05.501576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt init nba_analysis', 'send_anonymous_usage_stats': 'True'}
[0m11:55:05.510294 [info ] [MainThread]: A project called nba_analysis already exists here.
[0m11:55:05.511237 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 0.04063404, "process_user_time": 2.432486, "process_kernel_time": 0.167039, "process_mem_max_rss": "122355712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:05.511487 [debug] [MainThread]: Command `dbt init` succeeded at 11:55:05.511439 after 0.04 seconds
[0m11:55:05.511667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158ea1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158eef590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aade10>]}
[0m11:55:05.511837 [debug] [MainThread]: Flushing usage events
[0m11:55:12.388924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137668510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376da790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376daf50>]}


============================== 11:55:12.391310 | 0184f66b-c592-4a6b-8a62-01aaf0416415 ==============================
[0m11:55:12.391310 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:55:12.391602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt init', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:55:20.992553 [info ] [MainThread]: A project called nba_analysis already exists here.
[0m11:55:20.996958 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 8.634363, "process_user_time": 2.366969, "process_kernel_time": 0.108953, "process_mem_max_rss": "122224640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:20.999103 [debug] [MainThread]: Command `dbt init` succeeded at 11:55:20.998867 after 8.64 seconds
[0m11:55:20.999840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376a2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137669bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10370dd50>]}
[0m11:55:21.000459 [debug] [MainThread]: Flushing usage events
[0m11:57:49.197141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232a3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233164d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123316c90>]}


============================== 11:57:49.199736 | efbd0e8c-dbba-434a-9f15-482f6573c994 ==============================
[0m11:57:49.199736 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:57:49.200050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:57:49.209223 [info ] [MainThread]: dbt version: 1.8.3
[0m11:57:49.209464 [info ] [MainThread]: python version: 3.11.5
[0m11:57:49.209628 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m11:57:49.209775 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m11:57:49.212440 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m11:57:49.212697 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m11:57:49.212827 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m11:57:49.212948 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m11:57:49.245003 [info ] [MainThread]: Configuration:
[0m11:57:49.245223 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:57:49.245361 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:57:49.245490 [info ] [MainThread]: Required dependencies:
[0m11:57:49.245646 [debug] [MainThread]: Executing "git --help"
[0m11:57:49.415161 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:57:49.416084 [debug] [MainThread]: STDERR: "b''"
[0m11:57:49.416395 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:57:49.416673 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:57:49.416923 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:57:49.417146 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "nba_analysis", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m11:57:49.418526 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.25032425, "process_user_time": 2.441885, "process_kernel_time": 0.158892, "process_mem_max_rss": "124092416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:57:49.418820 [debug] [MainThread]: Command `dbt debug` failed at 11:57:49.418774 after 0.25 seconds
[0m11:57:49.419062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232a1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd0210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd3210>]}
[0m11:57:49.419296 [debug] [MainThread]: Flushing usage events
[0m11:59:13.946025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235677d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235dab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235db250>]}


============================== 11:59:13.948574 | 2c0d34bb-ff8d-4654-8a83-80b6618326e3 ==============================
[0m11:59:13.948574 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:59:13.948897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:13.956952 [info ] [MainThread]: dbt version: 1.8.3
[0m11:59:13.957210 [info ] [MainThread]: python version: 3.11.5
[0m11:59:13.957405 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m11:59:13.957547 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m11:59:13.960124 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m11:59:13.960382 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m11:59:13.960510 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m11:59:13.960631 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m11:59:13.992456 [info ] [MainThread]: Configuration:
[0m11:59:13.992677 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:59:13.992834 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:59:13.992968 [info ] [MainThread]: Required dependencies:
[0m11:59:13.993134 [debug] [MainThread]: Executing "git --help"
[0m11:59:14.011769 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:59:14.012246 [debug] [MainThread]: STDERR: "b''"
[0m11:59:14.012428 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:59:14.012586 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:59:14.012725 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:59:14.012842 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "nba_analysis", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m11:59:14.014127 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.09544975, "process_user_time": 2.431897, "process_kernel_time": 0.215107, "process_mem_max_rss": "124813312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:59:14.014433 [debug] [MainThread]: Command `dbt debug` failed at 11:59:14.014388 after 0.10 seconds
[0m11:59:14.014676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235db190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123566090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12303e910>]}
[0m11:59:14.014886 [debug] [MainThread]: Flushing usage events
[0m13:52:42.050333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1597a3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1597f0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159816e90>]}


============================== 13:52:42.054166 | e637fd53-a427-40c3-8b6e-89160ba31639 ==============================
[0m13:52:42.054166 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:52:42.054635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:42.066850 [info ] [MainThread]: dbt version: 1.8.3
[0m13:52:42.067194 [info ] [MainThread]: python version: 3.11.5
[0m13:52:42.067443 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m13:52:42.067654 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m13:52:42.071964 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m13:52:42.072465 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m13:52:42.072739 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m13:52:42.072947 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m13:52:42.129418 [info ] [MainThread]: Configuration:
[0m13:52:42.129781 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:52:42.130003 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:52:42.130194 [info ] [MainThread]: Required dependencies:
[0m13:52:42.130435 [debug] [MainThread]: Executing "git --help"
[0m13:52:42.170625 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:52:42.171353 [debug] [MainThread]: STDERR: "b''"
[0m13:52:42.171671 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:52:42.171916 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:52:42.172135 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:52:42.172325 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "nba_analysis", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m13:52:42.174818 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.174074, "process_user_time": 2.824192, "process_kernel_time": 0.233848, "process_mem_max_rss": "123764736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:42.175373 [debug] [MainThread]: Command `dbt debug` failed at 13:52:42.175289 after 0.17 seconds
[0m13:52:42.175764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1597a1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610d250>]}
[0m13:52:42.176116 [debug] [MainThread]: Flushing usage events
[0m13:56:36.849279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188a75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188994d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118917710>]}


============================== 13:56:36.853167 | 843698ca-2d53-4319-bfc6-2f241bef9f72 ==============================
[0m13:56:36.853167 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:56:36.853655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:56:36.865492 [info ] [MainThread]: dbt version: 1.8.3
[0m13:56:36.865820 [info ] [MainThread]: python version: 3.11.5
[0m13:56:36.866074 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m13:56:36.866290 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m13:56:36.870759 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m13:56:36.871199 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m13:56:36.871509 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m13:56:36.871765 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m13:56:36.927059 [info ] [MainThread]: Configuration:
[0m13:56:36.927391 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:56:36.927608 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:56:36.927804 [info ] [MainThread]: Required dependencies:
[0m13:56:36.928041 [debug] [MainThread]: Executing "git --help"
[0m13:56:36.957635 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:56:36.958317 [debug] [MainThread]: STDERR: "b''"
[0m13:56:36.958568 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:56:36.958803 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:56:36.959015 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:56:36.959198 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "nba_analysis", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m13:56:36.961008 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.15801984, "process_user_time": 2.850058, "process_kernel_time": 0.226885, "process_mem_max_rss": "124370944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:36.961479 [debug] [MainThread]: Command `dbt debug` failed at 13:56:36.961404 after 0.16 seconds
[0m13:56:36.961839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118916fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188a5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11853e910>]}
[0m13:56:36.962207 [debug] [MainThread]: Flushing usage events
[0m13:58:29.856099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ba3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13783e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c17250>]}


============================== 13:58:29.860104 | 2a6c3743-4ced-41f0-aa7b-ac0e60910343 ==============================
[0m13:58:29.860104 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:58:29.860577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:58:29.872041 [info ] [MainThread]: dbt version: 1.8.3
[0m13:58:29.872370 [info ] [MainThread]: python version: 3.11.5
[0m13:58:29.872616 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m13:58:29.872831 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m13:58:29.877100 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m13:58:29.877601 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m13:58:29.877915 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m13:58:29.878128 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m13:58:29.933428 [info ] [MainThread]: Configuration:
[0m13:58:29.933753 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:58:29.933983 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:58:29.934177 [info ] [MainThread]: Required dependencies:
[0m13:58:29.934416 [debug] [MainThread]: Executing "git --help"
[0m13:58:29.964507 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:58:29.965240 [debug] [MainThread]: STDERR: "b''"
[0m13:58:29.965521 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:58:29.965780 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:58:29.966018 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:58:29.966235 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "nba_analysis", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m13:58:29.968158 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.15911892, "process_user_time": 2.779383, "process_kernel_time": 0.250502, "process_mem_max_rss": "124256256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:58:29.968647 [debug] [MainThread]: Command `dbt debug` failed at 13:58:29.968567 after 0.16 seconds
[0m13:58:29.969020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bac150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ba1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bd2450>]}
[0m13:58:29.969373 [debug] [MainThread]: Flushing usage events
[0m14:01:06.538345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cda18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cda0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce174d0>]}


============================== 14:01:06.542193 | f05e91de-53e1-44f1-96ae-0146a15b5717 ==============================
[0m14:01:06.542193 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:01:06.542646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:01:06.554684 [info ] [MainThread]: dbt version: 1.8.3
[0m14:01:06.555019 [info ] [MainThread]: python version: 3.11.5
[0m14:01:06.555265 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m14:01:06.555479 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m14:01:06.559836 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m14:01:06.560290 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m14:01:06.560573 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m14:01:06.560788 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m14:01:06.616138 [info ] [MainThread]: Configuration:
[0m14:01:06.616465 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m14:01:06.616684 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:01:06.616884 [info ] [MainThread]: Required dependencies:
[0m14:01:06.617128 [debug] [MainThread]: Executing "git --help"
[0m14:01:06.645494 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:01:06.646194 [debug] [MainThread]: STDERR: "b''"
[0m14:01:06.646463 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:01:06.646713 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:01:06.646937 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:01:06.647127 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "nba_analysis", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m14:01:06.649036 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.15661, "process_user_time": 2.846406, "process_kernel_time": 0.238051, "process_mem_max_rss": "124321792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:01:06.649502 [debug] [MainThread]: Command `dbt debug` failed at 14:01:06.649428 after 0.16 seconds
[0m14:01:06.649887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cda2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cdd2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009791d0>]}
[0m14:01:06.650255 [debug] [MainThread]: Flushing usage events
[0m14:04:01.703107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1d06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1c3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1ef810>]}


============================== 14:04:01.707308 | 5a351c93-b385-4924-8917-05f5ff052b31 ==============================
[0m14:04:01.707308 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:04:01.707778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/home/myname/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /home/myname/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:01.719975 [info ] [MainThread]: dbt version: 1.8.3
[0m14:04:01.720350 [info ] [MainThread]: python version: 3.11.5
[0m14:04:01.720613 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m14:04:01.720830 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m14:04:01.744139 [info ] [MainThread]: Using profiles dir at /home/myname/.dbt
[0m14:04:01.744450 [info ] [MainThread]: Using profiles.yml file at /home/myname/.dbt/profiles.yml
[0m14:04:01.744654 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m14:04:01.802108 [info ] [MainThread]: Configuration:
[0m14:04:01.802558 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m14:04:01.803494 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:04:01.803767 [info ] [MainThread]: Required dependencies:
[0m14:04:01.804035 [debug] [MainThread]: Executing "git --help"
[0m14:04:01.832086 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:04:01.832780 [debug] [MainThread]: STDERR: "b''"
[0m14:04:01.833045 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:04:01.833297 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:04:01.833516 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:04:01.833714 [info ] [MainThread]: dbt looked for a profiles.yml file in /home/myname/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m14:04:01.835586 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.21559075, "process_user_time": 2.830849, "process_kernel_time": 0.228529, "process_mem_max_rss": "124469248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:04:01.836081 [debug] [MainThread]: Command `dbt debug` failed at 14:04:01.836005 after 0.22 seconds
[0m14:04:01.836531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1f7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1d14d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f2d4490>]}
[0m14:04:01.836874 [debug] [MainThread]: Flushing usage events
[0m14:04:11.087144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181ef150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11819afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118217310>]}


============================== 14:04:11.090805 | 30c7a52c-11c4-4bba-9df4-5b9f6d1f5df4 ==============================
[0m14:04:11.090805 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:04:11.091263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/home/myname/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /home/myname/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m14:04:11.101254 [info ] [MainThread]: dbt version: 1.8.3
[0m14:04:11.101584 [info ] [MainThread]: python version: 3.11.5
[0m14:04:11.101838 [info ] [MainThread]: python path: /Users/Shared/anaconda3/bin/python
[0m14:04:11.102059 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m14:04:11.118060 [info ] [MainThread]: Using profiles dir at /home/myname/.dbt
[0m14:04:11.118344 [info ] [MainThread]: Using profiles.yml file at /home/myname/.dbt/profiles.yml
[0m14:04:11.118543 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m14:04:11.176075 [info ] [MainThread]: Configuration:
[0m14:04:11.176410 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m14:04:11.176650 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:04:11.176845 [info ] [MainThread]: Required dependencies:
[0m14:04:11.177088 [debug] [MainThread]: Executing "git --help"
[0m14:04:11.195169 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:04:11.195984 [debug] [MainThread]: STDERR: "b''"
[0m14:04:11.196285 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:04:11.196552 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:04:11.196784 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:04:11.196981 [info ] [MainThread]: dbt looked for a profiles.yml file in /home/myname/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m14:04:11.198656 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.19394425, "process_user_time": 2.518224, "process_kernel_time": 0.369402, "process_mem_max_rss": "124993536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:04:11.199125 [debug] [MainThread]: Command `dbt debug` failed at 14:04:11.199053 after 0.19 seconds
[0m14:04:11.199516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184d2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b3ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181a1dd0>]}
[0m14:04:11.199866 [debug] [MainThread]: Flushing usage events
[0m14:09:00.961404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b32150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b976d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97e50>]}


============================== 14:09:00.965247 | 2b0491cf-95fe-43aa-b528-3c740be6012a ==============================
[0m14:09:00.965247 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:09:00.965781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /Users/yogisharosarumaha/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:00.977571 [info ] [MainThread]: dbt version: 1.8.7
[0m14:09:00.977915 [info ] [MainThread]: python version: 3.11.5
[0m14:09:00.978166 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m14:09:00.978381 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m14:09:01.637265 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m14:09:01.637638 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m14:09:01.637870 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m14:09:01.638353 [info ] [MainThread]: adapter type: snowflake
[0m14:09:01.638642 [info ] [MainThread]: adapter version: 1.8.4
[0m14:09:01.692067 [info ] [MainThread]: Configuration:
[0m14:09:01.692393 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:09:01.692623 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:09:01.692818 [info ] [MainThread]: Required dependencies:
[0m14:09:01.693084 [debug] [MainThread]: Executing "git --help"
[0m14:09:01.715183 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:09:01.715960 [debug] [MainThread]: STDERR: "b''"
[0m14:09:01.716260 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:09:01.716510 [info ] [MainThread]: Connection:
[0m14:09:01.716769 [info ] [MainThread]:   account: oslioxh-ra97663
[0m14:09:01.716962 [info ] [MainThread]:   user: dbt
[0m14:09:01.717140 [info ] [MainThread]:   database: NBA_GAMES
[0m14:09:01.717313 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:09:01.717487 [info ] [MainThread]:   role: transform
[0m14:09:01.717659 [info ] [MainThread]:   schema: DEV
[0m14:09:01.717833 [info ] [MainThread]:   authenticator: None
[0m14:09:01.718012 [info ] [MainThread]:   oauth_client_id: None
[0m14:09:01.718184 [info ] [MainThread]:   query_tag: None
[0m14:09:01.718357 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:09:01.718526 [info ] [MainThread]:   host: None
[0m14:09:01.718696 [info ] [MainThread]:   port: None
[0m14:09:01.718865 [info ] [MainThread]:   proxy_host: None
[0m14:09:01.719036 [info ] [MainThread]:   proxy_port: None
[0m14:09:01.719210 [info ] [MainThread]:   protocol: None
[0m14:09:01.719379 [info ] [MainThread]:   connect_retries: 1
[0m14:09:01.719548 [info ] [MainThread]:   connect_timeout: None
[0m14:09:01.719719 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:09:01.719891 [info ] [MainThread]:   retry_all: False
[0m14:09:01.720061 [info ] [MainThread]:   insecure_mode: False
[0m14:09:01.720236 [info ] [MainThread]:   reuse_connections: None
[0m14:09:01.720698 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:09:01.812930 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:09:01.813697 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:09:01.813933 [debug] [MainThread]: On debug: select 1 as id
[0m14:09:01.814139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:04.760568 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.946 seconds
[0m14:09:04.763155 [debug] [MainThread]: On debug: Close
[0m14:09:05.434655 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:09:05.435778 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:09:05.442080 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.531877, "process_user_time": 1.568245, "process_kernel_time": 0.338124, "process_mem_max_rss": "187400192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:05.443059 [debug] [MainThread]: Command `dbt debug` succeeded at 14:09:05.442886 after 4.53 seconds
[0m14:09:05.443600 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:09:05.444193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b79850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105805310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032ddb90>]}
[0m14:09:05.444778 [debug] [MainThread]: Flushing usage events
[0m14:09:25.657128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106686150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066eb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ebdd0>]}


============================== 14:09:25.660880 | d1339554-b97e-40cf-b8d4-f08c45ffb715 ==============================
[0m14:09:25.660880 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:09:25.661353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:25.671918 [info ] [MainThread]: dbt version: 1.8.7
[0m14:09:25.672411 [info ] [MainThread]: python version: 3.11.5
[0m14:09:25.672773 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m14:09:25.673038 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m14:09:26.332309 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m14:09:26.332689 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m14:09:26.332925 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m14:09:26.333411 [info ] [MainThread]: adapter type: snowflake
[0m14:09:26.333689 [info ] [MainThread]: adapter version: 1.8.4
[0m14:09:26.387575 [info ] [MainThread]: Configuration:
[0m14:09:26.387907 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:09:26.388133 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:09:26.388332 [info ] [MainThread]: Required dependencies:
[0m14:09:26.388593 [debug] [MainThread]: Executing "git --help"
[0m14:09:26.421700 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:09:26.422464 [debug] [MainThread]: STDERR: "b''"
[0m14:09:26.422744 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:09:26.422998 [info ] [MainThread]: Connection:
[0m14:09:26.423264 [info ] [MainThread]:   account: oslioxh-ra97663
[0m14:09:26.423465 [info ] [MainThread]:   user: dbt
[0m14:09:26.423659 [info ] [MainThread]:   database: NBA_GAMES
[0m14:09:26.423838 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:09:26.424018 [info ] [MainThread]:   role: transform
[0m14:09:26.424192 [info ] [MainThread]:   schema: DEV
[0m14:09:26.424374 [info ] [MainThread]:   authenticator: None
[0m14:09:26.424552 [info ] [MainThread]:   oauth_client_id: None
[0m14:09:26.424725 [info ] [MainThread]:   query_tag: None
[0m14:09:26.424904 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:09:26.425084 [info ] [MainThread]:   host: None
[0m14:09:26.425259 [info ] [MainThread]:   port: None
[0m14:09:26.425437 [info ] [MainThread]:   proxy_host: None
[0m14:09:26.425616 [info ] [MainThread]:   proxy_port: None
[0m14:09:26.425790 [info ] [MainThread]:   protocol: None
[0m14:09:26.425968 [info ] [MainThread]:   connect_retries: 1
[0m14:09:26.426138 [info ] [MainThread]:   connect_timeout: None
[0m14:09:26.426310 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:09:26.426485 [info ] [MainThread]:   retry_all: False
[0m14:09:26.426657 [info ] [MainThread]:   insecure_mode: False
[0m14:09:26.426827 [info ] [MainThread]:   reuse_connections: None
[0m14:09:26.427253 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:09:26.517893 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:09:26.518706 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:09:26.518949 [debug] [MainThread]: On debug: select 1 as id
[0m14:09:26.519159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:28.973678 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.454 seconds
[0m14:09:28.976290 [debug] [MainThread]: On debug: Close
[0m14:09:29.704329 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:09:29.705827 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:09:29.710899 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.094298, "process_user_time": 1.458347, "process_kernel_time": 0.285239, "process_mem_max_rss": "194658304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:29.711993 [debug] [MainThread]: Command `dbt debug` succeeded at 14:09:29.711790 after 4.10 seconds
[0m14:09:29.712505 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:09:29.712969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e31c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eea510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cc990>]}
[0m14:09:29.713512 [debug] [MainThread]: Flushing usage events
[0m15:16:19.191426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bff590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bffd10>]}


============================== 15:16:19.195192 | f447762d-4816-4b5b-aab7-fa9845bce353 ==============================
[0m15:16:19.195192 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:16:19.195658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:16:20.224928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f447762d-4816-4b5b-aab7-fa9845bce353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f68190>]}
[0m15:16:20.258034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f447762d-4816-4b5b-aab7-fa9845bce353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107545d10>]}
[0m15:16:20.258764 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:16:20.363590 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:16:20.422316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:16:20.422640 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:16:20.426416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f447762d-4816-4b5b-aab7-fa9845bce353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6c2e50>]}
[0m15:16:20.471489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f447762d-4816-4b5b-aab7-fa9845bce353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f73d650>]}
[0m15:16:20.471854 [info ] [MainThread]: Found 459 macros
[0m15:16:20.472117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f447762d-4816-4b5b-aab7-fa9845bce353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f25cb10>]}
[0m15:16:20.473077 [info ] [MainThread]: 
[0m15:16:20.473327 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:16:20.474469 [debug] [MainThread]: Command end result
[0m15:16:20.494523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3504968, "process_user_time": 1.485022, "process_kernel_time": 0.374121, "process_mem_max_rss": "188186624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:16:20.494964 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:20.494899 after 1.35 seconds
[0m15:16:20.495244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103724d10>]}
[0m15:16:20.495512 [debug] [MainThread]: Flushing usage events
[0m18:06:06.311645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ab890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b7f90>]}


============================== 18:06:06.315599 | 509e3312-2aed-4c24-91aa-5bcabab2f2dc ==============================
[0m18:06:06.315599 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:06.316066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:07.325435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '509e3312-2aed-4c24-91aa-5bcabab2f2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee2ce10>]}
[0m18:06:07.358623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '509e3312-2aed-4c24-91aa-5bcabab2f2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105045d50>]}
[0m18:06:07.359402 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:07.456639 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:07.511033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:07.511363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:07.527790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '509e3312-2aed-4c24-91aa-5bcabab2f2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f335f10>]}
[0m18:06:07.591289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '509e3312-2aed-4c24-91aa-5bcabab2f2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f12fdd0>]}
[0m18:06:07.591766 [info ] [MainThread]: Found 1 model, 459 macros
[0m18:06:07.592041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '509e3312-2aed-4c24-91aa-5bcabab2f2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda4a90>]}
[0m18:06:07.593202 [info ] [MainThread]: 
[0m18:06:07.593638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:07.594243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m18:06:07.606549 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m18:06:07.606984 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m18:06:07.607311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:09.527250 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85c4a-0102-3136-0006-c35e00041eb2
[0m18:06:09.527695 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:06:09.528080 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m18:06:09.528295 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:06:09.528608 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m18:06:10.084678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:10.085291 [debug] [MainThread]: Connection 'list_NBA_GAMES' was properly closed.
[0m18:06:10.085788 [info ] [MainThread]: 
[0m18:06:10.086298 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m18:06:10.086924 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "NBA_GAMES"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m18:06:10.090764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8296688, "process_user_time": 1.631478, "process_kernel_time": 0.404704, "process_mem_max_rss": "188923904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:06:10.091454 [debug] [MainThread]: Command `dbt run` failed at 18:06:10.091339 after 3.83 seconds
[0m18:06:10.091922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105765b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057abf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101350d10>]}
[0m18:06:10.092296 [debug] [MainThread]: Flushing usage events
[0m18:06:47.172556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b75610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcf910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcff90>]}


============================== 18:06:47.176194 | 23a10497-7f6d-4c03-a377-80aa4d30453b ==============================
[0m18:06:47.176194 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:47.176676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:47.188183 [info ] [MainThread]: dbt version: 1.8.7
[0m18:06:47.188519 [info ] [MainThread]: python version: 3.11.5
[0m18:06:47.188780 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m18:06:47.189003 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m18:06:47.801273 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m18:06:47.801646 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m18:06:47.801879 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m18:06:47.802365 [info ] [MainThread]: adapter type: snowflake
[0m18:06:47.802585 [info ] [MainThread]: adapter version: 1.8.4
[0m18:06:47.856126 [info ] [MainThread]: Configuration:
[0m18:06:47.856472 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:06:47.856704 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:06:47.856909 [info ] [MainThread]: Required dependencies:
[0m18:06:47.857166 [debug] [MainThread]: Executing "git --help"
[0m18:06:47.892964 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:06:47.893725 [debug] [MainThread]: STDERR: "b''"
[0m18:06:47.894003 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:06:47.894255 [info ] [MainThread]: Connection:
[0m18:06:47.894514 [info ] [MainThread]:   account: oslioxh-ra97663
[0m18:06:47.894718 [info ] [MainThread]:   user: dbt
[0m18:06:47.894901 [info ] [MainThread]:   database: NBA_GAMES
[0m18:06:47.895083 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m18:06:47.895257 [info ] [MainThread]:   role: transform
[0m18:06:47.895430 [info ] [MainThread]:   schema: DEV
[0m18:06:47.895607 [info ] [MainThread]:   authenticator: None
[0m18:06:47.895785 [info ] [MainThread]:   oauth_client_id: None
[0m18:06:47.895955 [info ] [MainThread]:   query_tag: None
[0m18:06:47.896132 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:06:47.896304 [info ] [MainThread]:   host: None
[0m18:06:47.896478 [info ] [MainThread]:   port: None
[0m18:06:47.896654 [info ] [MainThread]:   proxy_host: None
[0m18:06:47.896833 [info ] [MainThread]:   proxy_port: None
[0m18:06:47.897004 [info ] [MainThread]:   protocol: None
[0m18:06:47.897180 [info ] [MainThread]:   connect_retries: 1
[0m18:06:47.897393 [info ] [MainThread]:   connect_timeout: None
[0m18:06:47.897615 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:06:47.897799 [info ] [MainThread]:   retry_all: False
[0m18:06:47.897979 [info ] [MainThread]:   insecure_mode: False
[0m18:06:47.898154 [info ] [MainThread]:   reuse_connections: None
[0m18:06:47.898609 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:47.989035 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:06:47.989793 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:06:47.990033 [debug] [MainThread]: On debug: select 1 as id
[0m18:06:47.990251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:49.824789 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.834 seconds
[0m18:06:49.827381 [debug] [MainThread]: On debug: Close
[0m18:06:50.322018 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:06:50.323128 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:06:50.328427 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.1994774, "process_user_time": 1.469, "process_kernel_time": 0.270102, "process_mem_max_rss": "185729024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:06:50.329590 [debug] [MainThread]: Command `dbt debug` succeeded at 18:06:50.329345 after 3.20 seconds
[0m18:06:50.330128 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:06:50.330759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105828110>]}
[0m18:06:50.331474 [debug] [MainThread]: Flushing usage events
[0m18:06:56.950908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a552f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b7f90>]}


============================== 18:06:56.954295 | 20ace2b9-3765-4a88-8483-b9bea6a1a81b ==============================
[0m18:06:56.954295 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:56.954771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:06:57.645735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20ace2b9-3765-4a88-8483-b9bea6a1a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a11150>]}
[0m18:06:57.679011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20ace2b9-3765-4a88-8483-b9bea6a1a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109545e50>]}
[0m18:06:57.679804 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:06:57.775833 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:06:57.846212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:57.846551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:57.862930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20ace2b9-3765-4a88-8483-b9bea6a1a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a935650>]}
[0m18:06:57.914800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20ace2b9-3765-4a88-8483-b9bea6a1a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a919b50>]}
[0m18:06:57.915185 [info ] [MainThread]: Found 1 model, 459 macros
[0m18:06:57.915440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20ace2b9-3765-4a88-8483-b9bea6a1a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192e9750>]}
[0m18:06:57.916486 [info ] [MainThread]: 
[0m18:06:57.916874 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:57.917456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m18:06:57.928503 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m18:06:57.928795 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m18:06:57.929018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:59.328518 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85c4a-0102-30e3-0006-c35e00043922
[0m18:06:59.329575 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:06:59.330345 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m18:06:59.330721 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:06:59.331215 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m18:06:59.852106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:59.852895 [debug] [MainThread]: Connection 'list_NBA_GAMES' was properly closed.
[0m18:06:59.853420 [info ] [MainThread]: 
[0m18:06:59.853998 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m18:06:59.854878 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "NBA_GAMES"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m18:06:59.859171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9484885, "process_user_time": 1.60995, "process_kernel_time": 0.270939, "process_mem_max_rss": "189857792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:06:59.859890 [debug] [MainThread]: Command `dbt run` failed at 18:06:59.859771 after 2.95 seconds
[0m18:06:59.860378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5dbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5dbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105698d10>]}
[0m18:06:59.860847 [debug] [MainThread]: Flushing usage events
[0m18:15:08.601276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110266b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102bf410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102679d0>]}


============================== 18:15:08.605166 | f14a2623-8965-4e49-9ea8-19a3dc23b5d6 ==============================
[0m18:15:08.605166 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:08.605643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:09.621590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14a2623-8965-4e49-9ea8-19a3dc23b5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b7ddd0>]}
[0m18:15:09.654455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14a2623-8965-4e49-9ea8-19a3dc23b5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b45c90>]}
[0m18:15:09.655169 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:15:09.753732 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:15:09.823422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:09.823719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:09.840013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14a2623-8965-4e49-9ea8-19a3dc23b5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1381d0a10>]}
[0m18:15:09.894125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14a2623-8965-4e49-9ea8-19a3dc23b5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13821b350>]}
[0m18:15:09.894534 [info ] [MainThread]: Found 1 model, 459 macros
[0m18:15:09.894802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14a2623-8965-4e49-9ea8-19a3dc23b5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c8f6d0>]}
[0m18:15:09.895955 [info ] [MainThread]: 
[0m18:15:09.896350 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:15:09.896953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m18:15:09.907846 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m18:15:09.908151 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m18:15:09.908384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:11.741351 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85c53-0102-30e3-0006-c35e0004397e
[0m18:15:11.741901 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:15:11.742381 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m18:15:11.742700 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:15:11.743151 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m18:15:12.275854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:12.276815 [debug] [MainThread]: Connection 'list_NBA_GAMES' was properly closed.
[0m18:15:12.277382 [info ] [MainThread]: 
[0m18:15:12.278098 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m18:15:12.279031 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "NBA_GAMES"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m18:15:12.284155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.729518, "process_user_time": 1.633447, "process_kernel_time": 0.417368, "process_mem_max_rss": "198131712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:15:12.285069 [debug] [MainThread]: Command `dbt run` failed at 18:15:12.284949 after 3.73 seconds
[0m18:15:12.285621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102efbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102bfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035315d0>]}
[0m18:15:12.286097 [debug] [MainThread]: Flushing usage events
[0m18:16:59.051997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11968e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196e52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196fbe10>]}


============================== 18:16:59.055767 | 57495d1e-a8f4-4e65-af6f-a3894ea84fb9 ==============================
[0m18:16:59.055767 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:16:59.056232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:59.816607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57495d1e-a8f4-4e65-af6f-a3894ea84fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d832910>]}
[0m18:16:59.850660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57495d1e-a8f4-4e65-af6f-a3894ea84fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119045d90>]}
[0m18:16:59.851737 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:16:59.950446 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:17:00.019890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:00.020215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:00.036991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57495d1e-a8f4-4e65-af6f-a3894ea84fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f2551d0>]}
[0m18:17:00.091834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57495d1e-a8f4-4e65-af6f-a3894ea84fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f254090>]}
[0m18:17:00.092215 [info ] [MainThread]: Found 1 model, 459 macros
[0m18:17:00.092476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57495d1e-a8f4-4e65-af6f-a3894ea84fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd35690>]}
[0m18:17:00.093538 [info ] [MainThread]: 
[0m18:17:00.093933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:00.094520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m18:17:00.105209 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m18:17:00.105518 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m18:17:00.105751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:01.865601 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.760 seconds
[0m18:17:01.868959 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m18:17:02.422199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now create_NBA_GAMES_DEV)
[0m18:17:02.423086 [debug] [ThreadPool]: Creating schema "database: "NBA_GAMES"
schema: "DEV"
"
[0m18:17:02.429748 [debug] [ThreadPool]: Using snowflake connection "create_NBA_GAMES_DEV"
[0m18:17:02.430290 [debug] [ThreadPool]: On create_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "create_NBA_GAMES_DEV"} */
create schema if not exists NBA_GAMES.DEV
[0m18:17:02.430654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:03.862063 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.431 seconds
[0m18:17:03.864355 [debug] [ThreadPool]: On create_NBA_GAMES_DEV: Close
[0m18:17:04.384390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES_DEV'
[0m18:17:04.398071 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m18:17:04.398529 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m18:17:04.398841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:05.699663 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.301 seconds
[0m18:17:05.702740 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m18:17:06.227933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57495d1e-a8f4-4e65-af6f-a3894ea84fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f792150>]}
[0m18:17:06.228821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:06.229267 [info ] [MainThread]: 
[0m18:17:06.233448 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m18:17:06.234020 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_games ...................................... [RUN]
[0m18:17:06.234477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m18:17:06.234911 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m18:17:06.242136 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m18:17:06.243209 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m18:17:06.293787 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m18:17:06.295609 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m18:17:06.295993 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m18:17:06.296285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:08.104036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.807 seconds
[0m18:17:08.192702 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m18:17:08.675718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57495d1e-a8f4-4e65-af6f-a3894ea84fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b3ad790>]}
[0m18:17:08.677781 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.44s]
[0m18:17:08.678762 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m18:17:08.680563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:08.680956 [debug] [MainThread]: Connection 'create_NBA_GAMES_DEV' was properly closed.
[0m18:17:08.681268 [debug] [MainThread]: Connection 'model.nba_analysis.src_games' was properly closed.
[0m18:17:08.681643 [info ] [MainThread]: 
[0m18:17:08.682012 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m18:17:08.682834 [debug] [MainThread]: Command end result
[0m18:17:08.707259 [info ] [MainThread]: 
[0m18:17:08.707683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:08.707925 [info ] [MainThread]: 
[0m18:17:08.708174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:17:08.710688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.704891, "process_user_time": 2.035198, "process_kernel_time": 0.344662, "process_mem_max_rss": "190316544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:17:08.711101 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:08.711042 after 9.71 seconds
[0m18:17:08.711388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105339c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105294cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052954d0>]}
[0m18:17:08.711651 [debug] [MainThread]: Flushing usage events
[0m10:52:21.812679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ff50>]}


============================== 10:52:21.815649 | 079c6702-9465-4e49-b1cd-74ba96eebb55 ==============================
[0m10:52:21.815649 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:52:21.815975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:52:21.824950 [info ] [MainThread]: dbt version: 1.8.7
[0m10:52:21.825180 [info ] [MainThread]: python version: 3.11.5
[0m10:52:21.825650 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m10:52:21.825816 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m10:52:22.600839 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m10:52:22.601109 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m10:52:22.601283 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m10:52:22.601691 [info ] [MainThread]: adapter type: snowflake
[0m10:52:22.601881 [info ] [MainThread]: adapter version: 1.8.4
[0m10:52:22.633348 [info ] [MainThread]: Configuration:
[0m10:52:22.633585 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:52:22.633737 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:52:22.633879 [info ] [MainThread]: Required dependencies:
[0m10:52:22.634051 [debug] [MainThread]: Executing "git --help"
[0m10:52:22.675001 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:52:22.675569 [debug] [MainThread]: STDERR: "b''"
[0m10:52:22.675778 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:52:22.676072 [info ] [MainThread]: Connection:
[0m10:52:22.676418 [info ] [MainThread]:   account: oslioxh-ra97663
[0m10:52:22.676637 [info ] [MainThread]:   user: dbt
[0m10:52:22.676804 [info ] [MainThread]:   database: NBA_GAMES
[0m10:52:22.677002 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:52:22.677144 [info ] [MainThread]:   role: transform
[0m10:52:22.677268 [info ] [MainThread]:   schema: DEV
[0m10:52:22.677388 [info ] [MainThread]:   authenticator: None
[0m10:52:22.677504 [info ] [MainThread]:   oauth_client_id: None
[0m10:52:22.677614 [info ] [MainThread]:   query_tag: None
[0m10:52:22.677729 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:52:22.677840 [info ] [MainThread]:   host: None
[0m10:52:22.677949 [info ] [MainThread]:   port: None
[0m10:52:22.678063 [info ] [MainThread]:   proxy_host: None
[0m10:52:22.678177 [info ] [MainThread]:   proxy_port: None
[0m10:52:22.678287 [info ] [MainThread]:   protocol: None
[0m10:52:22.678397 [info ] [MainThread]:   connect_retries: 1
[0m10:52:22.678506 [info ] [MainThread]:   connect_timeout: None
[0m10:52:22.678616 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:52:22.678725 [info ] [MainThread]:   retry_all: False
[0m10:52:22.678835 [info ] [MainThread]:   insecure_mode: False
[0m10:52:22.678942 [info ] [MainThread]:   reuse_connections: None
[0m10:52:22.679288 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:52:22.737796 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:52:22.738297 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:52:22.738434 [debug] [MainThread]: On debug: select 1 as id
[0m10:52:22.738554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:24.633102 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.894 seconds
[0m10:52:24.636331 [debug] [MainThread]: On debug: Close
[0m10:52:25.194122 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:52:25.195107 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:52:25.234890 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4540153, "process_user_time": 0.919825, "process_kernel_time": 0.28427, "process_mem_max_rss": "175996928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:52:25.241500 [debug] [MainThread]: Command `dbt debug` succeeded at 10:52:25.238978 after 3.46 seconds
[0m10:52:25.242307 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:52:25.242772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100991c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e79fd0>]}
[0m10:52:25.243228 [debug] [MainThread]: Flushing usage events
[0m11:11:42.724092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edff90>]}


============================== 11:11:42.726940 | 6db79302-fe5e-46cc-8be7-0530ca8b6f44 ==============================
[0m11:11:42.726940 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:11:42.727241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:11:43.508830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c31d3d0>]}
[0m11:11:43.527728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106931d10>]}
[0m11:11:43.528232 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:11:43.588808 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:11:43.620722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:43.620918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:43.630635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c584710>]}
[0m11:11:43.673176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e9950>]}
[0m11:11:43.673418 [info ] [MainThread]: Found 5 models, 459 macros
[0m11:11:43.673586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c532310>]}
[0m11:11:43.674450 [info ] [MainThread]: 
[0m11:11:43.674710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:43.676489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m11:11:43.683145 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m11:11:43.683377 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m11:11:43.683534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:45.640241 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.957 seconds
[0m11:11:45.642806 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m11:11:46.243800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m11:11:46.254169 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m11:11:46.254595 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m11:11:46.254909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:47.873008 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.618 seconds
[0m11:11:47.876671 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m11:11:48.488244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae33a50>]}
[0m11:11:48.490108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:48.490873 [info ] [MainThread]: 
[0m11:11:48.494063 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m11:11:48.494733 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_games ...................................... [RUN]
[0m11:11:48.495393 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m11:11:48.495803 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m11:11:48.503432 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m11:11:48.505003 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m11:11:48.525258 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m11:11:48.526244 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m11:11:48.526527 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m11:11:48.526777 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:11:50.630614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.103 seconds
[0m11:11:50.661776 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m11:11:51.255059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c575a10>]}
[0m11:11:51.256953 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.76s]
[0m11:11:51.257950 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m11:11:51.258542 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m11:11:51.259339 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_games_details .............................. [RUN]
[0m11:11:51.260030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m11:11:51.260497 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m11:11:51.263160 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m11:11:51.264212 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m11:11:51.324832 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m11:11:51.325747 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m11:11:51.325969 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as to,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m11:11:51.326174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:53.001819 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8604b-0102-31cd-0006-c35e00044116
[0m11:11:53.002562 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 8 unexpected 'to'.
[0m11:11:53.003287 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m11:11:53.564231 [debug] [Thread-1 (]: Database Error in model src_games_details (models/src/src_games_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 8 unexpected 'to'.
  compiled code at target/run/nba_analysis/models/src/src_games_details.sql
[0m11:11:53.564789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c502950>]}
[0m11:11:53.565253 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model DEV.src_games_details ..................... [[31mERROR[0m in 2.30s]
[0m11:11:53.565616 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m11:11:53.565853 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m11:11:53.567202 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_players .................................... [RUN]
[0m11:11:53.567901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m11:11:53.568393 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m11:11:53.571348 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m11:11:53.572340 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m11:11:53.575614 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m11:11:53.576318 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m11:11:53.576538 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m11:11:53.576724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:55.526111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.949 seconds
[0m11:11:55.531480 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m11:11:56.270068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a96e10>]}
[0m11:11:56.271928 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.70s]
[0m11:11:56.272812 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m11:11:56.273666 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m11:11:56.274378 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.src_ranking .................................... [RUN]
[0m11:11:56.274980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m11:11:56.275414 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m11:11:56.278250 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m11:11:56.279540 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m11:11:56.283513 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m11:11:56.284815 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m11:11:56.285224 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m11:11:56.285589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:58.207603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.922 seconds
[0m11:11:58.210627 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m11:11:58.828448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c25ff50>]}
[0m11:11:58.830190 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.55s]
[0m11:11:58.831205 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m11:11:58.831964 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m11:11:58.832727 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.src_teams ...................................... [RUN]
[0m11:11:58.833338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m11:11:58.833782 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m11:11:58.836178 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m11:11:58.837123 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m11:11:58.840526 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m11:11:58.841835 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m11:11:58.842218 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m11:11:58.842587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:00.837260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.994 seconds
[0m11:12:00.842105 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m11:12:01.413596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db79302-fe5e-46cc-8be7-0530ca8b6f44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e7cd0>]}
[0m11:12:01.415327 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.58s]
[0m11:12:01.416361 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m11:12:01.418294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:01.418807 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m11:12:01.419155 [debug] [MainThread]: Connection 'model.nba_analysis.src_teams' was properly closed.
[0m11:12:01.419674 [info ] [MainThread]: 
[0m11:12:01.420103 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 17.74 seconds (17.74s).
[0m11:12:01.421528 [debug] [MainThread]: Command end result
[0m11:12:01.453844 [info ] [MainThread]: 
[0m11:12:01.454560 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:12:01.455613 [info ] [MainThread]: 
[0m11:12:01.456567 [error] [MainThread]:   Database Error in model src_games_details (models/src/src_games_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 8 unexpected 'to'.
  compiled code at target/run/nba_analysis/models/src/src_games_details.sql
[0m11:12:01.458348 [info ] [MainThread]: 
[0m11:12:01.458942 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:12:01.469196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.78274, "process_user_time": 1.681456, "process_kernel_time": 0.367239, "process_mem_max_rss": "190955520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:12:01.472490 [debug] [MainThread]: Command `dbt run` failed at 11:12:01.471730 after 18.79 seconds
[0m11:12:01.474034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10358d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10358cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529fad0>]}
[0m11:12:01.476469 [debug] [MainThread]: Flushing usage events
[0m11:14:33.759401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ebf90>]}


============================== 11:14:33.763644 | 8fbdd9ac-93e0-4746-8c93-aa80d4c5288a ==============================
[0m11:14:33.763644 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:14:33.764083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:14:34.504762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e6010>]}
[0m11:14:34.524279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b31d50>]}
[0m11:14:34.524838 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:14:34.585505 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:14:34.617185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:34.617377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:34.626858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d1390>]}
[0m11:14:34.665842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c779d50>]}
[0m11:14:34.666078 [info ] [MainThread]: Found 5 models, 459 macros
[0m11:14:34.666243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8896d0>]}
[0m11:14:34.667088 [info ] [MainThread]: 
[0m11:14:34.667345 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:34.669161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m11:14:34.675877 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m11:14:34.676040 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m11:14:34.676164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:36.527875 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.851 seconds
[0m11:14:36.532455 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m11:14:37.113723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m11:14:37.128459 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m11:14:37.128909 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m11:14:37.129391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:38.828205 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.699 seconds
[0m11:14:38.832947 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m11:14:39.396318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5b3810>]}
[0m11:14:39.398331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:39.399363 [info ] [MainThread]: 
[0m11:14:39.407937 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m11:14:39.410779 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_games ...................................... [RUN]
[0m11:14:39.413099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m11:14:39.414455 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m11:14:39.440746 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m11:14:39.441887 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m11:14:39.474865 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m11:14:39.476665 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m11:14:39.477146 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m11:14:39.477559 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:14:41.522554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.045 seconds
[0m11:14:41.552334 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m11:14:42.098870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb3e990>]}
[0m11:14:42.101008 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.68s]
[0m11:14:42.102121 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m11:14:42.102832 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m11:14:42.103739 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_games_details .............................. [RUN]
[0m11:14:42.104471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m11:14:42.104966 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m11:14:42.108173 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m11:14:42.109289 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m11:14:42.190319 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m11:14:42.191155 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m11:14:42.191361 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m11:14:42.191535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:44.300534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.109 seconds
[0m11:14:44.305481 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m11:14:44.919577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcedc10>]}
[0m11:14:44.920675 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.82s]
[0m11:14:44.921416 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m11:14:44.921911 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m11:14:44.922598 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_players .................................... [RUN]
[0m11:14:44.923246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m11:14:44.923696 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m11:14:44.925952 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m11:14:44.926749 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m11:14:44.930239 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m11:14:44.931414 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m11:14:44.931816 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m11:14:44.932174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:46.630807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.698 seconds
[0m11:14:46.636897 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m11:14:47.275197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c510990>]}
[0m11:14:47.277028 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.35s]
[0m11:14:47.278146 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m11:14:47.278786 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m11:14:47.288815 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.src_ranking .................................... [RUN]
[0m11:14:47.295172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m11:14:47.296226 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m11:14:47.298624 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m11:14:47.299345 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m11:14:47.302319 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m11:14:47.303196 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m11:14:47.303436 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m11:14:47.303683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:49.078990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.774 seconds
[0m11:14:49.086731 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m11:14:49.707141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e4990>]}
[0m11:14:49.714462 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.41s]
[0m11:14:49.715443 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m11:14:49.716085 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m11:14:49.716907 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.src_teams ...................................... [RUN]
[0m11:14:49.717554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m11:14:49.717983 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m11:14:49.722261 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m11:14:49.723166 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m11:14:49.726666 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m11:14:49.728169 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m11:14:49.728623 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m11:14:49.729223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:51.596669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.867 seconds
[0m11:14:51.599962 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m11:14:52.191024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbdd9ac-93e0-4746-8c93-aa80d4c5288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c510bd0>]}
[0m11:14:52.192465 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.47s]
[0m11:14:52.193281 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m11:14:52.195480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:52.195843 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m11:14:52.196151 [debug] [MainThread]: Connection 'model.nba_analysis.src_teams' was properly closed.
[0m11:14:52.196769 [info ] [MainThread]: 
[0m11:14:52.197184 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 17.53 seconds (17.53s).
[0m11:14:52.198786 [debug] [MainThread]: Command end result
[0m11:14:52.229203 [info ] [MainThread]: 
[0m11:14:52.229520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:52.229716 [info ] [MainThread]: 
[0m11:14:52.229964 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:14:52.232436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.506937, "process_user_time": 1.651992, "process_kernel_time": 0.409385, "process_mem_max_rss": "189284352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:14:52.232814 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:52.232766 after 18.51 seconds
[0m11:14:52.233088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103831c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10378ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10378d5d0>]}
[0m11:14:52.233295 [debug] [MainThread]: Flushing usage events
[0m12:08:59.942894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b7fd0>]}


============================== 12:08:59.945857 | f2d747b7-9613-48fe-92ac-a3f9518dc14e ==============================
[0m12:08:59.945857 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:08:59.946160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:08:59.955777 [info ] [MainThread]: dbt version: 1.8.7
[0m12:08:59.955976 [info ] [MainThread]: python version: 3.11.5
[0m12:08:59.956126 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m12:08:59.956261 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m12:09:00.659703 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m12:09:00.660054 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m12:09:00.660256 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m12:09:00.660772 [info ] [MainThread]: adapter type: snowflake
[0m12:09:00.660959 [info ] [MainThread]: adapter version: 1.8.4
[0m12:09:00.692843 [info ] [MainThread]: Configuration:
[0m12:09:00.693085 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:09:00.693235 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:09:00.693366 [info ] [MainThread]: Required dependencies:
[0m12:09:00.693540 [debug] [MainThread]: Executing "git --help"
[0m12:09:00.723465 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:09:00.724005 [debug] [MainThread]: STDERR: "b''"
[0m12:09:00.724181 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:09:00.724349 [info ] [MainThread]: Connection:
[0m12:09:00.724510 [info ] [MainThread]:   account: oslioxh-ra97663
[0m12:09:00.724638 [info ] [MainThread]:   user: dbt
[0m12:09:00.724757 [info ] [MainThread]:   database: NBA_GAMES
[0m12:09:00.724872 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:09:00.724981 [info ] [MainThread]:   role: transform
[0m12:09:00.725094 [info ] [MainThread]:   schema: DEV
[0m12:09:00.725205 [info ] [MainThread]:   authenticator: None
[0m12:09:00.725316 [info ] [MainThread]:   oauth_client_id: None
[0m12:09:00.725424 [info ] [MainThread]:   query_tag: None
[0m12:09:00.725534 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:09:00.725642 [info ] [MainThread]:   host: None
[0m12:09:00.725747 [info ] [MainThread]:   port: None
[0m12:09:00.725856 [info ] [MainThread]:   proxy_host: None
[0m12:09:00.725965 [info ] [MainThread]:   proxy_port: None
[0m12:09:00.726073 [info ] [MainThread]:   protocol: None
[0m12:09:00.726182 [info ] [MainThread]:   connect_retries: 1
[0m12:09:00.726289 [info ] [MainThread]:   connect_timeout: None
[0m12:09:00.726395 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:09:00.726498 [info ] [MainThread]:   retry_all: False
[0m12:09:00.726602 [info ] [MainThread]:   insecure_mode: False
[0m12:09:00.726707 [info ] [MainThread]:   reuse_connections: None
[0m12:09:00.726987 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:09:00.783168 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:09:00.783645 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:09:00.783782 [debug] [MainThread]: On debug: select 1 as id
[0m12:09:00.783905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:02.702952 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.919 seconds
[0m12:09:02.705604 [debug] [MainThread]: On debug: Close
[0m12:09:03.259440 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:09:03.259935 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:09:03.263287 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.356319, "process_user_time": 0.938592, "process_kernel_time": 0.27213, "process_mem_max_rss": "186171392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:03.263921 [debug] [MainThread]: Command `dbt debug` succeeded at 12:09:03.263834 after 3.36 seconds
[0m12:09:03.264171 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:09:03.264416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a7e50>]}
[0m12:09:03.264690 [debug] [MainThread]: Flushing usage events
[0m12:09:07.271774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bf90>]}


============================== 12:09:07.274148 | 64ba74ff-806f-4cb9-8f36-4fb8f69631db ==============================
[0m12:09:07.274148 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:09:07.274471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:07.757149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc7e250>]}
[0m12:09:07.776133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7dd90>]}
[0m12:09:07.776641 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:09:07.839608 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:09:07.872710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:07.872914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:07.882810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd3750>]}
[0m12:09:07.920493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c224e50>]}
[0m12:09:07.920735 [info ] [MainThread]: Found 6 models, 459 macros
[0m12:09:07.920902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c164b90>]}
[0m12:09:07.921788 [info ] [MainThread]: 
[0m12:09:07.922054 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:07.923923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:09:07.930274 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:09:07.930435 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:09:07.930589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:09.659583 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.728 seconds
[0m12:09:09.663475 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:09:10.253553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:09:10.266072 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:09:10.266606 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:09:10.266897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:11.830469 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.563 seconds
[0m12:09:11.834925 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:09:12.506752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfdfe10>]}
[0m12:09:12.507976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:12.508425 [info ] [MainThread]: 
[0m12:09:12.512592 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:09:12.513335 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_games ...................................... [RUN]
[0m12:09:12.514063 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:09:12.514734 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:09:12.522526 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:09:12.523452 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:09:12.543639 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:09:12.544636 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:09:12.544917 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:09:12.545164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:14.375247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.830 seconds
[0m12:09:14.403799 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:09:14.955658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec8ed0>]}
[0m12:09:14.957121 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.44s]
[0m12:09:14.958020 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:09:14.958805 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:09:14.959594 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:09:14.960257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:09:14.960781 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:09:14.963476 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:09:14.965972 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:09:15.021612 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:09:15.022560 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:09:15.022796 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:09:15.022996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:17.059501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.036 seconds
[0m12:09:17.064621 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:09:17.729412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c12c250>]}
[0m12:09:17.731168 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.77s]
[0m12:09:17.731940 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:09:17.732486 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:09:17.733239 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_players .................................... [RUN]
[0m12:09:17.733975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:09:17.734432 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:09:17.736921 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:09:17.738969 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:09:17.742573 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:09:17.743895 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:09:17.744289 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:09:17.744712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:19.430451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.685 seconds
[0m12:09:19.435395 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:09:20.085030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd96510>]}
[0m12:09:20.086613 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.35s]
[0m12:09:20.087650 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:09:20.088381 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:09:20.089402 [info ] [Thread-1 (]: 4 of 6 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:09:20.090055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:09:20.090521 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:09:20.094521 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:09:20.096301 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:09:20.099895 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:09:20.101192 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:09:20.101583 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:09:20.101951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:22.127374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.025 seconds
[0m12:09:22.132782 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:09:23.114454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff1650>]}
[0m12:09:23.117338 [info ] [Thread-1 (]: 4 of 6 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 3.02s]
[0m12:09:23.118308 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:09:23.119009 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:09:23.119707 [info ] [Thread-1 (]: 5 of 6 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:09:23.120299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:09:23.120729 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:09:23.123593 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:09:23.124828 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:09:23.129207 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:09:23.130689 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:09:23.131096 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:09:23.131512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:25.097535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.966 seconds
[0m12:09:25.101423 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:09:25.639483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058be550>]}
[0m12:09:25.640709 [info ] [Thread-1 (]: 5 of 6 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.52s]
[0m12:09:25.641575 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:09:25.642101 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:09:25.642782 [info ] [Thread-1 (]: 6 of 6 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:09:25.643437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:09:25.643892 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:09:25.649284 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:09:25.650731 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:09:25.653672 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:09:25.654670 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:09:25.654994 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:09:25.655286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:27.339509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.683 seconds
[0m12:09:27.345334 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:09:27.968466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ba74ff-806f-4cb9-8f36-4fb8f69631db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be5e710>]}
[0m12:09:27.970022 [info ] [Thread-1 (]: 6 of 6 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.32s]
[0m12:09:27.971040 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:09:27.972704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:27.973074 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:09:27.973387 [debug] [MainThread]: Connection 'model.nba_analysis.dim_players_cleansed' was properly closed.
[0m12:09:27.973874 [info ] [MainThread]: 
[0m12:09:27.974279 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 20.05 seconds (20.05s).
[0m12:09:27.975793 [debug] [MainThread]: Command end result
[0m12:09:28.006288 [info ] [MainThread]: 
[0m12:09:28.006618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:28.006841 [info ] [MainThread]: 
[0m12:09:28.007063 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:09:28.009206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.762505, "process_user_time": 1.786027, "process_kernel_time": 0.273174, "process_mem_max_rss": "192397312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:28.009535 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:28.009484 after 20.76 seconds
[0m12:09:28.010052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b24150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b7dc90>]}
[0m12:09:28.010325 [debug] [MainThread]: Flushing usage events
[0m12:15:47.220028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051277d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105127f10>]}


============================== 12:15:47.222692 | 6f96d654-71ce-4e31-9f74-66b0ff6de209 ==============================
[0m12:15:47.222692 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:15:47.222992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:15:47.985177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe314d0>]}
[0m12:15:48.003996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6dcd0>]}
[0m12:15:48.004517 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:15:48.065213 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:15:48.097350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:15:48.097535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:15:48.107646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513a490>]}
[0m12:15:48.144994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b516250>]}
[0m12:15:48.145231 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:15:48.145400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe55cd0>]}
[0m12:15:48.146483 [info ] [MainThread]: 
[0m12:15:48.146768 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:15:48.148613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:15:48.155310 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:15:48.155498 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:15:48.155643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:49.903018 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.747 seconds
[0m12:15:49.906632 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:15:50.482503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:15:50.493003 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:15:50.493424 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:15:50.493731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:52.006696 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.513 seconds
[0m12:15:52.010738 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:15:52.650140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8d190>]}
[0m12:15:52.651408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:52.651971 [info ] [MainThread]: 
[0m12:15:52.654876 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:15:52.655603 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:15:52.656267 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:15:52.656696 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:15:52.664460 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:15:52.665887 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:15:52.687242 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:15:52.688377 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:15:52.688654 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:15:52.688888 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:54.636866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.948 seconds
[0m12:15:54.659973 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:15:55.248910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b694ad0>]}
[0m12:15:55.250464 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.59s]
[0m12:15:55.251482 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:15:55.252235 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:15:55.253196 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:15:55.254011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:15:55.254482 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:15:55.257127 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:15:55.259037 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:15:55.262681 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:15:55.264224 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:15:55.264654 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:15:55.265053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:57.363303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.098 seconds
[0m12:15:57.368953 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:15:57.936507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb93d90>]}
[0m12:15:57.938666 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.68s]
[0m12:15:57.939600 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:15:57.940230 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:15:57.941045 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:15:57.941808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:15:57.942327 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:15:57.946455 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:15:57.947857 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:15:57.955554 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:15:57.959527 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:15:57.960027 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:15:57.960386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:59.534143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m12:15:59.537915 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:16:00.160893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c0f350>]}
[0m12:16:00.163442 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.22s]
[0m12:16:00.164800 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:16:00.165543 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:16:00.166660 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:16:00.167694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:16:00.168265 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:16:00.170984 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:16:00.172636 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:16:00.176074 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:16:00.177314 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:16:00.177704 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:16:00.178077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:02.070841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.892 seconds
[0m12:16:02.083829 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:16:02.628305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458ba10>]}
[0m12:16:02.629739 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.46s]
[0m12:16:02.630629 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:16:02.631304 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:16:02.632092 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:16:02.632775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:16:02.633314 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:16:02.636206 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:16:02.637076 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:16:02.642558 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:16:02.643535 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:16:02.643977 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:16:02.644461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:04.405599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.761 seconds
[0m12:16:04.410204 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:16:04.951798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b574690>]}
[0m12:16:04.953256 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.32s]
[0m12:16:04.954043 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:16:04.954639 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:16:04.955727 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:16:04.956390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:16:04.957048 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:16:04.961618 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:16:04.962528 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:16:04.965723 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:16:04.966839 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:16:04.967175 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:16:04.967471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:06.804043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.836 seconds
[0m12:16:06.811366 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:16:07.389435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581d510>]}
[0m12:16:07.390811 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.43s]
[0m12:16:07.391831 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:16:07.392598 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:16:07.393446 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:16:07.394101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:16:07.394577 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:16:07.399833 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:16:07.401293 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:16:07.405479 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:16:07.407387 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:16:07.407777 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID ~ '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID ~ '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR ~ '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR ~ '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CASE
        WHEN YEARFOUNDED ~ '^[0-9]+$' THEN CAST(YEARFOUNDED AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(ARENACAPACITY, 0) AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams;
[0m12:16:07.408804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:09.124130 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8608c-0102-3227-0006-c35e0004728e
[0m12:16:09.124536 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 23 unexpected '~'.
syntax error line 9 at position 45 unexpected '('.
[0m12:16:09.124907 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:16:09.705171 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 23 unexpected '~'.
  syntax error line 9 at position 45 unexpected '('.
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:16:09.706073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f96d654-71ce-4e31-9f74-66b0ff6de209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513fa90>]}
[0m12:16:09.706922 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.31s]
[0m12:16:09.707632 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:16:09.710732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:09.711046 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:16:09.711296 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:16:09.711793 [info ] [MainThread]: 
[0m12:16:09.712135 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 21.56 seconds (21.56s).
[0m12:16:09.713837 [debug] [MainThread]: Command end result
[0m12:16:09.754369 [info ] [MainThread]: 
[0m12:16:09.754755 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:09.754988 [info ] [MainThread]: 
[0m12:16:09.755224 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 23 unexpected '~'.
  syntax error line 9 at position 45 unexpected '('.
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:16:09.755404 [info ] [MainThread]: 
[0m12:16:09.755672 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:16:09.762641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.573036, "process_user_time": 1.84456, "process_kernel_time": 0.389562, "process_mem_max_rss": "198164480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:09.763007 [debug] [MainThread]: Command `dbt run` failed at 12:16:09.762962 after 22.57 seconds
[0m12:16:09.763264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017c95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017c8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf7fe50>]}
[0m12:16:09.763491 [debug] [MainThread]: Flushing usage events
[0m12:19:00.301070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bfb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf8cd0>]}


============================== 12:19:00.303799 | 36e7f0d5-5162-4e4d-b95a-e03f9758c933 ==============================
[0m12:19:00.303799 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:19:00.304094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:19:00.313426 [info ] [MainThread]: dbt version: 1.8.7
[0m12:19:00.313651 [info ] [MainThread]: python version: 3.11.5
[0m12:19:00.313808 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m12:19:00.313940 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m12:19:00.963674 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m12:19:00.963940 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m12:19:00.964084 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m12:19:00.964431 [info ] [MainThread]: adapter type: snowflake
[0m12:19:00.964603 [info ] [MainThread]: adapter version: 1.8.4
[0m12:19:00.994485 [info ] [MainThread]: Configuration:
[0m12:19:00.994703 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:19:00.994847 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:19:00.994978 [info ] [MainThread]: Required dependencies:
[0m12:19:00.995140 [debug] [MainThread]: Executing "git --help"
[0m12:19:01.029235 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:19:01.029863 [debug] [MainThread]: STDERR: "b''"
[0m12:19:01.030078 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:19:01.030256 [info ] [MainThread]: Connection:
[0m12:19:01.030434 [info ] [MainThread]:   account: oslioxh-ra97663
[0m12:19:01.030561 [info ] [MainThread]:   user: dbt
[0m12:19:01.030678 [info ] [MainThread]:   database: NBA_GAMES
[0m12:19:01.030790 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:19:01.030899 [info ] [MainThread]:   role: transform
[0m12:19:01.031010 [info ] [MainThread]:   schema: DEV
[0m12:19:01.031120 [info ] [MainThread]:   authenticator: None
[0m12:19:01.031232 [info ] [MainThread]:   oauth_client_id: None
[0m12:19:01.031340 [info ] [MainThread]:   query_tag: None
[0m12:19:01.031448 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:19:01.031555 [info ] [MainThread]:   host: None
[0m12:19:01.031668 [info ] [MainThread]:   port: None
[0m12:19:01.031776 [info ] [MainThread]:   proxy_host: None
[0m12:19:01.031884 [info ] [MainThread]:   proxy_port: None
[0m12:19:01.031991 [info ] [MainThread]:   protocol: None
[0m12:19:01.032096 [info ] [MainThread]:   connect_retries: 1
[0m12:19:01.032199 [info ] [MainThread]:   connect_timeout: None
[0m12:19:01.032305 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:19:01.032411 [info ] [MainThread]:   retry_all: False
[0m12:19:01.032515 [info ] [MainThread]:   insecure_mode: False
[0m12:19:01.032621 [info ] [MainThread]:   reuse_connections: None
[0m12:19:01.032925 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:19:01.089185 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:19:01.089680 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:19:01.089817 [debug] [MainThread]: On debug: select 1 as id
[0m12:19:01.089938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:02.735611 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.645 seconds
[0m12:19:02.738282 [debug] [MainThread]: On debug: Close
[0m12:19:03.278314 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:19:03.279484 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:19:03.285107 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.013841, "process_user_time": 0.920737, "process_kernel_time": 0.234805, "process_mem_max_rss": "186482688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:19:03.286029 [debug] [MainThread]: Command `dbt debug` succeeded at 12:19:03.285878 after 3.01 seconds
[0m12:19:03.286588 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:19:03.287591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051faa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0bfd0>]}
[0m12:19:03.288238 [debug] [MainThread]: Flushing usage events
[0m12:19:06.639049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccbb10>]}


============================== 12:19:06.640913 | 0f466698-29ef-49e8-980d-682234a071e3 ==============================
[0m12:19:06.640913 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:19:06.641228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:19:07.094968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f466698-29ef-49e8-980d-682234a071e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e7e510>]}
[0m12:19:07.114306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f466698-29ef-49e8-980d-682234a071e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d45d90>]}
[0m12:19:07.114860 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:19:07.173734 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:19:07.205931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:07.206118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:07.216324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f466698-29ef-49e8-980d-682234a071e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a456250>]}
[0m12:19:07.253956 [error] [MainThread]: Encountered an error:
Found a cycle: model.nba_analysis.src_teams
[0m12:19:07.256401 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.nba_analysis.src_teams

[0m12:19:07.257555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.64193946, "process_user_time": 0.883457, "process_kernel_time": 0.161363, "process_mem_max_rss": "191545344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:19:07.257798 [debug] [MainThread]: Command `dbt run` failed at 12:19:07.257759 after 0.64 seconds
[0m12:19:07.257963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c95d0>]}
[0m12:19:07.258111 [debug] [MainThread]: Flushing usage events
[0m12:19:46.939204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107399d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e49d0>]}


============================== 12:19:46.941955 | f3555496-6e22-40f1-bf79-4b79907300da ==============================
[0m12:19:46.941955 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:19:46.942274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:19:47.452414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e861a90>]}
[0m12:19:47.471133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8db50>]}
[0m12:19:47.471619 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:19:47.531318 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:19:47.563402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:47.563599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:47.573814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8c4490>]}
[0m12:19:47.610442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb16490>]}
[0m12:19:47.610673 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:19:47.610837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106780c10>]}
[0m12:19:47.611913 [info ] [MainThread]: 
[0m12:19:47.612167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:47.614028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:19:47.620751 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:19:47.620921 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:19:47.621049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:49.364774 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.743 seconds
[0m12:19:49.368087 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:19:50.048865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:19:50.058933 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:19:50.059333 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:19:50.059635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:51.578730 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.519 seconds
[0m12:19:51.583496 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:19:52.199476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676a590>]}
[0m12:19:52.201147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:52.201661 [info ] [MainThread]: 
[0m12:19:52.205940 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:19:52.206747 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:19:52.207405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m12:19:52.207857 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:19:52.217133 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:19:52.218672 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:19:52.240431 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:19:52.241411 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:19:52.241671 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:19:52.241911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:54.377617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.135 seconds
[0m12:19:54.406911 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:19:54.992538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107295550>]}
[0m12:19:54.994007 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.78s]
[0m12:19:54.995050 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:19:54.995628 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:19:54.996325 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:19:54.997004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:19:54.997469 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:19:55.000090 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:19:55.002341 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:19:55.006045 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:19:55.007663 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:19:55.008089 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:19:55.009035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:57.109287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.100 seconds
[0m12:19:57.114244 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:19:57.731011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107386a90>]}
[0m12:19:57.732539 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.73s]
[0m12:19:57.733629 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:19:57.734410 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:19:57.735214 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:19:57.735849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:19:57.736299 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:19:57.740331 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:19:57.741562 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:19:57.745805 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:19:57.747389 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:19:57.747804 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:19:57.748161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:59.410900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.662 seconds
[0m12:19:59.415988 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:20:00.049022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f789a90>]}
[0m12:20:00.049631 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.31s]
[0m12:20:00.050150 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:20:00.050567 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:20:00.051103 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:20:00.051461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:20:00.051710 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:20:00.053067 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:20:00.053756 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:20:00.055883 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:20:00.056765 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:20:00.057171 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:20:00.057513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:01.764232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.707 seconds
[0m12:20:01.766678 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:20:02.319857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8e9810>]}
[0m12:20:02.321504 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.27s]
[0m12:20:02.323196 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:20:02.324092 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:20:02.326105 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:20:02.327040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:20:02.327573 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:20:02.329175 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:20:02.329813 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:20:02.332510 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:20:02.333561 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:20:02.333785 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:20:02.333968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:04.174093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.840 seconds
[0m12:20:04.178961 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:20:04.725198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad1d50>]}
[0m12:20:04.727272 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.40s]
[0m12:20:04.728203 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:20:04.730049 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:20:04.731302 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:20:04.732176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:20:04.732659 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:20:04.737760 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:20:04.739273 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:20:04.742862 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:20:04.743940 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:20:04.744325 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:20:04.744689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:06.529797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.785 seconds
[0m12:20:06.534747 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:20:07.149754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb69e50>]}
[0m12:20:07.151631 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.42s]
[0m12:20:07.152475 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:20:07.153062 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:20:07.154020 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:20:07.155086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:20:07.155720 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:20:07.160511 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:20:07.161607 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:20:07.164709 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:20:07.166364 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:20:07.166797 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CASE
        WHEN YEARFOUNDED REGEXP '^[0-9]+$' THEN CAST(YEARFOUNDED AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(ARENACAPACITY, 0) AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams
  );
[0m12:20:07.167244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:08.809458 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86090-0102-3227-0006-c35e000472ba
[0m12:20:08.810471 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 4
invalid identifier 'ABBREVIATION'
[0m12:20:08.811053 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:20:09.406275 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'ABBREVIATION'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:20:09.407366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3555496-6e22-40f1-bf79-4b79907300da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e8d90>]}
[0m12:20:09.408212 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.25s]
[0m12:20:09.408940 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:20:09.412061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:09.412400 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:20:09.412854 [info ] [MainThread]: 
[0m12:20:09.413188 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 21.80 seconds (21.80s).
[0m12:20:09.414449 [debug] [MainThread]: Command end result
[0m12:20:09.444746 [info ] [MainThread]: 
[0m12:20:09.445081 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:20:09.445278 [info ] [MainThread]: 
[0m12:20:09.445565 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'ABBREVIATION'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:20:09.445825 [info ] [MainThread]: 
[0m12:20:09.446080 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:20:09.448595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.545734, "process_user_time": 1.876779, "process_kernel_time": 0.317588, "process_mem_max_rss": "197738496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:20:09.448958 [debug] [MainThread]: Command `dbt run` failed at 12:20:09.448914 after 22.55 seconds
[0m12:20:09.449254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ff950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fad5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050293d0>]}
[0m12:20:09.449449 [debug] [MainThread]: Flushing usage events
[0m12:23:14.399621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b52690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb7990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb7f90>]}


============================== 12:23:14.402370 | 1c984311-4bd5-4020-b71a-2b66f23d5c73 ==============================
[0m12:23:14.402370 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:23:14.402713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:14.932689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118eb6010>]}
[0m12:23:14.951485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107445d90>]}
[0m12:23:14.951986 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:23:15.012392 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:23:15.046770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:15.046975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:15.057727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3ddc90>]}
[0m12:23:15.096262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f817e10>]}
[0m12:23:15.096500 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:23:15.096663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b744d0>]}
[0m12:23:15.097722 [info ] [MainThread]: 
[0m12:23:15.097972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:23:15.099793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:23:15.106566 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:23:15.106759 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:23:15.106900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:16.958743 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.852 seconds
[0m12:23:16.959990 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:23:17.525762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:23:17.536195 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:23:17.536659 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:23:17.536958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:19.110648 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.574 seconds
[0m12:23:19.112542 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:23:20.586458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e47d90>]}
[0m12:23:20.587897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:20.588407 [info ] [MainThread]: 
[0m12:23:20.592562 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:23:20.593405 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:23:20.594226 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:23:20.594938 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:23:20.603386 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:23:20.604809 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:23:20.626278 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:23:20.627230 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:23:20.627490 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:23:20.627721 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:23:22.727507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.099 seconds
[0m12:23:22.753749 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:23:23.320248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef47310>]}
[0m12:23:23.321481 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.72s]
[0m12:23:23.322272 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:23:23.322791 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:23:23.323460 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:23:23.324104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:23:23.324565 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:23:23.327017 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:23:23.329617 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:23:23.333372 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:23:23.334912 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:23:23.335356 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:23:23.335785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:25.595856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.260 seconds
[0m12:23:25.600136 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:23:26.213038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec4df50>]}
[0m12:23:26.214015 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.89s]
[0m12:23:26.214729 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:23:26.215226 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:23:26.215897 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:23:26.216508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:23:26.216941 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:23:26.219359 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:23:26.220121 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:23:26.223818 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:23:26.224828 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:23:26.225168 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:23:26.225459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:28.310234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.085 seconds
[0m12:23:28.316011 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:23:28.878504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd4910>]}
[0m12:23:28.880525 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.66s]
[0m12:23:28.881637 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:23:28.882327 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:23:28.883275 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:23:28.883967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:23:28.884363 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:23:28.888244 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:23:28.889801 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:23:28.893281 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:23:28.894515 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:23:28.894919 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:23:28.895286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:30.716822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.821 seconds
[0m12:23:30.724653 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:23:31.283776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119356690>]}
[0m12:23:31.284792 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.40s]
[0m12:23:31.285318 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:23:31.285666 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:23:31.286153 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:23:31.286519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:23:31.286724 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:23:31.288610 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:23:31.289066 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:23:31.293526 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:23:31.294462 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:23:31.294718 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:23:31.295137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:33.087695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.792 seconds
[0m12:23:33.100048 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:23:33.680027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a78750>]}
[0m12:23:33.682504 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.39s]
[0m12:23:33.683919 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:23:33.684682 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:23:33.685707 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:23:33.686450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:23:33.686983 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:23:33.692327 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:23:33.693905 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:23:33.697814 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:23:33.698719 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:23:33.699049 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:23:33.699351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:35.339904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.640 seconds
[0m12:23:35.345632 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:23:35.956221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba0f10>]}
[0m12:23:35.958610 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.27s]
[0m12:23:35.959947 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:23:35.960659 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:23:35.961538 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:23:35.962176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:23:35.963046 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:23:35.969001 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:23:35.971196 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:23:35.974892 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:23:35.976898 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:23:35.977310 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CASE
        WHEN YEARFOUNDED REGEXP '^[0-9]+$' THEN CAST(YEARFOUNDED AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(ARENACAPACITY, 0) AS arena_capacity,
    "OWNER" AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams
  );
[0m12:23:35.977728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:37.615908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86093-0102-3227-0006-c35e000472da
[0m12:23:37.616577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 4
invalid identifier 'ABBREVIATION'
[0m12:23:37.617217 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:23:38.291844 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'ABBREVIATION'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:23:38.292987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c984311-4bd5-4020-b71a-2b66f23d5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618fc90>]}
[0m12:23:38.293906 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.33s]
[0m12:23:38.294699 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:23:38.297046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:38.297320 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:23:38.297468 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:23:38.297723 [info ] [MainThread]: 
[0m12:23:38.297901 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 23.20 seconds (23.20s).
[0m12:23:38.298556 [debug] [MainThread]: Command end result
[0m12:23:38.322931 [info ] [MainThread]: 
[0m12:23:38.323223 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:38.323383 [info ] [MainThread]: 
[0m12:23:38.323626 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'ABBREVIATION'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:23:38.323851 [info ] [MainThread]: 
[0m12:23:38.324094 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:23:38.326533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 23.955284, "process_user_time": 1.823991, "process_kernel_time": 0.338713, "process_mem_max_rss": "198246400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:23:38.326906 [debug] [MainThread]: Command `dbt run` failed at 12:23:38.326863 after 23.96 seconds
[0m12:23:38.327183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129033f10>]}
[0m12:23:38.327369 [debug] [MainThread]: Flushing usage events
[0m12:24:57.213780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ffd10>]}


============================== 12:24:57.216538 | 6d3ca801-25eb-4c14-be22-d0ee25a256fe ==============================
[0m12:24:57.216538 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:24:57.216848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:24:57.733135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d3ca801-25eb-4c14-be22-d0ee25a256fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104980c50>]}
[0m12:24:57.752735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d3ca801-25eb-4c14-be22-d0ee25a256fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105045c50>]}
[0m12:24:57.753323 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:24:57.813546 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:24:57.845797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:57.845990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:57.856175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d3ca801-25eb-4c14-be22-d0ee25a256fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121226190>]}
[0m12:24:57.893704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d3ca801-25eb-4c14-be22-d0ee25a256fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121516090>]}
[0m12:24:57.893945 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:24:57.894120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3ca801-25eb-4c14-be22-d0ee25a256fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121466910>]}
[0m12:24:57.895162 [info ] [MainThread]: 
[0m12:24:57.895414 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:57.897299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:24:57.903609 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:24:57.903783 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:24:57.903917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:59.663578 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.759 seconds
[0m12:24:59.667577 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:25:00.321051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:25:00.334531 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:25:00.335029 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:25:00.335420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:02.262916 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.927 seconds
[0m12:25:02.267270 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:25:02.835238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3ca801-25eb-4c14-be22-d0ee25a256fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a3f090>]}
[0m12:25:02.836336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:02.836873 [info ] [MainThread]: 
[0m12:25:02.839958 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:25:02.840567 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:25:02.841118 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:25:02.841448 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:25:02.849127 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:25:02.850797 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:25:02.871922 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:25:02.872894 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:25:02.873151 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:25:02.873378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:04.924906 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.nba_analysis.src_games' (1903658354905218)
[0m12:25:04.926163 [debug] [MainThread]: Using snowflake connection "master"
[0m12:25:04.926909 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1903658354905218)
[0m12:25:04.927418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:04.995508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.122 seconds
[0m12:25:06.497419 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.570 seconds
[0m12:25:06.500206 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.nba_analysis.src_games': ('0 cancelled. ',)
[0m12:25:06.501419 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:25:06.500874 [error] [MainThread]: CANCEL query list_NBA_GAMES_DEV ................................................ [[31mCANCEL[0m]
[0m12:25:06.503825 [error] [MainThread]: CANCEL query model.nba_analysis.src_games ...................................... [[31mCANCEL[0m]
[0m12:25:06.504825 [debug] [MainThread]: On master: Close
[0m12:25:07.071753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3ca801-25eb-4c14-be22-d0ee25a256fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c34a50>]}
[0m12:25:07.072884 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 4.23s]
[0m12:25:07.074631 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:25:07.075199 [info ] [MainThread]: 
[0m12:25:07.075696 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m12:25:07.076051 [info ] [MainThread]: 
[0m12:25:07.076447 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m12:25:07.076789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:07.077048 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:25:07.077281 [debug] [MainThread]: Connection 'model.nba_analysis.src_games' was properly closed.
[0m12:25:07.077600 [info ] [MainThread]: 
[0m12:25:07.077891 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 9.18 seconds (9.18s).
[0m12:25:07.078484 [error] [MainThread]: Encountered an error:

[0m12:25:07.083689 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 305, in run_queue
    self.handle_job_queue(pool, callback)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 324, in handle_job_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/Users/Shared/anaconda3/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m12:25:07.089116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.901653, "process_user_time": 1.345541, "process_kernel_time": 0.251558, "process_mem_max_rss": "191430656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:25:07.090231 [debug] [MainThread]: Command `dbt run` failed at 12:25:07.090145 after 9.90 seconds
[0m12:25:07.090649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008955d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100894d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12120f090>]}
[0m12:25:07.091037 [debug] [MainThread]: Flushing usage events
[0m12:25:10.082886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbe710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbe850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017f90>]}


============================== 12:25:10.085225 | 7ecad33f-aa9e-4179-8a03-5be8c81de0db ==============================
[0m12:25:10.085225 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:25:10.085523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:10.550405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecf8d0>]}
[0m12:25:10.568909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a69d10>]}
[0m12:25:10.569910 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:10.629838 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:25:10.663167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:10.663361 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:10.673589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ea790>]}
[0m12:25:10.711124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6fde50>]}
[0m12:25:10.711375 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:25:10.711544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107001ed0>]}
[0m12:25:10.712590 [info ] [MainThread]: 
[0m12:25:10.712853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:10.714746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:25:10.721228 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:25:10.721403 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:25:10.721565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:12.613788 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.892 seconds
[0m12:25:12.617199 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:25:13.218400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:25:13.230387 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:25:13.230951 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:25:13.231324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:14.956090 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.724 seconds
[0m12:25:14.960747 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:25:15.885525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6582d0>]}
[0m12:25:15.886884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:15.887403 [info ] [MainThread]: 
[0m12:25:15.891684 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:25:15.892463 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:25:15.893356 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:25:15.893921 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:25:15.901747 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:25:15.902653 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:25:15.924910 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:25:15.925984 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:25:15.926281 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:25:15.926515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:19.769861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.843 seconds
[0m12:25:19.796926 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:25:20.449389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c85ce10>]}
[0m12:25:20.451035 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 4.55s]
[0m12:25:20.451999 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:25:20.452706 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:25:20.453397 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:25:20.454080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:25:20.454535 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:25:20.457065 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:25:20.459307 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:25:20.463026 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:25:20.464751 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:25:20.465128 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:25:20.465450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:22.650027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.184 seconds
[0m12:25:22.655330 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:25:23.223427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c872990>]}
[0m12:25:23.224862 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.77s]
[0m12:25:23.225723 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:25:23.226583 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:25:23.227530 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:25:23.228275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:25:23.228724 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:25:23.231309 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:25:23.233715 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:25:23.237240 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:25:23.238302 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:25:23.238675 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:25:23.239063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:25.257116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.015 seconds
[0m12:25:25.262152 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:25:25.923186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca4cd90>]}
[0m12:25:25.925020 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.69s]
[0m12:25:25.925932 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:25:25.926567 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:25:25.927542 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:25:25.928210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:25:25.928648 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:25:25.932461 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:25:25.934256 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:25:25.938630 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:25:25.940074 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:25:25.940528 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:25:25.940896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:28.278385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.333 seconds
[0m12:25:28.283244 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:25:29.204870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c731e50>]}
[0m12:25:29.206708 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 3.28s]
[0m12:25:29.207661 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:25:29.208446 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:25:29.209225 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:25:29.209885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:25:29.210299 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:25:29.214129 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:25:29.215281 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:25:29.221348 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:25:29.222811 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:25:29.223231 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:25:29.223657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:31.353455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.127 seconds
[0m12:25:31.359860 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:25:31.973073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6203d0>]}
[0m12:25:31.974802 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.76s]
[0m12:25:31.975795 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:25:31.976465 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:25:31.977426 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:25:31.978091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:25:31.978568 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:25:31.983188 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:25:31.985577 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:25:31.989129 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:25:31.990214 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:25:31.990611 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:25:31.990972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:34.019743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.026 seconds
[0m12:25:34.024934 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:25:34.614090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6bd510>]}
[0m12:25:34.616031 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.64s]
[0m12:25:34.617182 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:25:34.618082 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:25:34.618978 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:25:34.619629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:25:34.620095 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:25:34.626540 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:25:34.628402 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:25:34.631797 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:25:34.632727 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:25:34.633159 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    -- WITH teams AS (
--     SELECT * FROM NBA_GAMES.DEV.src_teams
-- )
-- SELECT
--     CASE
--         WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
--         ELSE NULL
--     END AS league_id,
--     CASE
--         WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
--         ELSE NULL
--     END AS team_id,
--     CASE
--         WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
--         ELSE NULL
--     END AS min_year,
--     CASE
--         WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
--         ELSE NULL
--     END AS max_year,
--     ABBREVIATION AS team_abbreviation,
--     NICKNAME AS team_nickname,
--     CASE
--         WHEN YEARFOUNDED REGEXP '^[0-9]+$' THEN CAST(YEARFOUNDED AS INT)
--         ELSE NULL
--     END AS year_founded,
--     CITY AS city,
--     ARENA AS arena,
--     NVL(ARENACAPACITY, 0) AS arena_capacity,
--     "OWNER" AS team_owner,
--     GENERALMANAGER AS general_manager,
--     HEADCOACH AS head_coach,
--     DLEAGUEAFFILIATION AS dleague_affiliation
-- FROM teams
  );
[0m12:25:34.633574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:36.314951 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86095-0102-31cd-0006-c35e00044246
[0m12:25:36.316058 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 38 at position 2 unexpected ')'.
[0m12:25:36.316996 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:25:36.902459 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 2 unexpected ')'.
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:25:36.903246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ecad33f-aa9e-4179-8a03-5be8c81de0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd97050>]}
[0m12:25:36.904051 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.28s]
[0m12:25:36.904739 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:25:36.907117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:36.907421 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:25:36.907668 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:25:36.908072 [info ] [MainThread]: 
[0m12:25:36.908391 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 26.20 seconds (26.20s).
[0m12:25:36.909575 [debug] [MainThread]: Command end result
[0m12:25:36.937904 [info ] [MainThread]: 
[0m12:25:36.938188 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:36.938362 [info ] [MainThread]: 
[0m12:25:36.938583 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 2 unexpected ')'.
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:25:36.938792 [info ] [MainThread]: 
[0m12:25:36.938970 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:25:36.941644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.868946, "process_user_time": 1.949566, "process_kernel_time": 0.295875, "process_mem_max_rss": "193232896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:25:36.942029 [debug] [MainThread]: Command `dbt run` failed at 12:25:36.941975 after 26.87 seconds
[0m12:25:36.942300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036c55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036c4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc52f90>]}
[0m12:25:36.942521 [debug] [MainThread]: Flushing usage events
[0m12:25:55.047705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106298c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f3f90>]}


============================== 12:25:55.050331 | 2096da00-ab05-46fa-b82a-3d7538be13a7 ==============================
[0m12:25:55.050331 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:25:55.050643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:55.562711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ef110>]}
[0m12:25:55.581487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d45e10>]}
[0m12:25:55.581998 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:55.641596 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:25:55.673598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:55.673790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:55.683928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b344f50>]}
[0m12:25:55.721308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b96ef50>]}
[0m12:25:55.721546 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:25:55.721715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25c150>]}
[0m12:25:55.722784 [info ] [MainThread]: 
[0m12:25:55.723042 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:55.724876 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:25:55.731056 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:25:55.731217 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:25:55.731345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:57.607514 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.875 seconds
[0m12:25:57.610638 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:25:58.181549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:25:58.190505 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:25:58.190841 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:25:58.191141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:59.856147 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.665 seconds
[0m12:25:59.858371 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:26:00.459213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b712f90>]}
[0m12:26:00.460055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:00.460475 [info ] [MainThread]: 
[0m12:26:00.464073 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:26:00.464721 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_games ...................................... [RUN]
[0m12:26:00.465410 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:26:00.465883 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:26:00.473178 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:26:00.475119 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:26:00.495482 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:26:00.496358 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:26:00.496609 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:26:00.496837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:26:02.455456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.958 seconds
[0m12:26:02.478922 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:26:03.033273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e54f10>]}
[0m12:26:03.034693 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.57s]
[0m12:26:03.035629 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:26:03.036279 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:26:03.037073 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:26:03.037711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:26:03.038175 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:26:03.041858 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:26:03.044259 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:26:03.047776 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:26:03.049263 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:26:03.049691 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:26:03.050044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:05.263826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.213 seconds
[0m12:26:05.269011 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:26:05.880609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcaa5d0>]}
[0m12:26:05.889021 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.84s]
[0m12:26:05.893327 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:26:05.893670 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:26:05.894303 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_players .................................... [RUN]
[0m12:26:05.894671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:26:05.894883 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:26:05.897100 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:26:05.897719 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:26:05.900699 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:26:05.901512 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:26:05.901740 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:26:05.901941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:07.498235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.596 seconds
[0m12:26:07.504202 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:26:08.135358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd28190>]}
[0m12:26:08.136527 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.24s]
[0m12:26:08.137396 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:26:08.138062 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:26:08.139223 [info ] [Thread-1 (]: 4 of 6 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:26:08.139790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:26:08.140227 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:26:08.143116 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:26:08.144725 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:26:08.147657 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:26:08.148711 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:26:08.149024 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:26:08.149291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:09.887638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.738 seconds
[0m12:26:09.889651 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:26:10.428195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce9b10>]}
[0m12:26:10.429143 [info ] [Thread-1 (]: 4 of 6 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.29s]
[0m12:26:10.429906 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:26:10.430517 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:26:10.431249 [info ] [Thread-1 (]: 5 of 6 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:26:10.431911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:26:10.432619 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:26:10.435801 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:26:10.436695 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:26:10.441688 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:26:10.443196 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:26:10.443735 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:26:10.444196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:12.126127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.681 seconds
[0m12:26:12.132201 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:26:12.750784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba389d0>]}
[0m12:26:12.752390 [info ] [Thread-1 (]: 5 of 6 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.32s]
[0m12:26:12.753205 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:26:12.753772 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:26:12.754577 [info ] [Thread-1 (]: 6 of 6 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:26:12.755286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:26:12.755758 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:26:12.760706 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:26:12.762829 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:26:12.765759 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:26:12.766755 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:26:12.767078 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:26:12.767381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:14.585766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.818 seconds
[0m12:26:14.591056 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:26:15.204734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2096da00-ab05-46fa-b82a-3d7538be13a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fcd010>]}
[0m12:26:15.206625 [info ] [Thread-1 (]: 6 of 6 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.45s]
[0m12:26:15.207704 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:26:15.209798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:15.210318 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:26:15.211010 [debug] [MainThread]: Connection 'model.nba_analysis.dim_players_cleansed' was properly closed.
[0m12:26:15.211907 [info ] [MainThread]: 
[0m12:26:15.212475 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 19.49 seconds (19.49s).
[0m12:26:15.214383 [debug] [MainThread]: Command end result
[0m12:26:15.248028 [info ] [MainThread]: 
[0m12:26:15.248347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:15.248544 [info ] [MainThread]: 
[0m12:26:15.248753 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:26:15.252691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.230732, "process_user_time": 1.759394, "process_kernel_time": 0.32092, "process_mem_max_rss": "190349312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:15.253128 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:15.253074 after 20.23 seconds
[0m12:26:15.253445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a45c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a15d0>]}
[0m12:26:15.253659 [debug] [MainThread]: Flushing usage events
[0m12:26:35.062980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10826b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10826bf90>]}


============================== 12:26:35.065671 | e73e77be-d2e1-4821-aab7-c3ba42724ff9 ==============================
[0m12:26:35.065671 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:26:35.066009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:26:35.570827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa0d090>]}
[0m12:26:35.589557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb1cd0>]}
[0m12:26:35.590072 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:26:35.652603 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:26:35.685200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:26:35.685401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:26:35.695633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faed690>]}
[0m12:26:35.731858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd9e450>]}
[0m12:26:35.732115 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:26:35.732282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd64890>]}
[0m12:26:35.733333 [info ] [MainThread]: 
[0m12:26:35.733608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:35.735440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:26:35.742067 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:26:35.742244 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:26:35.742373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:37.538274 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.796 seconds
[0m12:26:37.541282 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:26:38.085067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:26:38.097364 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:26:38.097793 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:26:38.098093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:39.616532 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.518 seconds
[0m12:26:39.622302 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:26:40.192878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe3d810>]}
[0m12:26:40.194218 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:40.194694 [info ] [MainThread]: 
[0m12:26:40.198504 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:26:40.199269 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:26:40.199924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m12:26:40.200520 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:26:40.209095 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:26:40.210402 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:26:40.231665 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:26:40.232616 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:26:40.232897 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:26:40.233170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:42.750203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.516 seconds
[0m12:26:42.774366 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:26:43.321644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2c850>]}
[0m12:26:43.322785 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 3.12s]
[0m12:26:43.323622 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:26:43.324219 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:26:43.324954 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:26:43.325561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:26:43.325998 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:26:43.328555 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:26:43.330278 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:26:43.334525 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:26:43.335875 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:26:43.336342 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:26:43.336828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:45.204457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.867 seconds
[0m12:26:45.210151 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:26:45.823193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa0fad0>]}
[0m12:26:45.824289 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.50s]
[0m12:26:45.825058 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:26:45.825596 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:26:45.826330 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:26:45.826975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:26:45.827428 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:26:45.830133 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:26:45.831034 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:26:45.835112 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:26:45.836144 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:26:45.836464 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:26:45.836750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:47.593413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.756 seconds
[0m12:26:47.596744 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:26:48.282230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c0d6d0>]}
[0m12:26:48.284055 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.45s]
[0m12:26:48.285083 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:26:48.285744 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:26:48.286738 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:26:48.287315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:26:48.287733 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:26:48.290588 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:26:48.292415 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:26:48.296093 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:26:48.297821 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:26:48.298253 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:26:48.298630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:50.213994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.915 seconds
[0m12:26:50.219098 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:26:50.849863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef99850>]}
[0m12:26:50.851639 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.56s]
[0m12:26:50.852538 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:26:50.853167 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:26:50.854059 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:26:50.854710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:26:50.855178 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:26:50.858548 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:26:50.859658 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:26:50.865424 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:26:50.866865 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:26:50.867285 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:26:50.867656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:52.676698 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.809 seconds
[0m12:26:52.682416 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:26:53.264637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef7d50>]}
[0m12:26:53.265796 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.41s]
[0m12:26:53.266590 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:26:53.267092 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:26:53.267839 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:26:53.268470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:26:53.268902 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:26:53.272855 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:26:53.274611 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:26:53.277598 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:26:53.278586 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:26:53.278909 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:26:53.279202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:55.158378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.879 seconds
[0m12:26:55.164319 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:26:55.741438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd4150>]}
[0m12:26:55.742453 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.47s]
[0m12:26:55.743072 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:26:55.743504 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:26:55.744075 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:26:55.744597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:26:55.744976 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:26:55.748241 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:26:55.749993 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:26:55.752909 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:26:55.754350 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:26:55.754667 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CASE
        WHEN YEARFOUNDED REGEXP '^[0-9]+$' THEN CAST(YEARFOUNDED AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(ARENACAPACITY, 0) AS arena_capacity,
    "OWNER" AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams
  );
[0m12:26:55.754982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:57.429770 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86096-0102-32a8-0006-c35e00048062
[0m12:26:57.430551 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 4
invalid identifier 'ABBREVIATION'
[0m12:26:57.431197 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:26:58.115525 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'ABBREVIATION'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:26:58.116161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e77be-d2e1-4821-aab7-c3ba42724ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d58e90>]}
[0m12:26:58.116915 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.37s]
[0m12:26:58.117560 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:26:58.119498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:58.119850 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:26:58.120338 [info ] [MainThread]: 
[0m12:26:58.120686 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 22.39 seconds (22.39s).
[0m12:26:58.121913 [debug] [MainThread]: Command end result
[0m12:26:58.149228 [info ] [MainThread]: 
[0m12:26:58.149502 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:26:58.149682 [info ] [MainThread]: 
[0m12:26:58.149898 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'ABBREVIATION'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:26:58.150081 [info ] [MainThread]: 
[0m12:26:58.150257 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:26:58.153026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 23.117546, "process_user_time": 1.912997, "process_kernel_time": 0.294305, "process_mem_max_rss": "190906368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:58.153375 [debug] [MainThread]: Command `dbt run` failed at 12:26:58.153326 after 23.12 seconds
[0m12:26:58.153614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f361890>]}
[0m12:26:58.153826 [debug] [MainThread]: Flushing usage events
[0m12:27:08.156845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b48f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b269f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b503f90>]}


============================== 12:27:08.159258 | 5e91212d-4fb7-45ef-9117-6eef4afc13d8 ==============================
[0m12:27:08.159258 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:27:08.159548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:27:08.622232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12997e710>]}
[0m12:27:08.640925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae45c90>]}
[0m12:27:08.641466 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:27:08.703930 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:27:08.736130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:08.736320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:08.746537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd70a90>]}
[0m12:27:08.782052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129f276d0>]}
[0m12:27:08.782290 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:27:08.782457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129e66a50>]}
[0m12:27:08.783493 [info ] [MainThread]: 
[0m12:27:08.783761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:08.785631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:27:08.791934 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:27:08.792112 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:27:08.792257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:10.419707 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.627 seconds
[0m12:27:10.424198 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:27:11.018122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:27:11.027780 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:27:11.028110 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:27:11.028364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:12.646494 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.618 seconds
[0m12:27:12.651021 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:27:13.246982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188f3c50>]}
[0m12:27:13.247967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:13.248446 [info ] [MainThread]: 
[0m12:27:13.263762 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:27:13.265824 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:27:13.266564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m12:27:13.267129 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:27:13.281918 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:27:13.282896 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:27:13.341688 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:27:13.342563 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:27:13.342774 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:27:13.342991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:15.591756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.248 seconds
[0m12:27:15.618043 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:27:16.178731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12acdb690>]}
[0m12:27:16.180175 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.91s]
[0m12:27:16.181029 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:27:16.181675 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:27:16.182429 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:27:16.183038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:27:16.183472 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:27:16.186073 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:27:16.188445 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:27:16.192492 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:27:16.194032 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:27:16.194460 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:27:16.194861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:18.787914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.593 seconds
[0m12:27:18.790028 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:27:19.409680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128cf2290>]}
[0m12:27:19.410986 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 3.23s]
[0m12:27:19.411767 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:27:19.412430 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:27:19.413154 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:27:19.413893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:27:19.414331 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:27:19.416833 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:27:19.418565 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:27:19.422651 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:27:19.423716 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:27:19.424079 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:27:19.424417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:21.658285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.233 seconds
[0m12:27:21.663819 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:27:22.248610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129f6c0d0>]}
[0m12:27:22.250129 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.83s]
[0m12:27:22.250988 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:27:22.251535 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:27:22.252208 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:27:22.253026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:27:22.253561 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:27:22.255956 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:27:22.257957 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:27:22.261487 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:27:22.262954 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:27:22.263362 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:27:22.263696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:24.190453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.926 seconds
[0m12:27:24.195434 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:27:24.840863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193da990>]}
[0m12:27:24.842531 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.59s]
[0m12:27:24.843586 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:27:24.844196 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:27:24.844935 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:27:24.845554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:27:24.845981 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:27:24.849083 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:27:24.850116 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:27:24.855732 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:27:24.857105 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:27:24.857530 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:27:24.857924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:26.983979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.126 seconds
[0m12:27:26.988575 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:27:27.602027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129a4c550>]}
[0m12:27:27.603615 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.76s]
[0m12:27:27.604357 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:27:27.604894 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:27:27.605711 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:27:27.606537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:27:27.607023 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:27:27.611208 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:27:27.612217 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:27:27.615516 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:27:27.616609 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:27:27.616988 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:27:27.617337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:29.644926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.027 seconds
[0m12:27:29.650198 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:27:30.264750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129ad5fd0>]}
[0m12:27:30.265709 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.66s]
[0m12:27:30.266420 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:27:30.266929 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:27:30.267551 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:27:30.268108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:27:30.268521 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:27:30.272306 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:27:30.273910 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:27:30.277674 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:27:30.279213 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:27:30.279584 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CASE
        WHEN YEARFOUNDED REGEXP '^[0-9]+$' THEN CAST(YEARFOUNDED AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(ARENACAPACITY, 0) AS arena_capacity,
    "OWNER" AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams
  );
[0m12:27:30.279924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:31.820068 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86097-0102-32a8-0006-c35e0004806a
[0m12:27:31.820662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 4
invalid identifier 'NICKNAME'
[0m12:27:31.821282 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:27:32.420232 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 25 at position 4
  invalid identifier 'NICKNAME'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:27:32.420896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e91212d-4fb7-45ef-9117-6eef4afc13d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129e3d010>]}
[0m12:27:32.421620 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.15s]
[0m12:27:32.422248 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:27:32.424046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:32.424334 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:27:32.424698 [info ] [MainThread]: 
[0m12:27:32.425005 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 23.64 seconds (23.64s).
[0m12:27:32.426204 [debug] [MainThread]: Command end result
[0m12:27:32.453315 [info ] [MainThread]: 
[0m12:27:32.453603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:32.453784 [info ] [MainThread]: 
[0m12:27:32.454001 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 25 at position 4
  invalid identifier 'NICKNAME'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:27:32.454182 [info ] [MainThread]: 
[0m12:27:32.454362 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:27:32.456936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 24.32677, "process_user_time": 1.928814, "process_kernel_time": 0.298291, "process_mem_max_rss": "194920448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:27:32.457229 [debug] [MainThread]: Command `dbt run` failed at 12:27:32.457184 after 24.33 seconds
[0m12:27:32.457448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b517a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b517850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105614d10>]}
[0m12:27:32.457647 [debug] [MainThread]: Flushing usage events
[0m12:28:02.146215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061619d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617bf90>]}


============================== 12:28:02.148889 | 9ba04047-45be-4fdf-908a-3d3b8188c8c0 ==============================
[0m12:28:02.148889 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:28:02.149203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:02.653336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cb7e050>]}
[0m12:28:02.671956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc1e50>]}
[0m12:28:02.672463 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:28:02.731712 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:28:02.763775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:02.763993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:02.774086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f04d50>]}
[0m12:28:02.810263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0093d0>]}
[0m12:28:02.810510 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:28:02.810679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cf663d0>]}
[0m12:28:02.811721 [info ] [MainThread]: 
[0m12:28:02.811978 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:28:02.813824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:28:02.820132 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:28:02.820294 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:28:02.820417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:04.493221 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.672 seconds
[0m12:28:04.496700 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:28:05.084812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:28:05.096571 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:28:05.097050 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:28:05.097367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:06.687648 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.590 seconds
[0m12:28:06.691097 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:28:07.256621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618d390>]}
[0m12:28:07.258531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:07.259175 [info ] [MainThread]: 
[0m12:28:07.263147 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:28:07.264206 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:28:07.264932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m12:28:07.265398 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:28:07.273275 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:28:07.274946 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:28:07.297110 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:28:07.298160 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:28:07.298426 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:28:07.298685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:09.721708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.423 seconds
[0m12:28:09.752161 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:28:10.432145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d181010>]}
[0m12:28:10.432742 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 3.17s]
[0m12:28:10.433130 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:28:10.433475 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:28:10.433818 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:28:10.434095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:28:10.434423 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:28:10.435862 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:28:10.436560 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:28:10.438326 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:28:10.440834 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:28:10.441392 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:28:10.441745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:12.587586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.145 seconds
[0m12:28:12.593748 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:28:13.141224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7367d0>]}
[0m12:28:13.143461 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.71s]
[0m12:28:13.144697 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:28:13.145528 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:28:13.146380 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:28:13.147308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:28:13.148084 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:28:13.150008 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:28:13.150495 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:28:13.155404 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:28:13.156931 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:28:13.157337 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:28:13.157569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:14.759005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.601 seconds
[0m12:28:14.763758 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:28:15.588250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6a7150>]}
[0m12:28:15.604473 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.44s]
[0m12:28:15.606989 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:28:15.608117 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:28:15.609043 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:28:15.609969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:28:15.611677 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:28:15.616595 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:28:15.622373 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:28:15.632495 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:28:15.634729 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:28:15.634986 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:28:15.635306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:17.415925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.780 seconds
[0m12:28:17.421946 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:28:17.987281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6769d0>]}
[0m12:28:18.003418 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.36s]
[0m12:28:18.008496 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:28:18.008946 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:28:18.009355 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:28:18.009641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:28:18.009827 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:28:18.011435 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:28:18.011872 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:28:18.016751 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:28:18.018469 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:28:18.018700 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:28:18.018908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:19.938649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.919 seconds
[0m12:28:19.944445 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:28:20.621415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7367d0>]}
[0m12:28:20.623280 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.61s]
[0m12:28:20.624669 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:28:20.625501 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:28:20.626843 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:28:20.627450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:28:20.627897 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:28:20.638641 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:28:20.639500 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:28:20.642717 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:28:20.643490 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:28:20.643830 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:28:20.644192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:22.363401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.719 seconds
[0m12:28:22.368012 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:28:22.913528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5b7150>]}
[0m12:28:22.915018 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.29s]
[0m12:28:22.916412 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:28:22.917241 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:28:22.917973 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:28:22.918535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:28:22.918954 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:28:22.925886 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:28:22.926819 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:28:22.928457 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:28:22.929362 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:28:22.929656 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN YEARFOUNDED REGEXP '^[0-9]+$' THEN CAST(YEARFOUNDED AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(ARENACAPACITY, 0) AS arena_capacity,
    "OWNER" AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams
  );
[0m12:28:22.929861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:24.729243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86098-0102-31cd-0006-c35e000442a2
[0m12:28:24.730795 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 13
invalid identifier 'YEARFOUNDED'
[0m12:28:24.731887 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:28:25.283925 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 27 at position 13
  invalid identifier 'YEARFOUNDED'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:28:25.285237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba04047-45be-4fdf-908a-3d3b8188c8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d178390>]}
[0m12:28:25.285901 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.37s]
[0m12:28:25.286276 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:28:25.288820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:25.288999 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:28:25.289223 [info ] [MainThread]: 
[0m12:28:25.289391 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 22.48 seconds (22.48s).
[0m12:28:25.290040 [debug] [MainThread]: Command end result
[0m12:28:25.314665 [info ] [MainThread]: 
[0m12:28:25.315018 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:28:25.315170 [info ] [MainThread]: 
[0m12:28:25.315357 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 27 at position 13
  invalid identifier 'YEARFOUNDED'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:28:25.315496 [info ] [MainThread]: 
[0m12:28:25.315958 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:28:25.338960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 23.219564, "process_user_time": 1.681969, "process_kernel_time": 0.411976, "process_mem_max_rss": "191578112", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:25.339507 [debug] [MainThread]: Command `dbt run` failed at 12:28:25.339456 after 23.22 seconds
[0m12:28:25.340000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ac750>]}
[0m12:28:25.340270 [debug] [MainThread]: Flushing usage events
[0m12:28:49.069939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11088e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108fff90>]}


============================== 12:28:49.094687 | 56fc3f0f-0705-427c-b4dc-c1da4d9d42e0 ==============================
[0m12:28:49.094687 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:28:49.095093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:28:49.859310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11467ee50>]}
[0m12:28:49.878284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110345cd0>]}
[0m12:28:49.878819 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:28:49.940190 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:28:49.974603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:49.974805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:49.985223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110913590>]}
[0m12:28:50.022504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126016890>]}
[0m12:28:50.022752 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:28:50.022917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217666d0>]}
[0m12:28:50.024020 [info ] [MainThread]: 
[0m12:28:50.024288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:28:50.026250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:28:50.032631 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:28:50.032807 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:28:50.032938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:51.573190 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.540 seconds
[0m12:28:51.578035 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:28:52.167064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:28:52.177736 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:28:52.178268 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:28:52.178672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:53.671692 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.493 seconds
[0m12:28:53.675979 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:28:54.236486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d8d50>]}
[0m12:28:54.237654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:54.238260 [info ] [MainThread]: 
[0m12:28:54.241802 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:28:54.242727 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:28:54.243418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m12:28:54.244390 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:28:54.256774 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:28:54.258043 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:28:54.281017 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:28:54.282072 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:28:54.282341 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:28:54.282764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:56.194794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.911 seconds
[0m12:28:56.223011 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:28:56.897462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126591ad0>]}
[0m12:28:56.899116 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.65s]
[0m12:28:56.900337 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:28:56.901062 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:28:56.901803 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:28:56.902426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:28:56.902866 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:28:56.906784 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:28:56.908909 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:28:56.913952 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:28:56.916369 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:28:56.916830 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:28:56.917198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:58.980099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.063 seconds
[0m12:28:58.983567 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:28:59.535046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126559310>]}
[0m12:28:59.537557 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.63s]
[0m12:28:59.538967 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:28:59.539703 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:28:59.540551 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:28:59.541317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:28:59.542121 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:28:59.545007 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:28:59.546251 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:28:59.550781 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:28:59.552214 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:28:59.552749 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:28:59.553172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:01.259273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.706 seconds
[0m12:29:01.265189 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:29:01.808923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173e910>]}
[0m12:29:01.810580 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.27s]
[0m12:29:01.811766 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:29:01.812456 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:29:01.813728 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:29:01.814800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:29:01.815269 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:29:01.818140 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:29:01.820064 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:29:01.823838 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:29:01.825125 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:29:01.825562 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:29:01.825941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:03.660782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.835 seconds
[0m12:29:03.665383 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:29:04.214833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126014d90>]}
[0m12:29:04.215883 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.40s]
[0m12:29:04.216859 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:29:04.217238 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:29:04.217632 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:29:04.217904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:29:04.218115 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:29:04.220108 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:29:04.220535 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:29:04.225032 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:29:04.226047 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:29:04.226310 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:29:04.227101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:05.978298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.751 seconds
[0m12:29:05.982859 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:29:06.538053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264a8810>]}
[0m12:29:06.539234 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.32s]
[0m12:29:06.540099 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:29:06.540744 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:29:06.541916 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:29:06.542666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:29:06.543141 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:29:06.548010 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:29:06.549116 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:29:06.552530 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:29:06.553928 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:29:06.554267 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:29:06.554554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:08.275108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.720 seconds
[0m12:29:08.281606 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:29:08.912346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12654d550>]}
[0m12:29:08.914975 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.37s]
[0m12:29:08.916205 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:29:08.917456 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:29:08.918268 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:29:08.920126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:29:08.921370 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:29:08.940771 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:29:08.943025 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:29:08.946251 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:29:08.947197 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:29:08.947593 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    "OWNER" AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams
  );
[0m12:29:08.948402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:10.373835 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86099-0102-32a8-0006-c35e00048076
[0m12:29:10.374724 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'OWNER'
[0m12:29:10.375675 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:29:11.012058 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'OWNER'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:29:11.013409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56fc3f0f-0705-427c-b4dc-c1da4d9d42e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110899a90>]}
[0m12:29:11.014525 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.09s]
[0m12:29:11.015310 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:29:11.018533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:11.019016 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:29:11.019613 [info ] [MainThread]: 
[0m12:29:11.019959 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 21.00 seconds (21.00s).
[0m12:29:11.021547 [debug] [MainThread]: Command end result
[0m12:29:11.053660 [info ] [MainThread]: 
[0m12:29:11.053960 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:29:11.054140 [info ] [MainThread]: 
[0m12:29:11.054367 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'OWNER'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:29:11.054546 [info ] [MainThread]: 
[0m12:29:11.054730 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:29:11.057310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.040966, "process_user_time": 1.801457, "process_kernel_time": 0.43841, "process_mem_max_rss": "186990592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:29:11.057684 [debug] [MainThread]: Command `dbt run` failed at 12:29:11.057641 after 22.04 seconds
[0m12:29:11.057941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126833f90>]}
[0m12:29:11.058135 [debug] [MainThread]: Flushing usage events
[0m12:29:43.843870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067adc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7ffd0>]}


============================== 12:29:43.846773 | d48066ab-630a-40f9-b895-40848b3fb154 ==============================
[0m12:29:43.846773 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:29:43.847091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:29:44.514690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9fca10>]}
[0m12:29:44.536850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c5c50>]}
[0m12:29:44.537567 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:29:44.601431 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:29:44.633847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:44.634049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:44.644288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da38750>]}
[0m12:29:44.683260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d99ad10>]}
[0m12:29:44.683534 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:29:44.683708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbc9d90>]}
[0m12:29:44.684822 [info ] [MainThread]: 
[0m12:29:44.685093 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:29:44.686977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:29:44.693472 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:29:44.693629 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:29:44.693752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:46.318132 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.624 seconds
[0m12:29:46.321888 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:29:46.895825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:29:46.907713 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:29:46.908195 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:29:46.908496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:48.514119 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.605 seconds
[0m12:29:48.518814 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:29:49.053119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fea490>]}
[0m12:29:49.054196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:49.055180 [info ] [MainThread]: 
[0m12:29:49.058338 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:29:49.058960 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:29:49.059504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m12:29:49.060157 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:29:49.072036 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:29:49.073049 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:29:49.092706 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:29:49.093787 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:29:49.094057 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:29:49.094311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:50.931069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.836 seconds
[0m12:29:50.954484 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:29:51.510743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e258510>]}
[0m12:29:51.537933 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.45s]
[0m12:29:51.570529 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:29:51.576353 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:29:51.586340 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:29:51.588602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:29:51.589376 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:29:51.604444 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:29:51.605396 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:29:51.608758 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:29:51.609730 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:29:51.609957 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:29:51.610251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:53.738021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.128 seconds
[0m12:29:53.740384 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:29:54.318641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dd850>]}
[0m12:29:54.319816 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.73s]
[0m12:29:54.320624 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:29:54.321101 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:29:54.321632 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:29:54.322060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:29:54.322415 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:29:54.325179 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:29:54.326100 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:29:54.332231 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:29:54.332877 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:29:54.333095 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:29:54.333364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:55.968875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.634 seconds
[0m12:29:55.978462 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:29:56.534132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e258650>]}
[0m12:29:56.535267 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.21s]
[0m12:29:56.536185 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:29:56.536882 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:29:56.537847 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:29:56.538366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:29:56.538855 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:29:56.541527 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:29:56.543109 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:29:56.546767 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:29:56.547454 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:29:56.547647 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:29:56.547920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:58.315414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.767 seconds
[0m12:29:58.322157 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:29:58.875940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df6a350>]}
[0m12:29:58.877365 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.34s]
[0m12:29:58.878221 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:29:58.878900 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:29:58.879740 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:29:58.880323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:29:58.880800 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:29:58.884295 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:29:58.885134 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:29:58.889171 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:29:58.890111 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:29:58.890345 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:29:58.890524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:00.831745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.941 seconds
[0m12:30:00.841111 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:30:01.427643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107245d90>]}
[0m12:30:01.429169 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.55s]
[0m12:30:01.430169 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:30:01.430846 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:30:01.431904 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:30:01.432536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:30:01.433024 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:30:01.443713 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:30:01.444874 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:30:01.446635 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:30:01.447204 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:30:01.447379 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:30:01.447550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:03.091412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.643 seconds
[0m12:30:03.098487 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:30:03.645866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060007d0>]}
[0m12:30:03.646958 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.21s]
[0m12:30:03.647843 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:30:03.648296 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:30:03.648918 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:30:03.649451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:30:03.649871 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:30:03.654684 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:30:03.656268 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:30:03.660511 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:30:03.661981 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:30:03.662246 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM teams
  );
[0m12:30:03.662486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:05.197481 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8609a-0102-32a8-0006-c35e00048082
[0m12:30:05.198048 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 34 at position 4
invalid identifier 'GENERALMANAGER'
[0m12:30:05.198576 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:30:05.752795 [debug] [Thread-1 (]: Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 34 at position 4
  invalid identifier 'GENERALMANAGER'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:30:05.754878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48066ab-630a-40f9-b895-40848b3fb154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057aa490>]}
[0m12:30:05.760384 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model DEV.dim_teams_cleansed .................... [[31mERROR[0m in 2.10s]
[0m12:30:05.761732 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:30:05.766726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:05.767120 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:30:05.767648 [info ] [MainThread]: 
[0m12:30:05.768325 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 21.08 seconds (21.08s).
[0m12:30:05.769900 [debug] [MainThread]: Command end result
[0m12:30:05.806644 [info ] [MainThread]: 
[0m12:30:05.806951 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:05.807126 [info ] [MainThread]: 
[0m12:30:05.807355 [error] [MainThread]:   Database Error in model dim_teams_cleansed (models/dim/dim_teams_cleansed.sql)
  000904 (42000): SQL compilation error: error line 34 at position 4
  invalid identifier 'GENERALMANAGER'
  compiled code at target/run/nba_analysis/models/dim/dim_teams_cleansed.sql
[0m12:30:05.807527 [info ] [MainThread]: 
[0m12:30:05.808137 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:30:05.828395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.022217, "process_user_time": 1.728105, "process_kernel_time": 0.426951, "process_mem_max_rss": "183681024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:05.829500 [debug] [MainThread]: Command `dbt run` failed at 12:30:05.829453 after 22.02 seconds
[0m12:30:05.829759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032215d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103220d10>]}
[0m12:30:05.829937 [debug] [MainThread]: Flushing usage events
[0m12:31:29.532691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b43010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb3f90>]}


============================== 12:31:29.535476 | 342f24e0-4464-4769-b30e-911ae6768e05 ==============================
[0m12:31:29.535476 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:31:29.535779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:31:30.418100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5f910>]}
[0m12:31:30.437831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f9c90>]}
[0m12:31:30.438426 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:31:30.501948 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:31:30.538627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:30.538855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:30.549587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c06e510>]}
[0m12:31:30.589882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2231d0>]}
[0m12:31:30.590134 [info ] [MainThread]: Found 7 models, 459 macros
[0m12:31:30.590310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ea5d0>]}
[0m12:31:30.591417 [info ] [MainThread]: 
[0m12:31:30.591684 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:30.593584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:31:30.599867 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:31:30.600033 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:31:30.600165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:32.252842 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.652 seconds
[0m12:31:32.256593 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:31:32.827274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:31:32.844016 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:31:32.844522 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:31:32.844851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:34.359677 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.515 seconds
[0m12:31:34.363430 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:31:34.948125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601e550>]}
[0m12:31:34.949508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:34.950063 [info ] [MainThread]: 
[0m12:31:34.953216 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:31:34.953936 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_games ...................................... [RUN]
[0m12:31:34.954527 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:31:34.954942 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:31:34.960510 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:31:34.962041 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:31:34.981919 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:31:34.983041 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:31:34.983289 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:31:34.983542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:37.007940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.023 seconds
[0m12:31:37.024174 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:31:37.597059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b24b10>]}
[0m12:31:37.598795 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.64s]
[0m12:31:37.599887 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:31:37.600534 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:31:37.601323 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:31:37.602002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:31:37.602471 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:31:37.605396 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:31:37.608248 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:31:37.612003 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:31:37.625574 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:31:37.626151 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:31:37.626986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:39.812993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.185 seconds
[0m12:31:39.822093 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:31:40.409380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfdcd90>]}
[0m12:31:40.411124 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.81s]
[0m12:31:40.412138 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:31:40.412806 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:31:40.413522 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_players .................................... [RUN]
[0m12:31:40.414032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:31:40.414414 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:31:40.416402 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:31:40.416858 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:31:40.418947 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:31:40.419743 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:31:40.419977 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:31:40.420167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:42.006526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.586 seconds
[0m12:31:42.011396 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:31:42.560957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b4f90>]}
[0m12:31:42.562157 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.15s]
[0m12:31:42.562947 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:31:42.563533 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:31:42.564414 [info ] [Thread-1 (]: 4 of 7 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:31:42.565311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:31:42.565732 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:31:42.567969 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:31:42.570261 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:31:42.573369 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:31:42.574495 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:31:42.574824 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:31:42.575158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:44.212298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.637 seconds
[0m12:31:44.215424 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:31:44.756255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a33d0>]}
[0m12:31:44.759288 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.19s]
[0m12:31:44.761567 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:31:44.762738 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:31:44.764396 [info ] [Thread-1 (]: 5 of 7 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:31:44.765381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:31:44.766284 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:31:44.773075 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:31:44.773949 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:31:44.782713 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:31:44.784045 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:31:44.784388 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:31:44.784685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:46.574677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m12:31:46.582581 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:31:47.136237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cf610>]}
[0m12:31:47.137657 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.37s]
[0m12:31:47.138573 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:31:47.139279 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:31:47.140319 [info ] [Thread-1 (]: 6 of 7 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:31:47.141001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_players_cleansed)
[0m12:31:47.141481 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:31:47.147144 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:31:47.148786 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:31:47.153091 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:31:47.154295 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:31:47.154807 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:31:47.155362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:48.921176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.765 seconds
[0m12:31:48.927304 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:31:49.481642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faf950>]}
[0m12:31:49.482919 [info ] [Thread-1 (]: 6 of 7 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.34s]
[0m12:31:49.483770 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:31:49.484355 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:31:49.485092 [info ] [Thread-1 (]: 7 of 7 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:31:49.486369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:31:49.486928 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:31:49.494141 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:31:49.495981 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:31:49.500195 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:31:49.502145 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:31:49.502627 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m12:31:49.503050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:51.379991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.877 seconds
[0m12:31:51.383693 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:31:51.917360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '342f24e0-4464-4769-b30e-911ae6768e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65bd0>]}
[0m12:31:51.919922 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.43s]
[0m12:31:51.920850 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:31:51.923305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:51.923800 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:31:51.924354 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:31:51.925084 [info ] [MainThread]: 
[0m12:31:51.925657 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 21.33 seconds (21.33s).
[0m12:31:51.945861 [debug] [MainThread]: Command end result
[0m12:31:52.011444 [info ] [MainThread]: 
[0m12:31:52.011754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:52.011925 [info ] [MainThread]: 
[0m12:31:52.012089 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:31:52.016049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.515804, "process_user_time": 1.8421, "process_kernel_time": 0.499427, "process_mem_max_rss": "181239808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:31:52.016529 [debug] [MainThread]: Command `dbt run` succeeded at 12:31:52.016450 after 22.52 seconds
[0m12:31:52.016824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032f9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103254cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032555d0>]}
[0m12:31:52.017021 [debug] [MainThread]: Flushing usage events
[0m12:55:14.894301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494bf90>]}


============================== 12:55:14.897228 | a7b7bc2c-8de8-446b-8f9a-465d247263bf ==============================
[0m12:55:14.897228 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:55:14.897564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:55:15.708926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497db50>]}
[0m12:55:15.728134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439dd90>]}
[0m12:55:15.728700 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:55:15.790155 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:55:15.823327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:15.823528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:15.834205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ca290>]}
[0m12:55:15.875815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a49cbd0>]}
[0m12:55:15.876122 [info ] [MainThread]: Found 8 models, 459 macros
[0m12:55:15.876298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a466950>]}
[0m12:55:15.877664 [info ] [MainThread]: 
[0m12:55:15.877968 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:55:15.879935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m12:55:15.886253 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m12:55:15.886423 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m12:55:15.886558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:17.667662 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.781 seconds
[0m12:55:17.670643 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m12:55:18.251887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m12:55:18.270204 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m12:55:18.270692 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m12:55:18.271001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:19.814307 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.543 seconds
[0m12:55:19.819161 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m12:55:20.403059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480d8d0>]}
[0m12:55:20.404671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:20.405269 [info ] [MainThread]: 
[0m12:55:20.409979 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m12:55:20.410870 [info ] [Thread-1 (]: 1 of 8 START sql view model DEV.src_games ...................................... [RUN]
[0m12:55:20.411657 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m12:55:20.412238 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m12:55:20.421077 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m12:55:20.423672 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m12:55:20.447587 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m12:55:20.448563 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m12:55:20.448830 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m12:55:20.449093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:55:22.404304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.955 seconds
[0m12:55:22.430141 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m12:55:22.992074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcdff10>]}
[0m12:55:22.993111 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.58s]
[0m12:55:22.993987 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m12:55:22.994589 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m12:55:22.995199 [info ] [Thread-1 (]: 2 of 8 START sql view model DEV.src_games_details .............................. [RUN]
[0m12:55:22.996053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m12:55:22.996591 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m12:55:22.999284 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m12:55:23.001430 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m12:55:23.005926 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m12:55:23.007660 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m12:55:23.008232 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m12:55:23.008640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:24.934820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.926 seconds
[0m12:55:24.940191 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m12:55:25.511310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1f7d0>]}
[0m12:55:25.513074 [info ] [Thread-1 (]: 2 of 8 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.51s]
[0m12:55:25.514138 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m12:55:25.514763 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m12:55:25.515478 [info ] [Thread-1 (]: 3 of 8 START sql view model DEV.src_players .................................... [RUN]
[0m12:55:25.516078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m12:55:25.516491 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m12:55:25.519546 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m12:55:25.521722 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m12:55:25.525756 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m12:55:25.526955 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m12:55:25.527377 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:55:25.527754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:27.293788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.766 seconds
[0m12:55:27.297709 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m12:55:27.909532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da6d90>]}
[0m12:55:27.912512 [info ] [Thread-1 (]: 3 of 8 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.39s]
[0m12:55:27.913767 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m12:55:27.914573 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m12:55:27.916318 [info ] [Thread-1 (]: 4 of 8 START sql view model DEV.src_ranking .................................... [RUN]
[0m12:55:27.917296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m12:55:27.917806 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m12:55:27.921597 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m12:55:27.923390 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m12:55:27.926901 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m12:55:27.928280 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m12:55:27.928697 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m12:55:27.929118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:29.750293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.821 seconds
[0m12:55:29.756762 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m12:55:30.307808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e7050>]}
[0m12:55:30.309736 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.39s]
[0m12:55:30.310841 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m12:55:30.311632 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m12:55:30.312473 [info ] [Thread-1 (]: 5 of 8 START sql view model DEV.src_teams ...................................... [RUN]
[0m12:55:30.313141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m12:55:30.313556 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m12:55:30.317353 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m12:55:30.318333 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m12:55:30.323905 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m12:55:30.325313 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m12:55:30.325726 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m12:55:30.326100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:32.155786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.829 seconds
[0m12:55:32.160165 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m12:55:32.723283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102734c90>]}
[0m12:55:32.725126 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.41s]
[0m12:55:32.726061 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m12:55:32.726708 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m12:55:32.727601 [info ] [Thread-1 (]: 6 of 8 START sql view model DEV.dim_seasons .................................... [RUN]
[0m12:55:32.728161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m12:55:32.728564 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m12:55:32.734749 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m12:55:32.735934 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m12:55:32.739452 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m12:55:32.740872 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m12:55:32.741346 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m12:55:32.741996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:34.442701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.700 seconds
[0m12:55:34.448755 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m12:55:35.018013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a22b050>]}
[0m12:55:35.019282 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.29s]
[0m12:55:35.020011 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m12:55:35.020542 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m12:55:35.021289 [info ] [Thread-1 (]: 7 of 8 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m12:55:35.021837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m12:55:35.022216 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m12:55:35.026321 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m12:55:35.028633 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m12:55:35.031402 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m12:55:35.032265 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m12:55:35.032559 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m12:55:35.032843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:36.730277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.697 seconds
[0m12:55:36.738406 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m12:55:37.333712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103607150>]}
[0m12:55:37.335907 [info ] [Thread-1 (]: 7 of 8 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.31s]
[0m12:55:37.336860 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m12:55:37.337557 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m12:55:37.338389 [info ] [Thread-1 (]: 8 of 8 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m12:55:37.339020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m12:55:37.339446 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m12:55:37.345583 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m12:55:37.347878 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m12:55:37.351207 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m12:55:37.352986 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m12:55:37.353478 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m12:55:37.353911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:39.576818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.222 seconds
[0m12:55:39.581325 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m12:55:40.197494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b7bc2c-8de8-446b-8f9a-465d247263bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc48590>]}
[0m12:55:40.199324 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.86s]
[0m12:55:40.200319 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m12:55:40.203090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:40.203586 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m12:55:40.203926 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m12:55:40.204522 [info ] [MainThread]: 
[0m12:55:40.204892 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 24.33 seconds (24.33s).
[0m12:55:40.206634 [debug] [MainThread]: Command end result
[0m12:55:40.241747 [info ] [MainThread]: 
[0m12:55:40.242087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:40.242289 [info ] [MainThread]: 
[0m12:55:40.242495 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:55:40.245435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.395025, "process_user_time": 1.987683, "process_kernel_time": 0.452094, "process_mem_max_rss": "191234048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:55:40.245888 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:40.245836 after 25.40 seconds
[0m12:55:40.246177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df79410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10109dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ff95d0>]}
[0m12:55:40.246387 [debug] [MainThread]: Flushing usage events
[0m13:20:59.206785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c74c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccf790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccff10>]}


============================== 13:20:59.209601 | cd1db905-49a1-4568-bd9f-0155c6b92806 ==============================
[0m13:20:59.209601 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:20:59.209904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:59.219417 [info ] [MainThread]: dbt version: 1.8.7
[0m13:20:59.219659 [info ] [MainThread]: python version: 3.11.5
[0m13:20:59.219816 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m13:20:59.219950 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m13:20:59.939828 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m13:20:59.940079 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m13:20:59.940248 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m13:20:59.940639 [info ] [MainThread]: adapter type: snowflake
[0m13:20:59.940781 [info ] [MainThread]: adapter version: 1.8.4
[0m13:20:59.971386 [info ] [MainThread]: Configuration:
[0m13:20:59.971612 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:20:59.971768 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:20:59.971900 [info ] [MainThread]: Required dependencies:
[0m13:20:59.972138 [debug] [MainThread]: Executing "git --help"
[0m13:21:00.001642 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:21:00.002267 [debug] [MainThread]: STDERR: "b''"
[0m13:21:00.002471 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:21:00.002641 [info ] [MainThread]: Connection:
[0m13:21:00.002820 [info ] [MainThread]:   account: oslioxh-ra97663
[0m13:21:00.002948 [info ] [MainThread]:   user: dbt
[0m13:21:00.003063 [info ] [MainThread]:   database: NBA_GAMES
[0m13:21:00.003176 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m13:21:00.003286 [info ] [MainThread]:   role: transform
[0m13:21:00.003393 [info ] [MainThread]:   schema: DEV
[0m13:21:00.003504 [info ] [MainThread]:   authenticator: None
[0m13:21:00.003611 [info ] [MainThread]:   oauth_client_id: None
[0m13:21:00.003718 [info ] [MainThread]:   query_tag: None
[0m13:21:00.003826 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:21:00.003932 [info ] [MainThread]:   host: None
[0m13:21:00.004039 [info ] [MainThread]:   port: None
[0m13:21:00.004148 [info ] [MainThread]:   proxy_host: None
[0m13:21:00.004257 [info ] [MainThread]:   proxy_port: None
[0m13:21:00.004389 [info ] [MainThread]:   protocol: None
[0m13:21:00.004498 [info ] [MainThread]:   connect_retries: 1
[0m13:21:00.004607 [info ] [MainThread]:   connect_timeout: None
[0m13:21:00.004713 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:21:00.004819 [info ] [MainThread]:   retry_all: False
[0m13:21:00.004927 [info ] [MainThread]:   insecure_mode: False
[0m13:21:00.005036 [info ] [MainThread]:   reuse_connections: None
[0m13:21:00.005328 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:21:00.062710 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:21:00.063211 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:21:00.063348 [debug] [MainThread]: On debug: select 1 as id
[0m13:21:00.063468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:02.180666 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.117 seconds
[0m13:21:02.183462 [debug] [MainThread]: On debug: Close
[0m13:21:02.906784 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:21:02.907975 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:21:02.912893 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.7348628, "process_user_time": 0.930002, "process_kernel_time": 0.280721, "process_mem_max_rss": "188596224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:21:02.913945 [debug] [MainThread]: Command `dbt debug` succeeded at 13:21:02.913704 after 3.74 seconds
[0m13:21:02.914440 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:21:02.914933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101421c90>]}
[0m13:21:02.915619 [debug] [MainThread]: Flushing usage events
[0m13:25:45.703743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106644c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669fc90>]}


============================== 13:25:45.706545 | baf2e10c-b79e-48e3-aca0-ed252bfae78f ==============================
[0m13:25:45.706545 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:25:45.706851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:25:45.716181 [info ] [MainThread]: dbt version: 1.8.7
[0m13:25:45.716476 [info ] [MainThread]: python version: 3.11.5
[0m13:25:45.716677 [info ] [MainThread]: python path: /Users/yogisharosarumaha/Documents/nba_analysis/venv/bin/python3
[0m13:25:45.716824 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m13:25:46.385769 [info ] [MainThread]: Using profiles dir at /Users/yogisharosarumaha/.dbt
[0m13:25:46.386018 [info ] [MainThread]: Using profiles.yml file at /Users/yogisharosarumaha/.dbt/profiles.yml
[0m13:25:46.386190 [info ] [MainThread]: Using dbt_project.yml file at /Users/yogisharosarumaha/Documents/nba_analysis/dbt_project.yml
[0m13:25:46.386567 [info ] [MainThread]: adapter type: snowflake
[0m13:25:46.386716 [info ] [MainThread]: adapter version: 1.8.4
[0m13:25:46.417290 [info ] [MainThread]: Configuration:
[0m13:25:46.417520 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:25:46.417667 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:25:46.417805 [info ] [MainThread]: Required dependencies:
[0m13:25:46.417977 [debug] [MainThread]: Executing "git --help"
[0m13:25:46.444091 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:25:46.444667 [debug] [MainThread]: STDERR: "b''"
[0m13:25:46.444841 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:25:46.445006 [info ] [MainThread]: Connection:
[0m13:25:46.445175 [info ] [MainThread]:   account: oslioxh-ra97663
[0m13:25:46.445300 [info ] [MainThread]:   user: dbt
[0m13:25:46.445418 [info ] [MainThread]:   database: NBA_GAMES
[0m13:25:46.445529 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m13:25:46.445645 [info ] [MainThread]:   role: transform
[0m13:25:46.445753 [info ] [MainThread]:   schema: DEV
[0m13:25:46.445860 [info ] [MainThread]:   authenticator: None
[0m13:25:46.445970 [info ] [MainThread]:   oauth_client_id: None
[0m13:25:46.446074 [info ] [MainThread]:   query_tag: None
[0m13:25:46.446182 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:25:46.446298 [info ] [MainThread]:   host: None
[0m13:25:46.446406 [info ] [MainThread]:   port: None
[0m13:25:46.446516 [info ] [MainThread]:   proxy_host: None
[0m13:25:46.446624 [info ] [MainThread]:   proxy_port: None
[0m13:25:46.446732 [info ] [MainThread]:   protocol: None
[0m13:25:46.446837 [info ] [MainThread]:   connect_retries: 1
[0m13:25:46.446941 [info ] [MainThread]:   connect_timeout: None
[0m13:25:46.447046 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:25:46.447152 [info ] [MainThread]:   retry_all: False
[0m13:25:46.447254 [info ] [MainThread]:   insecure_mode: False
[0m13:25:46.447359 [info ] [MainThread]:   reuse_connections: None
[0m13:25:46.447648 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:25:46.503485 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:25:46.503938 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:25:46.504069 [debug] [MainThread]: On debug: select 1 as id
[0m13:25:46.504191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:48.197517 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.693 seconds
[0m13:25:48.199802 [debug] [MainThread]: On debug: Close
[0m13:25:48.780912 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:25:48.782060 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:25:48.787871 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.1142051, "process_user_time": 0.909121, "process_kernel_time": 0.254263, "process_mem_max_rss": "185106432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:25:48.789119 [debug] [MainThread]: Command `dbt debug` succeeded at 13:25:48.788870 after 3.12 seconds
[0m13:25:48.789901 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:25:48.790443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a5490>]}
[0m13:25:48.790991 [debug] [MainThread]: Flushing usage events
[0m13:25:53.107596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11988ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198e4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198f3fd0>]}


============================== 13:25:53.109878 | 9ad5a25e-e125-477c-93be-1d686944853c ==============================
[0m13:25:53.109878 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:25:53.110175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:25:53.586525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c44190>]}
[0m13:25:53.605379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119245dd0>]}
[0m13:25:53.605890 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:25:53.664306 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:25:53.714962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:53.715152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:53.725389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12903b950>]}
[0m13:25:53.767025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c2be50>]}
[0m13:25:53.767259 [info ] [MainThread]: Found 9 models, 459 macros
[0m13:25:53.767424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbf1a10>]}
[0m13:25:53.768533 [info ] [MainThread]: 
[0m13:25:53.768792 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:25:53.770679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:25:53.777109 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:25:53.777294 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:25:53.777430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:55.445025 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.668 seconds
[0m13:25:55.446438 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:25:56.063514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:25:56.077627 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:25:56.078074 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:25:56.078387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:57.649332 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.571 seconds
[0m13:25:57.654788 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:25:58.322236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf177d0>]}
[0m13:25:58.323800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:58.324350 [info ] [MainThread]: 
[0m13:25:58.329694 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:25:58.330522 [info ] [Thread-1 (]: 1 of 9 START sql view model DEV.src_games ...................................... [RUN]
[0m13:25:58.331397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:25:58.331903 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:25:58.340413 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:25:58.341856 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:25:58.364197 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:25:58.365184 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:25:58.365445 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:25:58.365678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:00.362111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.996 seconds
[0m13:26:00.390110 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:26:01.002001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b01690>]}
[0m13:26:01.003768 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.67s]
[0m13:26:01.004621 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:26:01.005188 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:26:01.006091 [info ] [Thread-1 (]: 2 of 9 START sql view model DEV.src_games_details .............................. [RUN]
[0m13:26:01.006826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:26:01.007490 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:26:01.010287 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:26:01.012666 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:26:01.016439 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:26:01.017996 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:26:01.018419 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:26:01.018836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:03.024019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.005 seconds
[0m13:26:03.028566 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:26:03.644618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128cc4890>]}
[0m13:26:03.646370 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.64s]
[0m13:26:03.647200 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:26:03.647768 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:26:03.648509 [info ] [Thread-1 (]: 3 of 9 START sql view model DEV.src_players .................................... [RUN]
[0m13:26:03.649211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:26:03.649670 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:26:03.652298 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:26:03.654134 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:26:03.658035 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:26:03.659200 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:26:03.659587 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:26:03.659914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:05.407074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m13:26:05.411615 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:26:06.040674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128fc6bd0>]}
[0m13:26:06.042055 [info ] [Thread-1 (]: 3 of 9 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.39s]
[0m13:26:06.042895 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:26:06.043445 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:26:06.044237 [info ] [Thread-1 (]: 4 of 9 START sql view model DEV.src_ranking .................................... [RUN]
[0m13:26:06.044813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:26:06.045225 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:26:06.047976 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:26:06.049524 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:26:06.053010 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:26:06.054300 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:26:06.054681 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:26:06.055034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:07.939866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.884 seconds
[0m13:26:07.957055 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:26:08.566461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6b8d0>]}
[0m13:26:08.568296 [info ] [Thread-1 (]: 4 of 9 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.52s]
[0m13:26:08.569188 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:26:08.569811 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:26:08.570516 [info ] [Thread-1 (]: 5 of 9 START sql view model DEV.src_teams ...................................... [RUN]
[0m13:26:08.571090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:26:08.571629 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:26:08.574448 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:26:08.575523 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:26:08.581211 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:26:08.582712 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:26:08.583137 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:26:08.583520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:10.426459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.843 seconds
[0m13:26:10.430099 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:26:11.015887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffcf90>]}
[0m13:26:11.017563 [info ] [Thread-1 (]: 5 of 9 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.44s]
[0m13:26:11.018523 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:26:11.019238 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:26:11.020482 [info ] [Thread-1 (]: 6 of 9 START sql view model DEV.dim_seasons .................................... [RUN]
[0m13:26:11.021304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:26:11.021735 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:26:11.028019 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:26:11.030094 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:26:11.033327 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:26:11.034588 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:26:11.034972 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:26:11.035323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:12.830881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.795 seconds
[0m13:26:12.835880 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:26:13.448323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119229450>]}
[0m13:26:13.450060 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.43s]
[0m13:26:13.450941 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:26:13.451573 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:26:13.452335 [info ] [Thread-1 (]: 7 of 9 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m13:26:13.452995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:26:13.453459 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:26:13.458913 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:26:13.461137 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:26:13.464577 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:26:13.465702 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:26:13.466096 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:26:13.466457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:15.269280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.803 seconds
[0m13:26:15.271910 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:26:15.928707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197b4ad0>]}
[0m13:26:15.930607 [info ] [Thread-1 (]: 7 of 9 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.48s]
[0m13:26:15.931759 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:26:15.932627 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:26:15.933637 [info ] [Thread-1 (]: 8 of 9 START sql incremental model DEV.int_player_stats ........................ [RUN]
[0m13:26:15.934394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:26:15.934830 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:26:15.946577 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:26:15.948177 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:26:15.979503 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:26:15.980809 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:26:15.981093 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace transient table NBA_GAMES.DEV.int_player_stats
         as
        (

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.START_POSITION,
        gd.MIN,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.TO,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    START_POSITION,
    MIN,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    TO,
    PF,
    PLUS_MINUS
FROM player_stats


        );
[0m13:26:15.981341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:17.521540 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860d2-0102-32a8-0006-c35e000481d6
[0m13:26:17.522339 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 36 at position 11 unexpected 'TO'.
syntax error line 74 at position 4 unexpected 'TO'.
[0m13:26:17.523158 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:26:18.190885 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 11 unexpected 'TO'.
  syntax error line 74 at position 4 unexpected 'TO'.
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:26:18.191802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293bfdd0>]}
[0m13:26:18.192520 [error] [Thread-1 (]: 8 of 9 ERROR creating sql incremental model DEV.int_player_stats ............... [[31mERROR[0m in 2.26s]
[0m13:26:18.192890 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:26:18.193185 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:26:18.193990 [info ] [Thread-1 (]: 9 of 9 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m13:26:18.194254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:26:18.194473 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:26:18.196742 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:26:18.200147 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:26:18.202137 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:26:18.203019 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:26:18.203417 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:26:18.203801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:20.126303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.922 seconds
[0m13:26:20.133015 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:26:20.679768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5a25e-e125-477c-93be-1d686944853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4c890>]}
[0m13:26:20.681687 [info ] [Thread-1 (]: 9 of 9 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.48s]
[0m13:26:20.682723 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:26:20.687177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:20.687776 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:26:20.688424 [info ] [MainThread]: 
[0m13:26:20.689173 [info ] [MainThread]: Finished running 8 view models, 1 incremental model in 0 hours 0 minutes and 26.92 seconds (26.92s).
[0m13:26:20.691429 [debug] [MainThread]: Command end result
[0m13:26:20.732335 [info ] [MainThread]: 
[0m13:26:20.732838 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:26:20.734828 [info ] [MainThread]: 
[0m13:26:20.735287 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 11 unexpected 'TO'.
  syntax error line 74 at position 4 unexpected 'TO'.
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:26:20.735475 [info ] [MainThread]: 
[0m13:26:20.736021 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m13:26:20.743516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.660631, "process_user_time": 2.143079, "process_kernel_time": 0.355135, "process_mem_max_rss": "197591040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:26:20.744007 [debug] [MainThread]: Command `dbt run` failed at 13:26:20.743938 after 27.66 seconds
[0m13:26:20.744414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ba0dd0>]}
[0m13:26:20.744657 [debug] [MainThread]: Flushing usage events
[0m13:26:42.222564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7bfd0>]}


============================== 13:26:42.225126 | 852925e6-3f80-4af2-aee8-0f575e58c7b8 ==============================
[0m13:26:42.225126 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:26:42.225431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:26:42.787858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '852925e6-3f80-4af2-aee8-0f575e58c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df210d0>]}
[0m13:26:42.806613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '852925e6-3f80-4af2-aee8-0f575e58c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088cdd10>]}
[0m13:26:42.807121 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:26:42.867392 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:26:42.899726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:42.899913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:42.910044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '852925e6-3f80-4af2-aee8-0f575e58c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6cf90>]}
[0m13:26:42.948108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '852925e6-3f80-4af2-aee8-0f575e58c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186a0e50>]}
[0m13:26:42.948342 [info ] [MainThread]: Found 9 models, 459 macros
[0m13:26:42.948511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '852925e6-3f80-4af2-aee8-0f575e58c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118740450>]}
[0m13:26:42.949571 [info ] [MainThread]: 
[0m13:26:42.949832 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:26:42.951799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:26:42.957990 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:26:42.958147 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:26:42.958277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:44.703332 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.745 seconds
[0m13:26:44.705215 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:26:45.271478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:26:45.282178 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:26:45.282680 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:26:45.282996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:46.849141 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.566 seconds
[0m13:26:46.850900 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:26:47.474370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '852925e6-3f80-4af2-aee8-0f575e58c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107537190>]}
[0m13:26:47.475817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:47.476322 [info ] [MainThread]: 
[0m13:26:47.480537 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:26:47.481378 [info ] [Thread-1 (]: 1 of 9 START sql view model DEV.src_games ...................................... [RUN]
[0m13:26:47.482045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:26:47.482497 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:26:47.489907 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:26:47.491720 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:26:47.513379 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:26:47.514433 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:26:47.514752 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:26:47.515008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:49.390983 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.nba_analysis.src_games' (1903658354909302)
[0m13:26:49.391943 [debug] [MainThread]: Using snowflake connection "master"
[0m13:26:49.392421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1903658354909302)
[0m13:26:49.393055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:49.477213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.962 seconds
[0m13:26:50.823452 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.430 seconds
[0m13:26:50.827698 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.nba_analysis.src_games': ('0 cancelled. ',)
[0m13:26:50.828891 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:26:50.828378 [error] [MainThread]: CANCEL query model.nba_analysis.src_games ...................................... [[31mCANCEL[0m]
[0m13:26:50.831136 [debug] [MainThread]: On master: Close
[0m13:26:51.441925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '852925e6-3f80-4af2-aee8-0f575e58c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191ae890>]}
[0m13:26:51.443521 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 3.96s]
[0m13:26:51.444514 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:26:51.445235 [info ] [MainThread]: 
[0m13:26:51.445813 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m13:26:51.446208 [info ] [MainThread]: 
[0m13:26:51.446601 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m13:26:51.446977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:51.447288 [debug] [MainThread]: Connection 'model.nba_analysis.src_games' was properly closed.
[0m13:26:51.447618 [info ] [MainThread]: 
[0m13:26:51.447977 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.50 seconds (8.50s).
[0m13:26:51.448499 [error] [MainThread]: Encountered an error:

[0m13:26:51.456557 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 305, in run_queue
    self.handle_job_queue(pool, callback)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 324, in handle_job_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/Users/Shared/anaconda3/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m13:26:51.460009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.268808, "process_user_time": 1.348924, "process_kernel_time": 0.271872, "process_mem_max_rss": "194510848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:26:51.460515 [debug] [MainThread]: Command `dbt run` failed at 13:26:51.460435 after 9.27 seconds
[0m13:26:51.460858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055295d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105528d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b96990>]}
[0m13:26:51.461182 [debug] [MainThread]: Flushing usage events
[0m13:26:54.592846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c08ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c08eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c103c90>]}


============================== 13:26:54.595658 | 0f4bbd12-caa9-4062-b502-d86c34042bc1 ==============================
[0m13:26:54.595658 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:26:54.596007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:26:55.060688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7d5210>]}
[0m13:26:55.079199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa8d950>]}
[0m13:26:55.079674 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:26:55.139643 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:26:55.172112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:55.172291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:55.182425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc59e90>]}
[0m13:26:55.218476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fd610>]}
[0m13:26:55.218718 [info ] [MainThread]: Found 9 models, 459 macros
[0m13:26:55.218884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc3ed10>]}
[0m13:26:55.219937 [info ] [MainThread]: 
[0m13:26:55.220197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:26:55.222080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:26:55.228385 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:26:55.228551 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:26:55.228679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:56.888391 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.659 seconds
[0m13:26:56.892252 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:26:57.507819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:26:57.521875 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:26:57.522357 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:26:57.522668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:59.139166 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.616 seconds
[0m13:26:59.143488 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:26:59.718576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0dd590>]}
[0m13:26:59.719381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:59.719878 [info ] [MainThread]: 
[0m13:26:59.722778 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:26:59.723420 [info ] [Thread-1 (]: 1 of 9 START sql view model DEV.src_games ...................................... [RUN]
[0m13:26:59.723955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:26:59.724338 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:26:59.731051 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:26:59.732308 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:26:59.754381 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:26:59.755553 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:26:59.755843 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:26:59.756299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:01.894201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.137 seconds
[0m13:27:01.921605 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:27:02.468678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e1f8bd0>]}
[0m13:27:02.470179 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.74s]
[0m13:27:02.471102 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:27:02.471750 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:27:02.472608 [info ] [Thread-1 (]: 2 of 9 START sql view model DEV.src_games_details .............................. [RUN]
[0m13:27:02.473436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:27:02.473829 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:27:02.477517 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:27:02.479781 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:27:02.483914 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:27:02.485394 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:27:02.485748 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:27:02.486050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:04.399206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.913 seconds
[0m13:27:04.403274 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:27:04.969122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9a3a10>]}
[0m13:27:04.970296 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.50s]
[0m13:27:04.971095 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:27:04.971703 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:27:04.972446 [info ] [Thread-1 (]: 3 of 9 START sql view model DEV.src_players .................................... [RUN]
[0m13:27:04.973030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:27:04.973570 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:27:04.976298 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:27:04.977036 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:27:05.001070 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:27:05.001927 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:27:05.002148 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:27:05.002340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:06.657716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.655 seconds
[0m13:27:06.659908 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:27:07.212414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b63b090>]}
[0m13:27:07.213901 [info ] [Thread-1 (]: 3 of 9 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.24s]
[0m13:27:07.214762 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:27:07.215399 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:27:07.216421 [info ] [Thread-1 (]: 4 of 9 START sql view model DEV.src_ranking .................................... [RUN]
[0m13:27:07.217101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:27:07.217568 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:27:07.220858 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:27:07.221990 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:27:07.224750 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:27:07.225395 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:27:07.225605 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:27:07.225780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:08.975424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.749 seconds
[0m13:27:08.982944 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:27:09.529924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c5210>]}
[0m13:27:09.531439 [info ] [Thread-1 (]: 4 of 9 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.31s]
[0m13:27:09.532601 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:27:09.533473 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:27:09.534484 [info ] [Thread-1 (]: 5 of 9 START sql view model DEV.src_teams ...................................... [RUN]
[0m13:27:09.535184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:27:09.535698 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:27:09.540270 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:27:09.541328 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:27:09.554222 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:27:09.555979 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:27:09.556386 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:27:09.556786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:11.264662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.708 seconds
[0m13:27:11.269843 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:27:11.831673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b406d90>]}
[0m13:27:11.832381 [info ] [Thread-1 (]: 5 of 9 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.30s]
[0m13:27:11.832955 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:27:11.833395 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:27:11.834190 [info ] [Thread-1 (]: 6 of 9 START sql view model DEV.dim_seasons .................................... [RUN]
[0m13:27:11.834624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:27:11.834821 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:27:11.838251 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:27:11.839044 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:27:11.841326 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:27:11.841991 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:27:11.842244 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:27:11.842748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:13.480826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.637 seconds
[0m13:27:13.502585 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:27:14.048442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf57850>]}
[0m13:27:14.049807 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.21s]
[0m13:27:14.050822 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:27:14.051631 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:27:14.052600 [info ] [Thread-1 (]: 7 of 9 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m13:27:14.053247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:27:14.053704 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:27:14.058973 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:27:14.060033 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:27:14.065861 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:27:14.067839 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:27:14.068138 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:27:14.068499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:15.727025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.658 seconds
[0m13:27:15.731007 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:27:16.268579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4802d0>]}
[0m13:27:16.270744 [info ] [Thread-1 (]: 7 of 9 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.21s]
[0m13:27:16.272088 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:27:16.272851 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:27:16.273764 [info ] [Thread-1 (]: 8 of 9 START sql incremental model DEV.int_player_stats ........................ [RUN]
[0m13:27:16.274621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:27:16.275109 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:27:16.285501 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:27:16.286298 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:27:16.316149 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:27:16.317384 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:27:16.317662 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace transient table NBA_GAMES.DEV.int_player_stats
         as
        (

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.START_POSITION,
        gd.MIN,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    START_POSITION,
    MIN,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


        );
[0m13:27:16.317929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:17.861738 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860d3-0102-32a8-0006-c35e000481f2
[0m13:27:17.862220 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 8
invalid identifier 'GD.START_POSITION'
[0m13:27:17.862714 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:27:18.396244 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'GD.START_POSITION'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:27:18.397393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b409950>]}
[0m13:27:18.398714 [error] [Thread-1 (]: 8 of 9 ERROR creating sql incremental model DEV.int_player_stats ............... [[31mERROR[0m in 2.12s]
[0m13:27:18.399550 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:27:18.400115 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:27:18.401925 [info ] [Thread-1 (]: 9 of 9 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m13:27:18.402594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:27:18.403032 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:27:18.407142 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:27:18.408390 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:27:18.412172 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:27:18.414090 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:27:18.414707 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:27:18.415117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:20.233041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.817 seconds
[0m13:27:20.239713 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:27:20.784091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4bbd12-caa9-4062-b502-d86c34042bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b6461d0>]}
[0m13:27:20.785924 [info ] [Thread-1 (]: 9 of 9 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.38s]
[0m13:27:20.786934 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:27:20.789698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:20.790195 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:27:20.790847 [info ] [MainThread]: 
[0m13:27:20.791271 [info ] [MainThread]: Finished running 8 view models, 1 incremental model in 0 hours 0 minutes and 25.57 seconds (25.57s).
[0m13:27:20.793807 [debug] [MainThread]: Command end result
[0m13:27:20.834917 [info ] [MainThread]: 
[0m13:27:20.835252 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:27:20.835447 [info ] [MainThread]: 
[0m13:27:20.835678 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'GD.START_POSITION'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:27:20.835858 [info ] [MainThread]: 
[0m13:27:20.836036 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m13:27:20.838568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.272236, "process_user_time": 1.954826, "process_kernel_time": 0.389478, "process_mem_max_rss": "190939136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:27:20.839011 [debug] [MainThread]: Command `dbt run` failed at 13:27:20.838959 after 26.27 seconds
[0m13:27:20.839312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba1a490>]}
[0m13:27:20.839555 [debug] [MainThread]: Flushing usage events
[0m13:28:47.216535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edd650>]}


============================== 13:28:47.219329 | 42aae34e-dd31-4eef-95f1-6103638db113 ==============================
[0m13:28:47.219329 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:28:47.219634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:47.735955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117585290>]}
[0m13:28:47.755199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107945d10>]}
[0m13:28:47.755730 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:28:47.815020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:28:47.847421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:47.847612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:47.857838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11793b690>]}
[0m13:28:47.898479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117922550>]}
[0m13:28:47.898721 [info ] [MainThread]: Found 9 models, 459 macros
[0m13:28:47.898884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d6d90>]}
[0m13:28:47.899968 [info ] [MainThread]: 
[0m13:28:47.900245 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:47.902136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:28:47.908546 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:28:47.908706 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:28:47.908833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:49.736135 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.827 seconds
[0m13:28:49.738782 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:28:50.354011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:28:50.366320 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:28:50.366718 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:28:50.367021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:51.971261 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.604 seconds
[0m13:28:51.976259 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:28:52.607272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11752b3d0>]}
[0m13:28:52.609036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:52.609470 [info ] [MainThread]: 
[0m13:28:52.612028 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:28:52.612571 [info ] [Thread-1 (]: 1 of 9 START sql view model DEV.src_games ...................................... [RUN]
[0m13:28:52.613105 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m13:28:52.613406 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:28:52.620088 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:28:52.621186 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:28:52.644873 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:28:52.645868 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:28:52.646126 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:28:52.646351 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:54.647755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.001 seconds
[0m13:28:54.671744 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:28:55.268225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101d42d0>]}
[0m13:28:55.269724 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.65s]
[0m13:28:55.270684 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:28:55.271344 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:28:55.272350 [info ] [Thread-1 (]: 2 of 9 START sql view model DEV.src_games_details .............................. [RUN]
[0m13:28:55.272972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:28:55.273383 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:28:55.276480 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:28:55.278254 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:28:55.282347 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:28:55.283960 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:28:55.284394 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:28:55.284826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:57.441368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.156 seconds
[0m13:28:57.446912 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:28:58.031226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688f910>]}
[0m13:28:58.032288 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.76s]
[0m13:28:58.033029 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:28:58.033550 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:28:58.034209 [info ] [Thread-1 (]: 3 of 9 START sql view model DEV.src_players .................................... [RUN]
[0m13:28:58.034843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:28:58.035257 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:28:58.037373 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:28:58.040474 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:28:58.044856 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:28:58.045787 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:28:58.046108 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:28:58.046399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:59.758315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.711 seconds
[0m13:28:59.763820 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:29:00.388406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110959190>]}
[0m13:29:00.389482 [info ] [Thread-1 (]: 3 of 9 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.35s]
[0m13:29:00.390208 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:29:00.390716 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:29:00.391272 [info ] [Thread-1 (]: 4 of 9 START sql view model DEV.src_ranking .................................... [RUN]
[0m13:29:00.391913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:29:00.392305 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:29:00.394787 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:29:00.396008 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:29:00.398940 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:29:00.400416 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:29:00.400766 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:29:00.401073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:02.279483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.878 seconds
[0m13:29:02.282175 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:29:02.946692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006f450>]}
[0m13:29:02.948956 [info ] [Thread-1 (]: 4 of 9 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.55s]
[0m13:29:02.950273 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:29:02.951284 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:29:02.952261 [info ] [Thread-1 (]: 5 of 9 START sql view model DEV.src_teams ...................................... [RUN]
[0m13:29:02.952976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:29:02.953427 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:29:02.956273 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:29:02.958537 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:29:02.963783 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:29:02.965113 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:29:02.965499 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:29:02.965823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:04.933701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.968 seconds
[0m13:29:04.936457 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:29:05.465071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a88fd0>]}
[0m13:29:05.466644 [info ] [Thread-1 (]: 5 of 9 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.51s]
[0m13:29:05.467686 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:29:05.468422 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:29:05.469283 [info ] [Thread-1 (]: 6 of 9 START sql view model DEV.dim_seasons .................................... [RUN]
[0m13:29:05.470186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:29:05.470585 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:29:05.475520 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:29:05.477401 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:29:05.481260 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:29:05.482272 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:29:05.482735 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:29:05.483051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:07.299177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.816 seconds
[0m13:29:07.303972 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:29:07.864722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d5eb50>]}
[0m13:29:07.865834 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.39s]
[0m13:29:07.866672 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:29:07.867130 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:29:07.867959 [info ] [Thread-1 (]: 7 of 9 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m13:29:07.868778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:29:07.869248 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:29:07.874100 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:29:07.874907 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:29:07.877531 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:29:07.878925 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:29:07.879318 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:29:07.879672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:09.559936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.680 seconds
[0m13:29:09.563651 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:29:10.104696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8a5d0>]}
[0m13:29:10.106227 [info ] [Thread-1 (]: 7 of 9 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.24s]
[0m13:29:10.107491 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:29:10.108532 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:29:10.109524 [info ] [Thread-1 (]: 8 of 9 START sql incremental model DEV.int_player_stats ........................ [RUN]
[0m13:29:10.110092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:29:10.110531 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:29:10.119583 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:29:10.120496 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:29:10.149663 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:29:10.150974 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:29:10.151258 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace transient table NBA_GAMES.DEV.int_player_stats
         as
        (

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.MIN,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    MIN,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


        );
[0m13:29:10.151523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:11.659830 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860d5-0102-32a8-0006-c35e00048206
[0m13:29:11.660357 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 8
invalid identifier 'GD.MIN'
[0m13:29:11.660992 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:29:12.217511 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'GD.MIN'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:29:12.218227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d75250>]}
[0m13:29:12.218845 [error] [Thread-1 (]: 8 of 9 ERROR creating sql incremental model DEV.int_player_stats ............... [[31mERROR[0m in 2.11s]
[0m13:29:12.219651 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:29:12.220047 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:29:12.221292 [info ] [Thread-1 (]: 9 of 9 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m13:29:12.221706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:29:12.221983 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:29:12.224652 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:29:12.225294 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:29:12.227729 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:29:12.228869 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:29:12.229164 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:29:12.229434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:13.965421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m13:29:13.971864 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:29:14.598336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42aae34e-dd31-4eef-95f1-6103638db113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b97f10>]}
[0m13:29:14.599795 [info ] [Thread-1 (]: 9 of 9 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.38s]
[0m13:29:14.600563 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:29:14.602763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:14.603252 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m13:29:14.603609 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:29:14.604186 [info ] [MainThread]: 
[0m13:29:14.604612 [info ] [MainThread]: Finished running 8 view models, 1 incremental model in 0 hours 0 minutes and 26.70 seconds (26.70s).
[0m13:29:14.606375 [debug] [MainThread]: Command end result
[0m13:29:14.645759 [info ] [MainThread]: 
[0m13:29:14.646051 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:29:14.646218 [info ] [MainThread]: 
[0m13:29:14.646434 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'GD.MIN'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:29:14.646637 [info ] [MainThread]: 
[0m13:29:14.646819 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m13:29:14.649142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.460318, "process_user_time": 2.079631, "process_kernel_time": 0.358894, "process_mem_max_rss": "195526656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:29:14.649516 [debug] [MainThread]: Command `dbt run` failed at 13:29:14.649474 after 27.46 seconds
[0m13:29:14.649808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033895d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103388d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117da3a10>]}
[0m13:29:14.650057 [debug] [MainThread]: Flushing usage events
[0m13:29:48.776182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108859150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bfed0>]}


============================== 13:29:48.779055 | 678fd60f-8f87-4620-9b32-23fff795ffd1 ==============================
[0m13:29:48.779055 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:29:48.779354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:29:49.353537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1cd90>]}
[0m13:29:49.373160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd87d10>]}
[0m13:29:49.373784 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:29:49.436556 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:29:49.470374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:49.470585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:49.481073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfe7010>]}
[0m13:29:49.519745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd545d0>]}
[0m13:29:49.519996 [info ] [MainThread]: Found 9 models, 459 macros
[0m13:29:49.520162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ded4250>]}
[0m13:29:49.521412 [info ] [MainThread]: 
[0m13:29:49.521687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:29:49.523589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:29:49.529670 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:29:49.529824 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:29:49.529949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:51.120956 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.591 seconds
[0m13:29:51.124781 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:29:51.673548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:29:51.679693 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:29:51.679956 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:29:51.680127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:53.248960 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.569 seconds
[0m13:29:53.252169 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:29:53.794128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d7e10>]}
[0m13:29:53.795400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:53.795887 [info ] [MainThread]: 
[0m13:29:53.799058 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:29:53.799775 [info ] [Thread-1 (]: 1 of 9 START sql view model DEV.src_games ...................................... [RUN]
[0m13:29:53.800336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:29:53.800915 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:29:53.809029 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:29:53.810583 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:29:53.835149 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:29:53.836078 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:29:53.836325 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:29:53.836538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:55.828256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.991 seconds
[0m13:29:55.859103 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:29:56.420995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e241350>]}
[0m13:29:56.422327 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.62s]
[0m13:29:56.423125 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:29:56.423708 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:29:56.424605 [info ] [Thread-1 (]: 2 of 9 START sql view model DEV.src_games_details .............................. [RUN]
[0m13:29:56.425314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:29:56.425783 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:29:56.428079 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:29:56.430126 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:29:56.433852 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:29:56.435622 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:29:56.436034 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:29:56.436385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:58.342201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.905 seconds
[0m13:29:58.347172 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:29:58.961201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105300a50>]}
[0m13:29:58.963008 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.54s]
[0m13:29:58.963965 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:29:58.964581 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:29:58.965336 [info ] [Thread-1 (]: 3 of 9 START sql view model DEV.src_players .................................... [RUN]
[0m13:29:58.965958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:29:58.966368 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:29:58.969658 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:29:58.970869 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:29:58.975035 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:29:58.976141 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:29:58.976524 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:29:58.976904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:00.740347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.763 seconds
[0m13:30:00.745326 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:30:01.420231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a59d0>]}
[0m13:30:01.422144 [info ] [Thread-1 (]: 3 of 9 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.45s]
[0m13:30:01.423077 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:30:01.423758 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:30:01.424725 [info ] [Thread-1 (]: 4 of 9 START sql view model DEV.src_ranking .................................... [RUN]
[0m13:30:01.425341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:30:01.426092 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:30:01.429374 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:30:01.430938 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:30:01.434521 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:30:01.435831 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:30:01.436228 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:30:01.436600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:03.253511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.816 seconds
[0m13:30:03.258614 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:30:03.880509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ad010>]}
[0m13:30:03.882648 [info ] [Thread-1 (]: 4 of 9 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.45s]
[0m13:30:03.883929 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:30:03.884611 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:30:03.885409 [info ] [Thread-1 (]: 5 of 9 START sql view model DEV.src_teams ...................................... [RUN]
[0m13:30:03.886112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:30:03.886576 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:30:03.889408 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:30:03.890520 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:30:03.896120 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:30:03.897722 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:30:03.898134 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:30:03.898464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:05.918970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.020 seconds
[0m13:30:05.924530 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:30:06.479146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108859990>]}
[0m13:30:06.480947 [info ] [Thread-1 (]: 5 of 9 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.59s]
[0m13:30:06.481870 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:30:06.482556 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:30:06.483499 [info ] [Thread-1 (]: 6 of 9 START sql view model DEV.dim_seasons .................................... [RUN]
[0m13:30:06.484164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:30:06.484639 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:30:06.490701 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:30:06.492642 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:30:06.495923 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:30:06.497475 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:30:06.498088 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:30:06.498593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:08.182997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.684 seconds
[0m13:30:08.188110 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:30:08.736280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3e7d50>]}
[0m13:30:08.737826 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.25s]
[0m13:30:08.738548 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:30:08.739082 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:30:08.739954 [info ] [Thread-1 (]: 7 of 9 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m13:30:08.740489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:30:08.740907 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:30:08.744643 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:30:08.747069 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:30:08.750159 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:30:08.751518 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:30:08.751904 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:30:08.752216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:10.454157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.701 seconds
[0m13:30:10.459105 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:30:11.016347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1a3d0>]}
[0m13:30:11.017321 [info ] [Thread-1 (]: 7 of 9 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.28s]
[0m13:30:11.018055 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:30:11.018597 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:30:11.019309 [info ] [Thread-1 (]: 8 of 9 START sql incremental model DEV.int_player_stats ........................ [RUN]
[0m13:30:11.019943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:30:11.020398 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:30:11.029911 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:30:11.031206 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:30:11.060726 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:30:11.061939 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:30:11.062205 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace transient table NBA_GAMES.DEV.int_player_stats
         as
        (

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


        );
[0m13:30:11.062495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:24.055729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 12.992 seconds
[0m13:30:24.074402 [debug] [Thread-1 (]: Applying DROP to: NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:30:24.080611 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:30:24.080976 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
drop view if exists NBA_GAMES.DEV.int_player_stats__dbt_tmp cascade
[0m13:30:24.369869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m13:30:24.375521 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:30:24.921340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2bbf50>]}
[0m13:30:24.923410 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model DEV.int_player_stats ................... [[32mSUCCESS 1[0m in 13.90s]
[0m13:30:24.924412 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:30:24.925115 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:30:24.926066 [info ] [Thread-1 (]: 9 of 9 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m13:30:24.926953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:30:24.927669 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:30:24.932567 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:30:24.934449 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:30:24.938139 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:30:24.939889 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:30:24.940311 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:30:24.940697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:26.911175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.970 seconds
[0m13:30:26.915919 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:30:27.578095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fd60f-8f87-4620-9b32-23fff795ffd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e417c50>]}
[0m13:30:27.579779 [info ] [Thread-1 (]: 9 of 9 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.65s]
[0m13:30:27.580922 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:30:27.583589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:27.583977 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:30:27.584567 [info ] [MainThread]: 
[0m13:30:27.584973 [info ] [MainThread]: Finished running 8 view models, 1 incremental model in 0 hours 0 minutes and 38.06 seconds (38.06s).
[0m13:30:27.587725 [debug] [MainThread]: Command end result
[0m13:30:27.630526 [info ] [MainThread]: 
[0m13:30:27.630846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:27.631036 [info ] [MainThread]: 
[0m13:30:27.631277 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:30:27.635602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 38.886993, "process_user_time": 2.138089, "process_kernel_time": 0.389233, "process_mem_max_rss": "183681024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:30:27.635998 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:27.635948 after 38.89 seconds
[0m13:30:27.636276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105005c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f60cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f615d0>]}
[0m13:30:27.636508 [debug] [MainThread]: Flushing usage events
[0m13:36:39.335172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417ff90>]}


============================== 13:36:39.338234 | 3746bf90-736f-4e8e-8f43-4504ba65f0cf ==============================
[0m13:36:39.338234 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:36:39.338537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:40.015564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e7210>]}
[0m13:36:40.034787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bd1c10>]}
[0m13:36:40.035312 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:36:40.096875 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:36:40.129864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:40.130060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:40.140544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109862e50>]}
[0m13:36:40.182382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10987d010>]}
[0m13:36:40.182636 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:36:40.182808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bdb50>]}
[0m13:36:40.183930 [info ] [MainThread]: 
[0m13:36:40.184202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:36:40.186116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:36:40.192377 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:36:40.192534 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:36:40.192655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:42.124727 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.932 seconds
[0m13:36:42.128200 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:36:42.678680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:36:42.692405 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:36:42.692899 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:36:42.693216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:44.264183 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.571 seconds
[0m13:36:44.269383 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:36:44.898661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10283ae50>]}
[0m13:36:44.899442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:44.899848 [info ] [MainThread]: 
[0m13:36:44.903348 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:36:44.903985 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:36:44.904440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:36:44.904899 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:36:44.913239 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:36:44.914785 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:36:44.935220 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:36:44.936682 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:36:44.936942 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:36:44.937168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:47.176639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.239 seconds
[0m13:36:47.201182 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:36:47.846920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709a010>]}
[0m13:36:47.848281 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.94s]
[0m13:36:47.849606 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:36:47.850285 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:36:47.851194 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:36:47.851762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:36:47.852143 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:36:47.854773 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:36:47.857083 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:36:47.861829 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:36:47.863438 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:36:47.863886 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:36:47.864290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:50.096625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.232 seconds
[0m13:36:50.101749 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:36:50.713550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b78990>]}
[0m13:36:50.714651 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.86s]
[0m13:36:50.715376 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:36:50.715884 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:36:50.716560 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:36:50.717192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:36:50.717642 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:36:50.720137 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:36:50.721934 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:36:50.725712 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:36:50.727061 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:36:50.727391 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:36:50.727680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:52.372170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.644 seconds
[0m13:36:52.377555 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:36:52.963754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107042990>]}
[0m13:36:52.965488 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.25s]
[0m13:36:52.966353 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:36:52.966990 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:36:52.967940 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:36:52.968530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:36:52.968955 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:36:52.972188 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:36:52.973058 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:36:52.977036 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:36:52.978771 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:36:52.979179 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:36:52.979714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:54.859615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.879 seconds
[0m13:36:54.865856 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:36:55.527421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980f210>]}
[0m13:36:55.528374 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.56s]
[0m13:36:55.528991 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:36:55.529419 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:36:55.529990 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:36:55.530512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:36:55.530865 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:36:55.532989 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:36:55.534984 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:36:55.539614 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:36:55.541209 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:36:55.541551 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:36:55.541847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:57.471860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.929 seconds
[0m13:36:57.477274 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:36:58.056009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102daecd0>]}
[0m13:36:58.057060 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.53s]
[0m13:36:58.057773 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:36:58.058275 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:36:58.059040 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:36:58.059658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:36:58.060079 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:36:58.063638 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:36:58.065659 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:36:58.068755 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:36:58.069766 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:36:58.070092 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:36:58.070395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:59.820199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.749 seconds
[0m13:36:59.825424 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:37:00.442402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709a190>]}
[0m13:37:00.444283 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.38s]
[0m13:37:00.445159 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:37:00.445801 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:37:00.446579 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:37:00.447238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:37:00.447690 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:37:00.453166 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:37:00.455421 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:37:00.458732 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:37:00.459827 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:37:00.460213 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:37:00.460583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:02.196332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m13:37:02.204354 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:37:02.741951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbab50>]}
[0m13:37:02.743600 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.29s]
[0m13:37:02.744494 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:37:02.745106 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:37:02.745929 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:37:02.746532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:37:02.746960 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:37:02.759908 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:37:02.762933 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:37:02.787303 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:37:02.787650 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  -- Assuming GAME_DATE_EST is a date or timestamp column that represents new data entries
  AND GAME_DATE_EST > (select max(GAME_DATE_EST) from NBA_GAMES.DEV.int_player_stats)

  );
[0m13:37:02.787928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:04.296383 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860dd-0102-31cd-0006-c35e00044496
[0m13:37:04.297258 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 82 at position 2 unexpected 'AND'.
syntax error line 82 at position 49 unexpected 'from'.
[0m13:37:04.298147 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:37:04.955128 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  001003 (42000): SQL compilation error:
  syntax error line 82 at position 2 unexpected 'AND'.
  syntax error line 82 at position 49 unexpected 'from'.
[0m13:37:04.956290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf3850>]}
[0m13:37:04.957314 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.21s]
[0m13:37:04.958084 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:37:04.958638 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:37:04.960650 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:37:04.961420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:37:04.961866 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:37:04.965731 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:37:04.967572 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:37:04.970844 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:37:04.972651 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:37:04.973036 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:37:04.973404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:06.889121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.915 seconds
[0m13:37:06.894337 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:37:07.452408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3746bf90-736f-4e8e-8f43-4504ba65f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109820150>]}
[0m13:37:07.454246 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.49s]
[0m13:37:07.455087 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:37:07.455694 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:37:07.456614 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:37:07.457491 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:37:07.459604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:07.460005 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:37:07.460538 [info ] [MainThread]: 
[0m13:37:07.460955 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 27.28 seconds (27.28s).
[0m13:37:07.462814 [debug] [MainThread]: Command end result
[0m13:37:07.498577 [info ] [MainThread]: 
[0m13:37:07.498878 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:37:07.499044 [info ] [MainThread]: 
[0m13:37:07.499242 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  001003 (42000): SQL compilation error:
  syntax error line 82 at position 2 unexpected 'AND'.
  syntax error line 82 at position 49 unexpected 'from'.
[0m13:37:07.499413 [info ] [MainThread]: 
[0m13:37:07.499601 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:37:07.502252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.22904, "process_user_time": 2.184491, "process_kernel_time": 0.373945, "process_mem_max_rss": "193069056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:37:07.502747 [debug] [MainThread]: Command `dbt run` failed at 13:37:07.502690 after 28.23 seconds
[0m13:37:07.503044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10082d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10082cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf4490>]}
[0m13:37:07.503257 [debug] [MainThread]: Flushing usage events
[0m13:39:03.308698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f3f50>]}


============================== 13:39:03.311504 | 242faf64-9a9b-4a76-8c9e-17d842f14eea ==============================
[0m13:39:03.311504 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:39:03.311814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:39:04.029842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b60c650>]}
[0m13:39:04.048723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d35cd0>]}
[0m13:39:04.049233 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:39:04.112351 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:39:04.146776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:04.146980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:04.157325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7a82d0>]}
[0m13:39:04.198662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ed790>]}
[0m13:39:04.198900 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:39:04.199070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ef6d0>]}
[0m13:39:04.200169 [info ] [MainThread]: 
[0m13:39:04.200432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:39:04.202324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:39:04.208827 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:39:04.209000 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:39:04.209312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:05.910686 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.701 seconds
[0m13:39:05.914361 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:39:06.571656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:39:06.585551 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:39:06.586091 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:39:06.586423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:08.752953 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.166 seconds
[0m13:39:08.757645 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:39:09.297833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ab210>]}
[0m13:39:09.299282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:09.299850 [info ] [MainThread]: 
[0m13:39:09.304120 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:39:09.305081 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:39:09.305969 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m13:39:09.306503 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:39:09.315917 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:39:09.317574 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:39:09.339543 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:39:09.340888 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:39:09.341173 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:39:09.341409 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:39:11.126690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.785 seconds
[0m13:39:11.200178 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:39:11.762430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcd5310>]}
[0m13:39:11.764106 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.45s]
[0m13:39:11.764859 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:39:11.765411 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:39:11.766354 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:39:11.766775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:39:11.767048 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:39:11.769291 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:39:11.770734 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:39:11.773570 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:39:11.774951 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:39:11.775396 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:39:11.775687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:13.627958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.852 seconds
[0m13:39:13.633235 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:39:14.183342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc9d1d0>]}
[0m13:39:14.184357 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.42s]
[0m13:39:14.185274 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:39:14.185943 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:39:14.186734 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:39:14.187381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:39:14.187879 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:39:14.191467 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:39:14.192631 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:39:14.195943 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:39:14.196980 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:39:14.197260 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:39:14.197501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:15.793732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.596 seconds
[0m13:39:15.798810 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:39:16.401201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0fad0>]}
[0m13:39:16.402952 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.21s]
[0m13:39:16.403889 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:39:16.404540 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:39:16.405707 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:39:16.406558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:39:16.407445 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:39:16.410970 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:39:16.413211 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:39:16.417147 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:39:16.419152 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:39:16.419637 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:39:16.420011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:18.269453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.849 seconds
[0m13:39:18.275821 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:39:18.827421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6e9510>]}
[0m13:39:18.829188 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.42s]
[0m13:39:18.830323 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:39:18.830992 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:39:18.831710 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:39:18.832327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:39:18.832827 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:39:18.835671 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:39:18.836817 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:39:18.843594 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:39:18.845604 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:39:18.846048 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:39:18.846513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:20.682541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.836 seconds
[0m13:39:20.687434 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:39:21.242952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a5210>]}
[0m13:39:21.244686 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.41s]
[0m13:39:21.245755 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:39:21.246472 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:39:21.247310 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:39:21.247972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:39:21.248411 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:39:21.254100 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:39:21.257259 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:39:21.261386 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:39:21.264828 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:39:21.265229 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:39:21.265556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:22.981252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.715 seconds
[0m13:39:22.987139 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:39:23.537112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f5790>]}
[0m13:39:23.538902 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.29s]
[0m13:39:23.539840 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:39:23.540450 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:39:23.541151 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:39:23.541835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:39:23.542436 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:39:23.547250 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:39:23.549953 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:39:23.553519 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:39:23.554910 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:39:23.555381 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:39:23.555713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:25.336110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.780 seconds
[0m13:39:25.341824 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:39:25.954755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f5450>]}
[0m13:39:25.956195 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.41s]
[0m13:39:25.957007 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:39:25.957613 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:39:25.958419 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:39:25.959124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:39:25.959596 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:39:25.971049 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:39:25.972915 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:39:25.996099 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:39:25.996461 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_MIN,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  -- Assuming GAME_DATE_EST is a date or timestamp column that represents new data entries
  WHERE GAME_DATE_EST > (select max(GAME_DATE_EST) from NBA_GAMES.DEV.int_player_stats)

  );
[0m13:39:25.996799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:28.097080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.100 seconds
[0m13:39:28.112344 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:39:28.112655 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:39:28.413476 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.300 seconds
[0m13:39:28.421032 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:39:28.421657 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:39:28.712395 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.290 seconds
[0m13:39:28.727627 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:39:28.728293 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:39:29.043290 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.314 seconds
[0m13:39:29.080070 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:39:29.083130 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:39:29.083468 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:39:29.407095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m13:39:29.415319 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:39:29.417569 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:39:29.780470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860df-0102-31cd-0006-c35e000444b6
[0m13:39:29.781527 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_ID'
[0m13:39:29.782362 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:39:30.333865 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:39:30.334495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105774410>]}
[0m13:39:30.335260 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.38s]
[0m13:39:30.335968 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:39:30.336500 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:39:30.338247 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:39:30.338930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:39:30.339279 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:39:30.343165 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:39:30.344678 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:39:30.347624 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:39:30.350800 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:39:30.351358 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:39:30.351762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:32.071991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.720 seconds
[0m13:39:32.075880 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:39:32.617391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242faf64-9a9b-4a76-8c9e-17d842f14eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e920d0>]}
[0m13:39:32.618614 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.28s]
[0m13:39:32.619231 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:39:32.619655 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:39:32.620181 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:39:32.620698 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:39:32.622043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:32.622308 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m13:39:32.622526 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:39:32.622934 [info ] [MainThread]: 
[0m13:39:32.623209 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.42 seconds (28.42s).
[0m13:39:32.624550 [debug] [MainThread]: Command end result
[0m13:39:32.659898 [info ] [MainThread]: 
[0m13:39:32.660309 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:39:32.660477 [info ] [MainThread]: 
[0m13:39:32.660684 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:39:32.660856 [info ] [MainThread]: 
[0m13:39:32.661027 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:39:32.665495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.386063, "process_user_time": 2.165107, "process_kernel_time": 0.403173, "process_mem_max_rss": "191643648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:39:32.666129 [debug] [MainThread]: Command `dbt run` failed at 13:39:32.666077 after 29.39 seconds
[0m13:39:32.666559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106307a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029915d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102990d10>]}
[0m13:39:32.666854 [debug] [MainThread]: Flushing usage events
[0m13:44:09.248029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105252450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052aa290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c3fd0>]}


============================== 13:44:09.251544 | 4b3e9196-076f-4c83-915b-6458ae3b35c3 ==============================
[0m13:44:09.251544 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:44:09.252090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:10.100016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f389c10>]}
[0m13:44:10.124353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b45e90>]}
[0m13:44:10.125127 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:44:10.199818 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:44:10.235721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:10.235974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:10.247000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f607b10>]}
[0m13:44:10.289445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f32acd0>]}
[0m13:44:10.289782 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:44:10.289970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f566850>]}
[0m13:44:10.291547 [info ] [MainThread]: 
[0m13:44:10.291929 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:10.294040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:44:10.300773 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:44:10.300966 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:44:10.301107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:12.120012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.819 seconds
[0m13:44:12.122704 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:44:12.660900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:44:12.671683 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:44:12.672016 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:44:12.672190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:14.196620 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.524 seconds
[0m13:44:14.200105 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:44:14.758461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f56f10>]}
[0m13:44:14.759478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:14.759991 [info ] [MainThread]: 
[0m13:44:14.763604 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:44:14.764290 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:44:14.764823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:44:14.765222 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:44:14.771051 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:44:14.772649 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:44:14.796699 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:44:14.797960 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:44:14.798284 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:44:14.798580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:16.487838 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.689 seconds
[0m13:44:16.514836 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:44:17.060020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a93110>]}
[0m13:44:17.061334 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.29s]
[0m13:44:17.062125 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:44:17.062701 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:44:17.063583 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:44:17.064290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:44:17.064710 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:44:17.066985 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:44:17.070490 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:44:17.074077 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:44:17.075694 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:44:17.076084 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:44:17.076468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:19.021424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.945 seconds
[0m13:44:19.026607 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:44:19.601987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5d490>]}
[0m13:44:19.603649 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.54s]
[0m13:44:19.604470 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:44:19.605078 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:44:19.605876 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:44:19.606618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:44:19.607076 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:44:19.610004 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:44:19.611999 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:44:19.616419 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:44:19.617469 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:44:19.617860 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:44:19.618180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.108769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.490 seconds
[0m13:44:21.114567 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:44:21.688944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fbad0>]}
[0m13:44:21.690676 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.08s]
[0m13:44:21.691622 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:44:21.692265 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:44:21.693350 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:44:21.693952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:44:21.694974 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:44:21.698590 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:44:21.700332 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:44:21.703840 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:44:21.705452 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:44:21.705894 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:44:21.706266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:23.447457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.741 seconds
[0m13:44:23.453913 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:44:24.042951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a05510>]}
[0m13:44:24.044114 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m13:44:24.044863 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:44:24.045418 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:44:24.046092 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:44:24.046737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:44:24.047147 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:44:24.049300 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:44:24.050107 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:44:24.055218 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:44:24.056483 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:44:24.056832 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:44:24.057150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:25.880667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.823 seconds
[0m13:44:25.886076 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:44:26.476840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105159890>]}
[0m13:44:26.478955 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.43s]
[0m13:44:26.479945 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:44:26.480592 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:44:26.481568 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:44:26.482226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:44:26.482660 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:44:26.488697 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:44:26.491090 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:44:26.494472 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:44:26.495578 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:44:26.495956 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:44:26.496304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:28.346143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.849 seconds
[0m13:44:28.351773 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:44:28.956885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2d250>]}
[0m13:44:28.957957 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.47s]
[0m13:44:28.958668 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:44:28.959185 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:44:28.959842 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:44:28.960478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:44:28.960928 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:44:28.964797 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:44:28.966832 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:44:28.970103 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:44:28.971007 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:44:28.971319 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:44:28.971609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:30.706359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.734 seconds
[0m13:44:30.712684 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:44:31.326048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105159890>]}
[0m13:44:31.328283 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.36s]
[0m13:44:31.329125 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:44:31.329831 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:44:31.330959 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:44:31.331801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:44:31.332301 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:44:31.345430 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:44:31.347489 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:44:31.371479 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:44:31.371833 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID as game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_MIN,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  -- Assuming GAME_DATE_EST is a date or timestamp column that represents new data entries
  WHERE GAME_DATE_EST > (select max(GAME_DATE_EST) from NBA_GAMES.DEV.int_player_stats)

  );
[0m13:44:31.372119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:33.421749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.049 seconds
[0m13:44:33.433642 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:44:33.434155 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:44:33.766791 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.332 seconds
[0m13:44:33.775204 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:44:33.775777 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:44:34.078441 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.302 seconds
[0m13:44:34.099751 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:44:34.100326 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:44:34.393033 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.292 seconds
[0m13:44:34.433460 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:44:34.436535 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:44:34.436892 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:44:34.788256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m13:44:34.789506 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:44:34.790360 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:44:35.624201 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860e4-0102-3227-0006-c35e00047512
[0m13:44:35.624818 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_ID'
[0m13:44:35.625426 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:44:36.234647 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:44:36.235573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f34ea10>]}
[0m13:44:36.236415 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.90s]
[0m13:44:36.237038 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:44:36.237504 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:44:36.239138 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:44:36.239888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:44:36.240277 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:44:36.244020 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:44:36.245801 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:44:36.248875 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:44:36.250679 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:44:36.251072 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:44:36.251418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:38.168043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.916 seconds
[0m13:44:38.172044 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:44:38.722495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3e9196-076f-4c83-915b-6458ae3b35c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b0a610>]}
[0m13:44:38.723549 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.48s]
[0m13:44:38.724252 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:44:38.724696 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:44:38.725241 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:44:38.725667 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:44:38.726960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:38.727234 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:44:38.727609 [info ] [MainThread]: 
[0m13:44:38.727892 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.44 seconds (28.44s).
[0m13:44:38.729106 [debug] [MainThread]: Command end result
[0m13:44:38.759852 [info ] [MainThread]: 
[0m13:44:38.760129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:44:38.760296 [info ] [MainThread]: 
[0m13:44:38.760511 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:44:38.760676 [info ] [MainThread]: 
[0m13:44:38.760840 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:44:38.764806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.553259, "process_user_time": 2.302368, "process_kernel_time": 0.466469, "process_mem_max_rss": "189186048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:38.765165 [debug] [MainThread]: Command `dbt run` failed at 13:44:38.765124 after 29.55 seconds
[0m13:44:38.766309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e84f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101570d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015715d0>]}
[0m13:44:38.766542 [debug] [MainThread]: Flushing usage events
[0m13:46:05.263935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c52f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc7e90>]}


============================== 13:46:05.266956 | e8956d84-4be0-4604-b45a-b907236734f8 ==============================
[0m13:46:05.266956 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:46:05.267285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:46:05.786179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247d6290>]}
[0m13:46:05.805279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8da90>]}
[0m13:46:05.805871 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:46:05.869055 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:46:05.902406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:05.902610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:05.912884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117889990>]}
[0m13:46:05.950772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c20750>]}
[0m13:46:05.951008 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:46:05.951172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b66490>]}
[0m13:46:05.952283 [info ] [MainThread]: 
[0m13:46:05.952544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:46:05.954551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:46:05.961109 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:46:05.961274 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:46:05.961397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:07.599154 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.637 seconds
[0m13:46:07.602556 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:46:08.156786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:46:08.167962 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:46:08.168352 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:46:08.168647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:09.623873 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.455 seconds
[0m13:46:09.628849 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:46:10.215599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056a690>]}
[0m13:46:10.216141 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:10.216399 [info ] [MainThread]: 
[0m13:46:10.217946 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:46:10.218315 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:46:10.218643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:46:10.218884 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:46:10.223746 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:46:10.224637 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:46:10.241987 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:46:10.242863 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:46:10.243093 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:46:10.243297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:12.277368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.034 seconds
[0m13:46:12.305871 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:46:12.899653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b92990>]}
[0m13:46:12.901174 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.68s]
[0m13:46:12.902401 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:46:12.903131 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:46:12.903993 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:46:12.904686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:46:12.905202 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:46:12.907830 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:46:12.909889 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:46:12.913240 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:46:12.915119 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:46:12.915485 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:46:12.915806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:14.836893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.920 seconds
[0m13:46:14.843897 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:46:15.452373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c547d0>]}
[0m13:46:15.453994 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.55s]
[0m13:46:15.454822 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:46:15.455423 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:46:15.456220 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:46:15.456915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:46:15.457379 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:46:15.460098 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:46:15.461008 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:46:15.464748 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:46:15.465925 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:46:15.466261 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:46:15.466578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:17.087003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.620 seconds
[0m13:46:17.093211 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:46:17.631097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132214d0>]}
[0m13:46:17.632928 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.17s]
[0m13:46:17.633971 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:46:17.634679 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:46:17.635926 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:46:17.638130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:46:17.638839 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:46:17.642057 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:46:17.650465 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:46:17.653689 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:46:17.654973 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:46:17.655370 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:46:17.655881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.443743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.787 seconds
[0m13:46:19.448877 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:46:20.048824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b39490>]}
[0m13:46:20.050334 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.41s]
[0m13:46:20.051205 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:46:20.051851 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:46:20.052362 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:46:20.052722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:46:20.052987 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:46:20.054721 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:46:20.055251 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:46:20.062735 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:46:20.064822 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:46:20.065443 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:46:20.065930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:22.003065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.937 seconds
[0m13:46:22.007157 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:46:22.621034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a622d0>]}
[0m13:46:22.622389 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.57s]
[0m13:46:22.623311 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:46:22.624052 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:46:22.625126 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:46:22.625796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:46:22.626253 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:46:22.632736 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:46:22.634350 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:46:22.638903 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:46:22.640166 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:46:22.640620 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:46:22.640986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:24.308849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.668 seconds
[0m13:46:24.314551 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:46:24.873277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ba7f90>]}
[0m13:46:24.874822 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.25s]
[0m13:46:24.876102 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:46:24.876871 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:46:24.877719 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:46:24.878432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:46:24.878914 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:46:24.884516 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:46:24.886605 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:46:24.890095 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:46:24.890998 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:46:24.891363 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:46:24.891719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:26.571182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.679 seconds
[0m13:46:26.576563 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:46:27.131018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c94810>]}
[0m13:46:27.132730 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.25s]
[0m13:46:27.133724 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:46:27.134426 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:46:27.135239 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:46:27.135927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:46:27.136369 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:46:27.148977 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:46:27.150833 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:46:27.175331 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:46:27.175697 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID as game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    game_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_MIN,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  -- Assuming GAME_DATE_EST is a date or timestamp column that represents new data entries
  WHERE GAME_DATE_EST > (select max(GAME_DATE_EST) from NBA_GAMES.DEV.int_player_stats)

  );
[0m13:46:27.175986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:29.096865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.921 seconds
[0m13:46:29.109782 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:46:29.110406 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:46:29.478752 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.368 seconds
[0m13:46:29.484723 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:46:29.485166 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:46:29.785734 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.300 seconds
[0m13:46:29.798509 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:46:29.799102 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:46:30.093384 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.294 seconds
[0m13:46:30.125737 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:46:30.127742 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:46:30.128040 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:46:30.438923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m13:46:30.440612 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:46:30.441375 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:46:30.817754 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860e6-0102-32a8-0006-c35e0004829e
[0m13:46:30.818510 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_ID'
[0m13:46:30.819214 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:46:31.463162 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:46:31.464015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125baa650>]}
[0m13:46:31.464803 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.33s]
[0m13:46:31.465619 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:46:31.466100 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:46:31.468041 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:46:31.468894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:46:31.469245 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:46:31.472915 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:46:31.474512 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:46:31.478346 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:46:31.480331 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:46:31.480739 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:46:31.481092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:33.267069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.786 seconds
[0m13:46:33.271019 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:46:33.885030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8956d84-4be0-4604-b45a-b907236734f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d73710>]}
[0m13:46:33.886251 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.42s]
[0m13:46:33.887106 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:46:33.887728 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:46:33.888421 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:46:33.889021 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:46:33.890901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:33.891382 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:46:33.892246 [info ] [MainThread]: 
[0m13:46:33.892754 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 27.94 seconds (27.94s).
[0m13:46:33.894992 [debug] [MainThread]: Command end result
[0m13:46:33.930144 [info ] [MainThread]: 
[0m13:46:33.930451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:46:33.930662 [info ] [MainThread]: 
[0m13:46:33.930888 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:46:33.931077 [info ] [MainThread]: 
[0m13:46:33.931275 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:46:33.933802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.70196, "process_user_time": 2.176785, "process_kernel_time": 0.353883, "process_mem_max_rss": "197001216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:46:33.934281 [debug] [MainThread]: Command `dbt run` failed at 13:46:33.934223 after 28.70 seconds
[0m13:46:33.934584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a63f50>]}
[0m13:46:33.934791 [debug] [MainThread]: Flushing usage events
[0m13:47:26.461552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af3fd0>]}


============================== 13:47:26.464341 | 84d428ba-b3db-4ad6-a74c-eaca0f87e905 ==============================
[0m13:47:26.464341 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:47:26.464634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:47:26.998798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115de9390>]}
[0m13:47:27.034869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111445fd0>]}
[0m13:47:27.036478 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:47:27.168494 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:47:27.202690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:27.202880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:27.213422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122904dd0>]}
[0m13:47:27.254811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d2e010>]}
[0m13:47:27.255090 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:47:27.255257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11751af10>]}
[0m13:47:27.256389 [info ] [MainThread]: 
[0m13:47:27.256659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:27.258566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:47:27.265339 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:47:27.265539 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:47:27.265678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:28.992922 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.727 seconds
[0m13:47:28.996577 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:47:29.596379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:47:29.608843 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:47:29.609314 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:47:29.609634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:31.227103 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.617 seconds
[0m13:47:31.232520 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:47:31.848606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111965290>]}
[0m13:47:31.850102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:31.850629 [info ] [MainThread]: 
[0m13:47:31.855008 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:47:31.855834 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:47:31.856642 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m13:47:31.857181 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:47:31.866196 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:47:31.868120 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:47:31.890510 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:47:31.891836 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:47:31.892113 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:47:31.892374 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:33.879156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.986 seconds
[0m13:47:33.907366 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:47:34.473035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e1b750>]}
[0m13:47:34.474254 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.62s]
[0m13:47:34.475116 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:47:34.475733 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:47:34.476511 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:47:34.477133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:47:34.477595 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:47:34.480460 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:47:34.482628 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:47:34.486118 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:47:34.487606 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:47:34.487935 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:47:34.488208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:36.393908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.906 seconds
[0m13:47:36.395785 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:47:36.966208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c9050>]}
[0m13:47:36.967212 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.49s]
[0m13:47:36.967932 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:47:36.968446 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:47:36.969123 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:47:36.969750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:47:36.970198 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:47:36.972277 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:47:36.973064 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:47:36.976641 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:47:36.977565 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:47:36.977881 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:47:36.978166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:38.687528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.709 seconds
[0m13:47:38.693605 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:47:39.243598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a8ebd0>]}
[0m13:47:39.245331 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.27s]
[0m13:47:39.246283 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:47:39.246952 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:47:39.248379 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:47:39.249395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:47:39.250192 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:47:39.253980 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:47:39.256155 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:47:39.259672 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:47:39.261654 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:47:39.262111 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:47:39.262503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:41.056196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.793 seconds
[0m13:47:41.060310 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:47:41.637053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf8c10>]}
[0m13:47:41.638312 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.39s]
[0m13:47:41.639413 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:47:41.640390 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:47:41.641317 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:47:41.642060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:47:41.642631 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:47:41.645445 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:47:41.646588 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:47:41.652816 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:47:41.654304 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:47:41.654705 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:47:41.655049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:43.329881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.674 seconds
[0m13:47:43.334382 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:47:43.929110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d9050>]}
[0m13:47:43.930453 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.29s]
[0m13:47:43.931251 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:47:43.931838 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:47:43.932671 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:47:43.933344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:47:43.933905 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:47:43.938438 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:47:43.940289 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:47:43.943805 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:47:43.945117 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:47:43.945450 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:47:43.945745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:45.646121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.700 seconds
[0m13:47:45.651523 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:47:46.284432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d20190>]}
[0m13:47:46.286048 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m13:47:46.286918 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:47:46.287456 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:47:46.288132 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:47:46.288778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:47:46.289225 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:47:46.293368 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:47:46.294515 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:47:46.297731 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:47:46.298828 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:47:46.299301 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:47:46.299597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:48.058184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.758 seconds
[0m13:47:48.063098 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:47:48.741411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cc890>]}
[0m13:47:48.743139 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.45s]
[0m13:47:48.744112 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:47:48.744781 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:47:48.745554 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:47:48.746198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:47:48.746644 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:47:48.759355 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:47:48.761866 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:47:48.787026 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:47:48.787390 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID AS player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID AS game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    GAME_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  -- Assuming GAME_DATE_EST is a date or timestamp column that represents new data entries
  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:47:48.787718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:50.787259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.999 seconds
[0m13:47:50.802816 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:47:50.803413 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:47:51.096955 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.293 seconds
[0m13:47:51.107464 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:47:51.108062 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:47:51.394409 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.286 seconds
[0m13:47:51.401028 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:47:51.401298 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:47:51.707161 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.305 seconds
[0m13:47:51.745102 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:47:51.746999 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:47:51.747267 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:47:52.115566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m13:47:52.116657 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:47:52.117526 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:47:52.596847 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860e7-0102-3227-0006-c35e00047532
[0m13:47:52.597280 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_ID'
[0m13:47:52.597755 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:47:53.254391 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:47:53.255065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ba2250>]}
[0m13:47:53.255839 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.51s]
[0m13:47:53.256542 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:47:53.257026 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:47:53.258765 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:47:53.259468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:47:53.259909 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:47:53.263443 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:47:53.264410 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:47:53.267779 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:47:53.269337 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:47:53.269747 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:47:53.270082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:55.059287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m13:47:55.064819 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:47:55.704742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d428ba-b3db-4ad6-a74c-eaca0f87e905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a1fe10>]}
[0m13:47:55.706735 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.44s]
[0m13:47:55.707717 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:47:55.708382 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:47:55.709073 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:47:55.709647 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:47:55.712045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:55.712525 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m13:47:55.712886 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:47:55.713599 [info ] [MainThread]: 
[0m13:47:55.714286 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.46 seconds (28.46s).
[0m13:47:55.716232 [debug] [MainThread]: Command end result
[0m13:47:55.763302 [info ] [MainThread]: 
[0m13:47:55.763619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:55.763800 [info ] [MainThread]: 
[0m13:47:55.764031 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:47:55.764216 [info ] [MainThread]: 
[0m13:47:55.764403 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:47:55.768691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.335781, "process_user_time": 2.243126, "process_kernel_time": 0.373731, "process_mem_max_rss": "189038592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:47:55.769054 [debug] [MainThread]: Command `dbt run` failed at 13:47:55.769009 after 29.34 seconds
[0m13:47:55.769325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c7c6d0>]}
[0m13:47:55.769608 [debug] [MainThread]: Flushing usage events
[0m13:48:19.459178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109852810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b7ed0>]}


============================== 13:48:19.461786 | 813aa948-49cc-4d5a-82e7-fa6670aa60f0 ==============================
[0m13:48:19.461786 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:48:19.462139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:48:19.974765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd4f350>]}
[0m13:48:19.993341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109045c90>]}
[0m13:48:19.993816 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:48:20.054362 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:48:20.086935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:48:20.087124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:48:20.097289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985dd90>]}
[0m13:48:20.139352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd61510>]}
[0m13:48:20.139598 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:48:20.139764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa6f50>]}
[0m13:48:20.140839 [info ] [MainThread]: 
[0m13:48:20.141107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:48:20.142997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:48:20.149430 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:48:20.149596 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:48:20.149724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:21.924961 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.775 seconds
[0m13:48:21.928687 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:48:22.536344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:48:22.550037 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:48:22.550476 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:48:22.550774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:24.065324 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.515 seconds
[0m13:48:24.070318 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:48:24.684291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdc3ed0>]}
[0m13:48:24.685022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:24.685425 [info ] [MainThread]: 
[0m13:48:24.688865 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:48:24.689450 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:48:24.689927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:48:24.690407 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:48:24.697602 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:48:24.699828 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:48:24.719485 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:48:24.720521 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:48:24.720778 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:48:24.721004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:26.828419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.108 seconds
[0m13:48:26.856427 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:48:27.449073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed89b10>]}
[0m13:48:27.450351 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.76s]
[0m13:48:27.451115 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:48:27.451728 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:48:27.452623 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:48:27.453216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:48:27.453723 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:48:27.456159 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:48:27.458619 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:48:27.462269 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:48:27.463902 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:48:27.464337 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:48:27.464738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:29.433178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.969 seconds
[0m13:48:29.440173 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:48:30.109598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098530d0>]}
[0m13:48:30.111263 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.66s]
[0m13:48:30.112106 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:48:30.112718 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:48:30.113397 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:48:30.113929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:48:30.114319 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:48:30.117246 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:48:30.118343 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:48:30.122549 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:48:30.123674 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:48:30.124312 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:48:30.124876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:31.842137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.718 seconds
[0m13:48:31.846916 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:48:32.462426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5ac10>]}
[0m13:48:32.463896 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m13:48:32.464613 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:48:32.465339 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:48:32.466226 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:48:32.466854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:48:32.467282 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:48:32.470159 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:48:32.470895 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:48:32.474093 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:48:32.475366 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:48:32.475758 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:48:32.476114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:34.375337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.900 seconds
[0m13:48:34.380208 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:48:35.016644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a68190>]}
[0m13:48:35.018200 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.55s]
[0m13:48:35.019004 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:48:35.019573 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:48:35.020311 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:48:35.020978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:48:35.021436 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:48:35.023942 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:48:35.024717 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:48:35.029620 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:48:35.030873 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:48:35.031212 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:48:35.031559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:36.890195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.859 seconds
[0m13:48:36.895466 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:48:37.477892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c96e50>]}
[0m13:48:37.479586 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.46s]
[0m13:48:37.480484 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:48:37.481102 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:48:37.481989 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:48:37.482597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:48:37.483040 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:48:37.487511 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:48:37.489923 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:48:37.493795 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:48:37.494942 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:48:37.495339 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:48:37.495778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:39.199528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.703 seconds
[0m13:48:39.213028 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:48:39.779765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3c790>]}
[0m13:48:39.781425 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.30s]
[0m13:48:39.782302 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:48:39.782954 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:48:39.783763 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:48:39.784394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:48:39.784911 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:48:39.789676 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:48:39.790822 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:48:39.806785 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:48:39.810771 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:48:39.812224 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:48:39.815337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:41.563003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m13:48:41.571551 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:48:42.117891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ac950>]}
[0m13:48:42.118968 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.33s]
[0m13:48:42.119787 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:48:42.120512 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:48:42.121288 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:48:42.121923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:48:42.122416 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:48:42.132288 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:48:42.133148 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:48:42.161878 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:48:42.162265 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID as game_game_id,  -- Renaming for clarity
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.GAME_ID as details_game_id,  -- Explicit distinction
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    game_game_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  -- Assuming GAME_DATE_EST is a date or timestamp column that represents new data entries
  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:48:42.162587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:44.173883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.011 seconds
[0m13:48:44.187719 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:48:44.187991 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:48:44.498533 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.310 seconds
[0m13:48:44.501562 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:48:44.501803 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:48:44.784389 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.282 seconds
[0m13:48:44.798335 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:48:44.798834 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:48:45.150074 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.351 seconds
[0m13:48:45.183077 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:48:45.184524 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:48:45.184727 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:48:45.496539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m13:48:45.497487 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:48:45.498199 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:48:45.855726 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860e8-0102-3227-0006-c35e00047556
[0m13:48:45.856296 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m13:48:45.856917 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:48:46.458544 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:48:46.459417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109865a50>]}
[0m13:48:46.463382 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.34s]
[0m13:48:46.463748 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:48:46.464011 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:48:46.465559 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:48:46.465814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:48:46.465990 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:48:46.467826 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:48:46.479589 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:48:46.486982 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:48:46.489775 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:48:46.490007 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:48:46.490338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:48.345317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.855 seconds
[0m13:48:48.351792 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:48:48.900327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813aa948-49cc-4d5a-82e7-fa6670aa60f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197ccdd0>]}
[0m13:48:48.902253 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.43s]
[0m13:48:48.903071 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:48:48.903454 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:48:48.903866 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:48:48.904126 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:48:48.907482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:48.907669 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:48:48.907971 [info ] [MainThread]: 
[0m13:48:48.908167 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.77 seconds (28.77s).
[0m13:48:48.909486 [debug] [MainThread]: Command end result
[0m13:48:48.942616 [info ] [MainThread]: 
[0m13:48:48.942962 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:48:48.943170 [info ] [MainThread]: 
[0m13:48:48.944491 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:48:48.945801 [info ] [MainThread]: 
[0m13:48:48.947866 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:48:48.995485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.572012, "process_user_time": 2.070132, "process_kernel_time": 0.378828, "process_mem_max_rss": "200081408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:48:48.999488 [debug] [MainThread]: Command `dbt run` failed at 13:48:48.999418 after 29.58 seconds
[0m13:48:48.999802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053455d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105344d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107418710>]}
[0m13:48:49.000029 [debug] [MainThread]: Flushing usage events
[0m13:50:27.972829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c52f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc3bd0>]}


============================== 13:50:27.975664 | e6e5cadd-23dd-490e-b07a-b4c1d82d3389 ==============================
[0m13:50:27.975664 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:50:27.975983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:50:28.504063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae7e6d0>]}
[0m13:50:28.524344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104445d10>]}
[0m13:50:28.524893 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:50:28.586794 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:50:28.620395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:28.620600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:28.631238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6f0050>]}
[0m13:50:28.677464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e468ed0>]}
[0m13:50:28.677715 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:50:28.677883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f29d0>]}
[0m13:50:28.678994 [info ] [MainThread]: 
[0m13:50:28.679260 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:50:28.681227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:50:28.704280 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:50:28.704452 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:50:28.704594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:30.325606 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.621 seconds
[0m13:50:30.329743 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:50:30.899969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:50:30.910449 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:50:30.910771 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:50:30.910970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:32.585185 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.674 seconds
[0m13:50:32.589777 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:50:33.188351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109346150>]}
[0m13:50:33.190116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:33.190664 [info ] [MainThread]: 
[0m13:50:33.194372 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:50:33.195064 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:50:33.195635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:50:33.196175 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:50:33.203939 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:50:33.205742 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:50:33.227017 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:50:33.227975 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:50:33.228230 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:50:33.228459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:35.327724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.099 seconds
[0m13:50:35.346945 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:50:35.900800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6cc8d0>]}
[0m13:50:35.901619 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.70s]
[0m13:50:35.902228 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:50:35.902660 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:50:35.903313 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:50:35.903844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:50:35.904194 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:50:35.906228 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:50:35.908786 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:50:35.911945 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:50:35.913343 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:50:35.913728 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:50:35.914098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:37.995481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.081 seconds
[0m13:50:38.001246 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:50:38.615658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fabe290>]}
[0m13:50:38.618949 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.71s]
[0m13:50:38.624005 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:50:38.627599 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:50:38.630245 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:50:38.639242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:50:38.639930 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:50:38.645760 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:50:38.647535 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:50:38.652656 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:50:38.653750 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:50:38.654121 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:50:38.654547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:40.273181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.618 seconds
[0m13:50:40.278174 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:50:40.866451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f88c890>]}
[0m13:50:40.868434 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.24s]
[0m13:50:40.870957 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:50:40.871979 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:50:40.874062 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:50:40.874836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:50:40.875427 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:50:40.877213 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:50:40.877730 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:50:40.888390 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:50:40.889258 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:50:40.889487 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:50:40.890136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:42.704655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m13:50:42.706411 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:50:43.290547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441ab10>]}
[0m13:50:43.292482 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.42s]
[0m13:50:43.293478 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:50:43.294160 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:50:43.294914 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:50:43.295556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:50:43.296012 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:50:43.299826 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:50:43.300970 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:50:43.307256 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:50:43.308757 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:50:43.309185 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:50:43.309571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:45.318784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.008 seconds
[0m13:50:45.327630 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:50:45.949599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104300e10>]}
[0m13:50:45.951568 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.65s]
[0m13:50:45.953326 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:50:45.954282 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:50:45.955645 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:50:45.956307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:50:45.956748 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:50:45.964079 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:50:45.966120 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:50:45.969720 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:50:45.971226 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:50:45.971792 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:50:45.972208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:47.709964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.738 seconds
[0m13:50:47.711976 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:50:48.258308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049957d0>]}
[0m13:50:48.259383 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.30s]
[0m13:50:48.260092 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:50:48.260606 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:50:48.261305 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:50:48.261889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:50:48.262399 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:50:48.266722 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:50:48.268089 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:50:48.270413 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:50:48.271027 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:50:48.271213 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:50:48.271396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:49.885227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.613 seconds
[0m13:50:49.891347 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:50:50.486936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e494ed0>]}
[0m13:50:50.488873 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.22s]
[0m13:50:50.489846 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:50:50.490514 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:50:50.491392 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:50:50.492078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:50:50.492545 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:50:50.506293 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:50:50.508304 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:50:50.534794 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:50:50.535131 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID as game_game_id,  -- Renaming for clarity
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.GAME_ID as details_game_id,  -- Explicit distinction
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    game_game_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  -- Assuming GAME_DATE_EST is a date or timestamp column that represents new data entries
  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:50:50.535397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:52.623083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.087 seconds
[0m13:50:52.639668 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:50:52.640442 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:50:52.942506 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.301 seconds
[0m13:50:52.950240 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:50:52.950911 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:50:53.251563 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.300 seconds
[0m13:50:53.264419 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:50:53.264829 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:50:53.557676 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.292 seconds
[0m13:50:53.600936 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:50:53.603007 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:50:53.603325 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:50:53.919912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m13:50:53.920985 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:50:53.921671 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(game_game_id, PLAYER_ID) = DBT_INTERNAL_DEST.concat(game_game_id, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:50:54.328849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860ea-0102-31cd-0006-c35e0004453e
[0m13:50:54.329537 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m13:50:54.330255 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:50:54.873769 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:50:54.875404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dbc50>]}
[0m13:50:54.876943 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.38s]
[0m13:50:54.878267 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:50:54.878965 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:50:54.880947 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:50:54.881800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:50:54.882353 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:50:54.886886 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:50:54.887990 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:50:54.891609 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:50:54.893272 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:50:54.893639 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:50:54.893976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:56.702379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.808 seconds
[0m13:50:56.708163 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:50:57.353781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e5cadd-23dd-490e-b07a-b4c1d82d3389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e741fd0>]}
[0m13:50:57.356566 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.47s]
[0m13:50:57.357747 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:50:57.358545 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:50:57.359643 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:50:57.360332 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:50:57.362539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:57.362934 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:50:57.363537 [info ] [MainThread]: 
[0m13:50:57.363951 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.68 seconds (28.68s).
[0m13:50:57.366385 [debug] [MainThread]: Command end result
[0m13:50:57.412909 [info ] [MainThread]: 
[0m13:50:57.413284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:50:57.413474 [info ] [MainThread]: 
[0m13:50:57.413706 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:50:57.413887 [info ] [MainThread]: 
[0m13:50:57.414081 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:50:57.417106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.476469, "process_user_time": 2.184924, "process_kernel_time": 0.464094, "process_mem_max_rss": "184647680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:50:57.417695 [debug] [MainThread]: Command `dbt run` failed at 13:50:57.417630 after 29.48 seconds
[0m13:50:57.418028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009815d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100980d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102718950>]}
[0m13:50:57.418493 [debug] [MainThread]: Flushing usage events
[0m13:51:30.423236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ef990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081eff90>]}


============================== 13:51:30.425842 | cdbe7dc8-9bed-4029-ab88-6a5fd15baa61 ==============================
[0m13:51:30.425842 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:51:30.426140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:30.972056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fee90>]}
[0m13:51:30.990897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c31c50>]}
[0m13:51:30.991445 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:51:31.050792 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:51:31.083054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:31.083253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:31.093464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817b650>]}
[0m13:51:31.130882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11942c590>]}
[0m13:51:31.131127 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:51:31.131295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119231090>]}
[0m13:51:31.132435 [info ] [MainThread]: 
[0m13:51:31.132705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:51:31.134917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:51:31.145853 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:51:31.146080 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:51:31.146229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:32.996066 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.849 seconds
[0m13:51:32.999622 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:51:33.606908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:51:33.617836 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:51:33.618241 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:51:33.618542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:35.924398 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.305 seconds
[0m13:51:35.927853 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:51:36.781152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192f70d0>]}
[0m13:51:36.782626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:36.783118 [info ] [MainThread]: 
[0m13:51:36.786898 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:51:36.787700 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:51:36.788347 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m13:51:36.789277 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:51:36.796925 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:51:36.798202 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:51:36.821048 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:51:36.822188 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:51:36.822484 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:51:36.822735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:39.046601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.223 seconds
[0m13:51:39.078025 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:51:39.636999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11961a8d0>]}
[0m13:51:39.639347 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.85s]
[0m13:51:39.640410 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:51:39.641064 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:51:39.642324 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:51:39.642972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:51:39.643408 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:51:39.646850 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:51:39.648755 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:51:39.653047 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:51:39.654676 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:51:39.655094 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:51:39.655496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:41.584626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.929 seconds
[0m13:51:41.589741 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:51:42.177019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119520490>]}
[0m13:51:42.179153 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.53s]
[0m13:51:42.180014 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:51:42.180618 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:51:42.181295 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:51:42.181837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:51:42.182242 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:51:42.185450 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:51:42.186881 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:51:42.191624 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:51:42.192738 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:51:42.193123 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:51:42.193490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:43.839171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.645 seconds
[0m13:51:43.844250 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:51:44.397372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e57250>]}
[0m13:51:44.398957 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.22s]
[0m13:51:44.399885 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:51:44.400624 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:51:44.401589 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:51:44.402316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:51:44.402833 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:51:44.405757 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:51:44.406590 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:51:44.410338 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:51:44.411700 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:51:44.412127 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:51:44.412565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:46.092023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.679 seconds
[0m13:51:46.098043 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:51:46.633225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a1d10>]}
[0m13:51:46.634614 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.23s]
[0m13:51:46.635438 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:51:46.636158 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:51:46.636873 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:51:46.637536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:51:46.637970 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:51:46.640599 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:51:46.641612 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:51:46.646802 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:51:46.648230 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:51:46.648638 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:51:46.649026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:48.652780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.003 seconds
[0m13:51:48.658332 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:51:49.247511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b15d0>]}
[0m13:51:49.249041 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.61s]
[0m13:51:49.250057 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:51:49.250820 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:51:49.251736 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:51:49.252343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:51:49.252794 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:51:49.258486 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:51:49.261150 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:51:49.264252 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:51:49.265267 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:51:49.265804 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:51:49.266143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:50.985343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.718 seconds
[0m13:51:50.990791 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:51:51.726200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11955ff90>]}
[0m13:51:51.727779 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.47s]
[0m13:51:51.728742 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:51:51.729446 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:51:51.730312 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:51:51.730960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:51:51.731431 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:51:51.737680 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:51:51.738754 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:51:51.742567 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:51:51.743650 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:51:51.744045 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:51:51.744401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:53.772808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.028 seconds
[0m13:51:53.777505 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:51:54.365145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689ab50>]}
[0m13:51:54.366235 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.63s]
[0m13:51:54.366968 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:51:54.367484 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:51:54.368197 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:51:54.368863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:51:54.369255 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:51:54.380138 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:51:54.381630 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:51:54.404335 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:51:54.404676 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_ID as game_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.GAME_ID as details_game_id,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    game_game_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:51:54.405017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:56.484433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.079 seconds
[0m13:51:56.499612 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:51:56.500158 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:51:56.791337 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.290 seconds
[0m13:51:56.800112 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:51:56.800722 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:51:57.150509 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.349 seconds
[0m13:51:57.164158 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:51:57.164516 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:51:57.458130 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.293 seconds
[0m13:51:57.496964 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:51:57.499831 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:51:57.500105 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:51:57.816155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m13:51:57.817068 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:51:57.817812 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(game_game_id, PLAYER_ID) = DBT_INTERNAL_DEST.concat(game_game_id, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:51:58.154671 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860eb-0102-32a8-0006-c35e000482de
[0m13:51:58.155242 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m13:51:58.155885 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:51:58.708446 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:51:58.709148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192043d0>]}
[0m13:51:58.710056 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.34s]
[0m13:51:58.710773 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:51:58.711270 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:51:58.713000 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:51:58.713521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:51:58.713956 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:51:58.717385 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:51:58.718474 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:51:58.721446 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:51:58.722925 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:51:58.723290 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:51:58.723617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:00.632731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.909 seconds
[0m13:52:00.637695 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:52:01.252303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdbe7dc8-9bed-4029-ab88-6a5fd15baa61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d7ffd0>]}
[0m13:52:01.254067 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.54s]
[0m13:52:01.255065 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:52:01.255746 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:52:01.256377 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:52:01.256879 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:52:01.258896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:01.259241 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m13:52:01.259509 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:52:01.260249 [info ] [MainThread]: 
[0m13:52:01.260913 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 30.13 seconds (30.13s).
[0m13:52:01.263072 [debug] [MainThread]: Command end result
[0m13:52:01.297117 [info ] [MainThread]: 
[0m13:52:01.297414 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:52:01.297608 [info ] [MainThread]: 
[0m13:52:01.297839 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:52:01.298027 [info ] [MainThread]: 
[0m13:52:01.298219 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:52:01.301720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 30.908121, "process_user_time": 2.234898, "process_kernel_time": 0.363766, "process_mem_max_rss": "189792256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:01.302109 [debug] [MainThread]: Command `dbt run` failed at 13:52:01.302061 after 30.91 seconds
[0m13:52:01.302388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e19e90>]}
[0m13:52:01.302608 [debug] [MainThread]: Flushing usage events
[0m13:53:51.134460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110752950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c3fd0>]}


============================== 13:53:51.137279 | 9a775d76-4b4b-440e-9ea4-c303ae39c265 ==============================
[0m13:53:51.137279 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:53:51.137618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:51.658076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107abe90>]}
[0m13:53:51.676850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f45dd0>]}
[0m13:53:51.677350 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:53:51.736824 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:53:51.771234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:51.771433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:51.781819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a9d50>]}
[0m13:53:51.820204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120631e90>]}
[0m13:53:51.820464 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:53:51.820626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120566a90>]}
[0m13:53:51.821727 [info ] [MainThread]: 
[0m13:53:51.821990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:51.823891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:53:51.830451 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:53:51.830615 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:53:51.830747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:53.582371 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.751 seconds
[0m13:53:53.585834 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:53:54.139997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:53:54.147491 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:53:54.147795 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:53:54.148008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:55.729642 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.581 seconds
[0m13:53:55.735334 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:53:56.354862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12026d490>]}
[0m13:53:56.356149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:56.356692 [info ] [MainThread]: 
[0m13:53:56.360414 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:53:56.361208 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:53:56.361831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:53:56.362519 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:53:56.371014 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:53:56.372441 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:53:56.394730 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:53:56.395684 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:53:56.395962 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:53:56.396342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:58.289661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.893 seconds
[0m13:53:58.317267 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:53:58.912236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212d9e10>]}
[0m13:53:58.913654 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.55s]
[0m13:53:58.914517 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:53:58.915143 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:53:58.916045 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:53:58.916694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:53:58.917086 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:53:58.920276 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:53:58.922907 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:53:58.927021 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:53:58.928577 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:53:58.929007 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:53:58.929393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:00.953870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.024 seconds
[0m13:54:00.959220 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:54:01.529354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121326f90>]}
[0m13:54:01.530916 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.61s]
[0m13:54:01.531940 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:54:01.532653 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:54:01.533460 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:54:01.534122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:54:01.534585 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:54:01.538574 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:54:01.540861 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:54:01.546019 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:54:01.547265 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:54:01.547670 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:54:01.548031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:03.330130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.782 seconds
[0m13:54:03.335436 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:54:03.927888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107aa290>]}
[0m13:54:03.929634 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.39s]
[0m13:54:03.930562 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:54:03.931192 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:54:03.932110 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:54:03.932708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:54:03.933127 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:54:03.936592 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:54:03.938109 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:54:03.941737 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:54:03.943168 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:54:03.943564 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:54:03.943920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:05.867741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m13:54:05.873535 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:54:06.456614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120716790>]}
[0m13:54:06.457741 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.52s]
[0m13:54:06.458565 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:54:06.459154 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:54:06.460041 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:54:06.460695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:54:06.461182 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:54:06.464037 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:54:06.465744 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:54:06.471450 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:54:06.472669 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:54:06.472936 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:54:06.473173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:08.325458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.852 seconds
[0m13:54:08.330034 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:54:08.900644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120603f10>]}
[0m13:54:08.901571 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.44s]
[0m13:54:08.902263 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:54:08.902760 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:54:08.903488 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:54:08.904243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:54:08.904655 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:54:08.908931 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:54:08.911517 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:54:08.914740 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:54:08.915840 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:54:08.916157 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:54:08.916446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:10.663915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m13:54:10.669545 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:54:11.326263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121379d90>]}
[0m13:54:11.328321 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.42s]
[0m13:54:11.329232 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:54:11.329889 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:54:11.330592 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:54:11.331194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:54:11.331626 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:54:11.337023 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:54:11.338094 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:54:11.341934 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:54:11.343243 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:54:11.343671 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:54:11.344049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:13.038492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.694 seconds
[0m13:54:13.043520 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:54:13.654108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167ba450>]}
[0m13:54:13.655786 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.32s]
[0m13:54:13.656729 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:54:13.657465 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:54:13.658227 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:54:13.658882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:54:13.659401 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:54:13.673067 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:54:13.674445 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:54:13.699589 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:54:13.699937 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.game_id as game_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_id as details_game_id,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.game_id = g.game_id
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    game_game_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:54:13.700255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:15.800917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.100 seconds
[0m13:54:15.815234 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:54:15.815737 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:54:16.118439 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.302 seconds
[0m13:54:16.125980 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:54:16.126478 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:54:16.419961 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.293 seconds
[0m13:54:16.431716 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:54:16.432140 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:54:16.721248 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.289 seconds
[0m13:54:16.759486 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:54:16.761525 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:54:16.761811 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:54:17.085814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m13:54:17.087286 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:54:17.088673 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(game_game_id, PLAYER_ID) = DBT_INTERNAL_DEST.concat(game_game_id, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:54:17.452829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860ee-0102-31cd-0006-c35e00044572
[0m13:54:17.453378 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m13:54:17.454021 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:54:18.064360 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:54:18.065538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11057a910>]}
[0m13:54:18.066572 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.41s]
[0m13:54:18.067334 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:54:18.067850 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:54:18.069658 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:54:18.070397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:54:18.070823 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:54:18.074688 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:54:18.075824 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:54:18.079093 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:54:18.080520 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:54:18.080880 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:54:18.081231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:19.915825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.834 seconds
[0m13:54:19.920976 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:54:20.495034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a775d76-4b4b-440e-9ea4-c303ae39c265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c2bd0>]}
[0m13:54:20.496919 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.42s]
[0m13:54:20.497951 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:54:20.498631 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:54:20.499309 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:54:20.499884 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:54:20.502039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:20.502603 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:54:20.503268 [info ] [MainThread]: 
[0m13:54:20.503728 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.68 seconds (28.68s).
[0m13:54:20.505712 [debug] [MainThread]: Command end result
[0m13:54:20.540618 [info ] [MainThread]: 
[0m13:54:20.540908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:54:20.541089 [info ] [MainThread]: 
[0m13:54:20.541322 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:54:20.541513 [info ] [MainThread]: 
[0m13:54:20.541733 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:54:20.544061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.438187, "process_user_time": 2.21329, "process_kernel_time": 0.346583, "process_mem_max_rss": "190070784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:20.544509 [debug] [MainThread]: Command `dbt run` failed at 13:54:20.544455 after 29.44 seconds
[0m13:54:20.544853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107535d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eb1950>]}
[0m13:54:20.545069 [debug] [MainThread]: Flushing usage events
[0m13:54:35.353221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107272790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bfbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572dc90>]}


============================== 13:54:35.355768 | fd9536e4-d388-4576-b47c-0d14c686a4c9 ==============================
[0m13:54:35.355768 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:54:35.356072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:35.863887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a7de10>]}
[0m13:54:35.882603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105445cd0>]}
[0m13:54:35.883124 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:54:35.943000 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:54:35.975613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:35.975801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:35.986071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127056ad0>]}
[0m13:54:36.024583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f2c910>]}
[0m13:54:36.024836 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:54:36.025008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af9c50>]}
[0m13:54:36.026102 [info ] [MainThread]: 
[0m13:54:36.026364 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:54:36.028275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:54:36.035053 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:54:36.035229 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:54:36.035373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:37.725670 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.690 seconds
[0m13:54:37.729434 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:54:38.319202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:54:38.336815 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:54:38.337336 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:54:38.337552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:39.890526 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.553 seconds
[0m13:54:39.895424 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:54:40.489237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af9c50>]}
[0m13:54:40.490014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:40.490391 [info ] [MainThread]: 
[0m13:54:40.493093 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:54:40.493701 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:54:40.494208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:54:40.494531 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:54:40.500825 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:54:40.502127 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:54:40.522533 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:54:40.523527 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:54:40.523791 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:54:40.524020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:42.254679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.730 seconds
[0m13:54:42.284239 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:54:42.825453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103609ad0>]}
[0m13:54:42.826398 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.33s]
[0m13:54:42.827122 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:54:42.827655 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:54:42.828409 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:54:42.828917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:54:42.829289 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:54:42.831363 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:54:42.834140 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:54:42.837306 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:54:42.838922 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:54:42.839448 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:54:42.839817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:44.919150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.079 seconds
[0m13:54:44.925147 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:54:45.462704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c55190>]}
[0m13:54:45.464291 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.63s]
[0m13:54:45.465251 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:54:45.465814 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:54:45.466542 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:54:45.467240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:54:45.467703 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:54:45.470343 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:54:45.471194 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:54:45.474824 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:54:45.475882 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:54:45.476261 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:54:45.476609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:47.146847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.670 seconds
[0m13:54:47.151771 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:54:47.696174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af8a90>]}
[0m13:54:47.698128 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.23s]
[0m13:54:47.698990 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:54:47.699604 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:54:47.700597 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:54:47.701290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:54:47.701981 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:54:47.705181 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:54:47.706204 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:54:47.709637 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:54:47.710971 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:54:47.711365 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:54:47.712361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:49.593329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.881 seconds
[0m13:54:49.599577 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:54:50.202716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102236b90>]}
[0m13:54:50.203459 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.50s]
[0m13:54:50.203976 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:54:50.204339 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:54:50.204813 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:54:50.205288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:54:50.205599 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:54:50.207308 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:54:50.207897 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:54:50.211561 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:54:50.212669 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:54:50.213024 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:54:50.213357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:52.152297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.938 seconds
[0m13:54:52.157196 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:54:52.733920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264baf50>]}
[0m13:54:52.735632 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.53s]
[0m13:54:52.736488 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:54:52.737131 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:54:52.738007 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:54:52.738555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:54:52.738946 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:54:52.744095 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:54:52.746473 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:54:52.750290 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:54:52.751478 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:54:52.751879 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:54:52.752256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:54.505716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.753 seconds
[0m13:54:54.510591 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:54:55.064079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a6c50>]}
[0m13:54:55.065108 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.33s]
[0m13:54:55.065825 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:54:55.066354 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:54:55.066903 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:54:55.067432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:54:55.067804 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:54:55.071226 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:54:55.073211 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:54:55.076409 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:54:55.077313 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:54:55.077643 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:54:55.078155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:57.075638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.997 seconds
[0m13:54:57.080511 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:54:57.694070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c07f90>]}
[0m13:54:57.695173 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.63s]
[0m13:54:57.695921 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:54:57.696443 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:54:57.697081 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:54:57.697629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:54:57.698023 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:54:57.710307 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:54:57.712273 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:54:57.737527 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:54:57.737898 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.game_id as game_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.game_id = g.game_id
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    player_team_id,
    game_game_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:54:57.738210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:00.239148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.501 seconds
[0m13:55:00.246354 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:55:00.246712 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:55:00.568662 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.321 seconds
[0m13:55:00.576878 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:55:00.577425 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:55:00.872120 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.294 seconds
[0m13:55:00.887070 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:55:00.887608 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:55:01.209551 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.321 seconds
[0m13:55:01.251267 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:55:01.253390 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:55:01.253648 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:55:01.576765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.322 seconds
[0m13:55:01.578359 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:55:01.579028 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(g.game_game_id, PLAYER_ID) = DBT_INTERNAL_DEST.concat(g.game_game_id, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:55:01.965202 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860ef-0102-32a8-0006-c35e00048302
[0m13:55:01.965815 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m13:55:01.966403 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:55:02.603300 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:55:02.604167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274af410>]}
[0m13:55:02.604974 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.91s]
[0m13:55:02.605576 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:55:02.605989 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:55:02.607599 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:55:02.608147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:55:02.608494 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:55:02.611999 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:55:02.613196 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:55:02.615967 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:55:02.617727 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:55:02.618138 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:55:02.618528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:04.543779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.925 seconds
[0m13:55:04.549506 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:55:05.155776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9536e4-d388-4576-b47c-0d14c686a4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e9f50>]}
[0m13:55:05.156269 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.55s]
[0m13:55:05.156626 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:55:05.156874 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:55:05.157178 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:55:05.157459 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:55:05.158281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:05.158452 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:55:05.158677 [info ] [MainThread]: 
[0m13:55:05.158863 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 29.13 seconds (29.13s).
[0m13:55:05.159652 [debug] [MainThread]: Command end result
[0m13:55:05.182302 [info ] [MainThread]: 
[0m13:55:05.182545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:55:05.182703 [info ] [MainThread]: 
[0m13:55:05.182890 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:55:05.183043 [info ] [MainThread]: 
[0m13:55:05.183201 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:55:05.186341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.860722, "process_user_time": 2.227831, "process_kernel_time": 0.33658, "process_mem_max_rss": "197623808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:05.186638 [debug] [MainThread]: Command `dbt run` failed at 13:55:05.186602 after 29.86 seconds
[0m13:55:05.186876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104194f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c6f550>]}
[0m13:55:05.187029 [debug] [MainThread]: Flushing usage events
[0m13:56:05.996321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a9d10>]}


============================== 13:56:05.999108 | 8dfa6d48-8ced-4a73-8541-fa0ae197f747 ==============================
[0m13:56:05.999108 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:56:05.999427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:56:06.540998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12027e050>]}
[0m13:56:06.560038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a45cd0>]}
[0m13:56:06.560580 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:56:06.623514 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:56:06.656855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:06.657061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:06.667445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12093afd0>]}
[0m13:56:06.708816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208e74d0>]}
[0m13:56:06.709239 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:56:06.709410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120864210>]}
[0m13:56:06.710630 [info ] [MainThread]: 
[0m13:56:06.710917 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:56:06.712945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:56:06.719504 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:56:06.719696 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:56:06.719821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:08.548252 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.828 seconds
[0m13:56:08.551670 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:56:09.093331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:56:09.103973 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:56:09.104463 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:56:09.104787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:10.607045 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.502 seconds
[0m13:56:10.608596 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:56:11.215942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541bcd0>]}
[0m13:56:11.221874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:11.223031 [info ] [MainThread]: 
[0m13:56:11.231665 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:56:11.232563 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:56:11.233326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:56:11.233857 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:56:11.242440 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:56:11.243821 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:56:11.264914 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:56:11.265987 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:56:11.266253 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:56:11.266480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:13.080244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.813 seconds
[0m13:56:13.109973 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:56:13.652471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110059550>]}
[0m13:56:13.653761 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.42s]
[0m13:56:13.654516 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:56:13.655063 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:56:13.655957 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:56:13.656728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:56:13.657188 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:56:13.659658 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:56:13.662334 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:56:13.665664 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:56:13.666951 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:56:13.667304 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:56:13.667865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:15.690740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.022 seconds
[0m13:56:15.697335 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:56:16.330206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107800cd0>]}
[0m13:56:16.332724 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.67s]
[0m13:56:16.333899 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:56:16.334818 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:56:16.336003 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:56:16.337015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:56:16.337538 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:56:16.342205 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:56:16.344558 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:56:16.349585 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:56:16.350744 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:56:16.351089 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:56:16.351412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:18.792988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.441 seconds
[0m13:56:18.797191 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:56:19.347645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110000310>]}
[0m13:56:19.349279 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 3.01s]
[0m13:56:19.350261 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:56:19.351017 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:56:19.352342 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:56:19.352988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:56:19.353400 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:56:19.357794 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:56:19.359079 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:56:19.362783 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:56:19.364074 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:56:19.364493 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:56:19.364911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:22.246055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.881 seconds
[0m13:56:22.250625 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:56:23.089245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209563d0>]}
[0m13:56:23.090825 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 3.74s]
[0m13:56:23.091628 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:56:23.092216 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:56:23.093046 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:56:23.094168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:56:23.094727 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:56:23.098836 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:56:23.099751 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:56:23.105959 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:56:23.107524 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:56:23.107969 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:56:23.108374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:24.922366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m13:56:24.925702 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:56:25.480455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733cf10>]}
[0m13:56:25.493175 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.39s]
[0m13:56:25.494395 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:56:25.494922 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:56:25.495392 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:56:25.495695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:56:25.495922 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:56:25.498179 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:56:25.498953 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:56:25.509894 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:56:25.511163 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:56:25.511517 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:56:25.511773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:27.139849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.628 seconds
[0m13:56:27.144270 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:56:27.798843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120eab310>]}
[0m13:56:27.800785 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.30s]
[0m13:56:27.801817 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:56:27.802539 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:56:27.803432 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:56:27.804136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:56:27.804576 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:56:27.810065 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:56:27.812323 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:56:27.816279 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:56:27.817688 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:56:27.818099 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:56:27.818455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:29.530220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.711 seconds
[0m13:56:29.534935 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:56:30.152752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206544d0>]}
[0m13:56:30.154643 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.35s]
[0m13:56:30.155690 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:56:30.156410 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:56:30.157245 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:56:30.157905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:56:30.158390 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:56:30.172507 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:56:30.174972 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:56:30.199731 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:56:30.200077 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        g.GAME_ID as GAME_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.game_id = g.game_id
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:56:30.200356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:32.142328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.942 seconds
[0m13:56:32.151091 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:56:32.151481 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:56:32.448035 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.296 seconds
[0m13:56:32.458118 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:56:32.458939 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:56:32.811136 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.351 seconds
[0m13:56:32.826707 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:56:32.827255 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:56:33.126736 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.299 seconds
[0m13:56:33.166010 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:56:33.168419 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:56:33.168705 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:56:33.487122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m13:56:33.488535 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:56:33.489359 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:56:33.851025 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860f0-0102-31cd-0006-c35e000445a2
[0m13:56:33.851723 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_ID'
[0m13:56:33.852396 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:56:34.459636 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:56:34.460559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120629bd0>]}
[0m13:56:34.461399 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.30s]
[0m13:56:34.462112 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:56:34.462599 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:56:34.464130 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:56:34.464732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:56:34.465172 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:56:34.468789 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:56:34.470029 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:56:34.473278 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:56:34.474770 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:56:34.475123 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:56:34.475658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:36.221190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.745 seconds
[0m13:56:36.226218 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:56:36.775935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfa6d48-8ced-4a73-8541-fa0ae197f747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120994650>]}
[0m13:56:36.777782 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.31s]
[0m13:56:36.778645 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:56:36.779415 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:56:36.780064 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:56:36.780582 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:56:36.782855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:36.783412 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:56:36.784093 [info ] [MainThread]: 
[0m13:56:36.784723 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 30.07 seconds (30.07s).
[0m13:56:36.786733 [debug] [MainThread]: Command end result
[0m13:56:36.822602 [info ] [MainThread]: 
[0m13:56:36.822945 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:36.823139 [info ] [MainThread]: 
[0m13:56:36.823365 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:56:36.823564 [info ] [MainThread]: 
[0m13:56:36.823773 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:56:36.827417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 30.860512, "process_user_time": 2.14142, "process_kernel_time": 0.423634, "process_mem_max_rss": "188940288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:36.827785 [debug] [MainThread]: Command `dbt run` failed at 13:56:36.827740 after 30.86 seconds
[0m13:56:36.828067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110165850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10329d5d0>]}
[0m13:56:36.828262 [debug] [MainThread]: Flushing usage events
[0m13:57:04.568768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eea8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4ffd0>]}


============================== 13:57:04.571433 | e0b55fb6-4d28-4598-ac96-afa4abfabe6f ==============================
[0m13:57:04.571433 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:57:04.571744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:57:05.083437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e4b10>]}
[0m13:57:05.102178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a1d50>]}
[0m13:57:05.102726 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:57:05.162087 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:57:05.194568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:05.194765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:05.205013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6824d0>]}
[0m13:57:05.243057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e558590>]}
[0m13:57:05.243302 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:57:05.243466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b57d0>]}
[0m13:57:05.244588 [info ] [MainThread]: 
[0m13:57:05.244862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:57:05.246798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:57:05.253491 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:57:05.253675 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:57:05.253823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:07.040561 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.786 seconds
[0m13:57:07.043618 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:57:07.609178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:57:07.622493 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:57:07.622929 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:57:07.623240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:09.311546 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.688 seconds
[0m13:57:09.313298 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:57:09.876600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107367d10>]}
[0m13:57:09.877828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:09.878333 [info ] [MainThread]: 
[0m13:57:09.882561 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:57:09.883316 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:57:09.884164 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m13:57:09.884798 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:57:09.894174 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:57:09.895776 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:57:09.917264 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:57:09.918264 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:57:09.918546 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:57:09.918800 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:57:11.930191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.011 seconds
[0m13:57:11.958400 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:57:12.548599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f08d0>]}
[0m13:57:12.550002 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.66s]
[0m13:57:12.550806 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:57:12.551349 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:57:12.552246 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:57:12.553195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:57:12.553813 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:57:12.556614 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:57:12.559645 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:57:12.563874 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:57:12.565500 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:57:12.565936 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:57:12.566295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:14.387943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.821 seconds
[0m13:57:14.393164 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:57:14.978629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6ea90>]}
[0m13:57:14.981067 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.43s]
[0m13:57:14.981894 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:57:14.982435 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:57:14.983091 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:57:14.983747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:57:14.984187 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:57:14.986661 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:57:14.987673 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:57:14.991128 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:57:14.992182 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:57:14.992563 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:57:14.992913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:16.747808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.754 seconds
[0m13:57:16.752886 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:57:17.359813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837fb90>]}
[0m13:57:17.361618 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.38s]
[0m13:57:17.362684 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:57:17.363417 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:57:17.364459 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:57:17.365059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:57:17.365511 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:57:17.369873 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:57:17.371213 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:57:17.375512 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:57:17.376874 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:57:17.377279 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:57:17.377642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:19.162161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.784 seconds
[0m13:57:19.164466 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:57:19.816684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e55a7d0>]}
[0m13:57:19.818522 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.45s]
[0m13:57:19.819480 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:57:19.820242 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:57:19.821091 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:57:19.821759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:57:19.822206 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:57:19.826624 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:57:19.827752 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:57:19.833908 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:57:19.835317 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:57:19.835719 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:57:19.836106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:21.565696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.729 seconds
[0m13:57:21.571937 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:57:22.175978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b864d0>]}
[0m13:57:22.177863 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.35s]
[0m13:57:22.178848 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:57:22.179511 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:57:22.180409 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:57:22.181053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:57:22.181505 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:57:22.187187 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:57:22.190188 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:57:22.194336 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:57:22.195988 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:57:22.196409 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:57:22.196813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:23.874390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.677 seconds
[0m13:57:23.878888 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:57:24.486845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6886d0>]}
[0m13:57:24.488394 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.31s]
[0m13:57:24.489127 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:57:24.489807 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:57:24.490666 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:57:24.491330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:57:24.491785 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:57:24.495659 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:57:24.496436 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:57:24.499740 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:57:24.501146 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:57:24.501733 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:57:24.502127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:26.274452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.772 seconds
[0m13:57:26.279349 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:57:26.884458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bf810>]}
[0m13:57:26.885755 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.39s]
[0m13:57:26.886523 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:57:26.887063 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:57:26.887766 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:57:26.888408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:57:26.888850 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:57:26.899314 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:57:26.900345 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:57:26.923891 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:57:26.924256 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        g.GAME_ID as THE_GAME_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.game_id = g.game_id
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    THE_GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:57:26.924532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:29.031278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.106 seconds
[0m13:57:29.045805 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:57:29.046307 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:57:29.349759 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.303 seconds
[0m13:57:29.357211 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:57:29.357804 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:57:29.661979 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.303 seconds
[0m13:57:29.677684 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:57:29.678321 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:57:29.960937 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.282 seconds
[0m13:57:29.999182 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:57:30.002493 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:57:30.002782 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:57:30.321054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m13:57:30.322041 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:57:30.323086 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(THE_GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(THE_GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:57:30.705651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860f1-0102-32a8-0006-c35e0004832e
[0m13:57:30.706226 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m13:57:30.706901 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:57:31.395565 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:57:31.396747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f0cc10>]}
[0m13:57:31.397732 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.51s]
[0m13:57:31.398476 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:57:31.399088 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:57:31.400989 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:57:31.401731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:57:31.402179 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:57:31.405836 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:57:31.406847 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:57:31.410078 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:57:31.411456 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:57:31.411806 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:57:31.412134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:33.401475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.989 seconds
[0m13:57:33.406650 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:57:34.052436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b55fb6-4d28-4598-ac96-afa4abfabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690b590>]}
[0m13:57:34.053544 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.65s]
[0m13:57:34.054218 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:57:34.054730 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:57:34.055332 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:57:34.055911 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:57:34.057665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:34.058024 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m13:57:34.058327 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:57:34.058853 [info ] [MainThread]: 
[0m13:57:34.059260 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.81 seconds (28.81s).
[0m13:57:34.061067 [debug] [MainThread]: Command end result
[0m13:57:34.092879 [info ] [MainThread]: 
[0m13:57:34.093170 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:34.093351 [info ] [MainThread]: 
[0m13:57:34.093576 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:57:34.093778 [info ] [MainThread]: 
[0m13:57:34.093977 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:57:34.097615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.558363, "process_user_time": 2.250333, "process_kernel_time": 0.351442, "process_mem_max_rss": "194215936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:57:34.097969 [debug] [MainThread]: Command `dbt run` failed at 13:57:34.097927 after 29.56 seconds
[0m13:57:34.098241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e383790>]}
[0m13:57:34.098440 [debug] [MainThread]: Flushing usage events
[0m13:58:00.409020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cff90>]}


============================== 13:58:00.411630 | c0dc536e-3dd0-4846-9d6e-9c4e7791cd12 ==============================
[0m13:58:00.411630 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:58:00.411929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:00.942413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508e690>]}
[0m13:58:00.961010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b21e90>]}
[0m13:58:00.961530 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:58:01.020888 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:58:01.053361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:01.053545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:01.063690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252078d0>]}
[0m13:58:01.106758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251e34d0>]}
[0m13:58:01.106990 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:58:01.107572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125164250>]}
[0m13:58:01.108644 [info ] [MainThread]: 
[0m13:58:01.108916 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:58:01.110799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:58:01.117143 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:58:01.117333 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:58:01.117476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:02.823595 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.706 seconds
[0m13:58:02.826573 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:58:03.411844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:58:03.423389 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:58:03.423812 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:58:03.424110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:04.974749 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.550 seconds
[0m13:58:04.979438 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:58:05.593201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104546650>]}
[0m13:58:05.594544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:58:05.595160 [info ] [MainThread]: 
[0m13:58:05.599478 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:58:05.600288 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:58:05.600980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:58:05.601566 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:58:05.609896 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:58:05.611253 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:58:05.631903 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:58:05.632864 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:58:05.633150 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:58:05.633381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:07.523379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.889 seconds
[0m13:58:07.550889 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:58:08.152405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12791fc50>]}
[0m13:58:08.153938 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.55s]
[0m13:58:08.154862 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:58:08.155484 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:58:08.156343 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:58:08.156993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:58:08.157413 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:58:08.160596 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:58:08.163564 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:58:08.167703 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:58:08.169732 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:58:08.170289 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:58:08.170709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:10.092198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.921 seconds
[0m13:58:10.096317 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:58:10.672783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12792b410>]}
[0m13:58:10.673926 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.52s]
[0m13:58:10.674781 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:58:10.675390 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:58:10.676156 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:58:10.676736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:58:10.677102 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:58:10.679546 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:58:10.680321 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:58:10.682397 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:58:10.682960 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:58:10.683149 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:58:10.683315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:12.374809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.691 seconds
[0m13:58:12.379802 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:58:12.924372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103894390>]}
[0m13:58:12.926137 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.25s]
[0m13:58:12.927114 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:58:12.927789 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:58:12.928752 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:58:12.929366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:58:12.929790 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:58:12.933927 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:58:12.935059 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:58:12.938545 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:58:12.939799 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:58:12.940198 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:58:12.940548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:14.732830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.792 seconds
[0m13:58:14.737386 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:58:15.319719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103caf6d0>]}
[0m13:58:15.321463 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.39s]
[0m13:58:15.322392 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:58:15.323039 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:58:15.323761 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:58:15.324402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:58:15.324948 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:58:15.328175 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:58:15.329394 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:58:15.334992 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:58:15.336811 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:58:15.337233 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:58:15.337608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.158101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.820 seconds
[0m13:58:17.163069 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:58:17.771262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105076150>]}
[0m13:58:17.772145 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.45s]
[0m13:58:17.772577 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:58:17.772849 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:58:17.773296 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:58:17.773632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:58:17.773865 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:58:17.776469 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:58:17.778327 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:58:17.780400 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:58:17.781183 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:58:17.781385 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:58:17.781573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:19.479561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.698 seconds
[0m13:58:19.482200 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:58:20.127542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e5e7d0>]}
[0m13:58:20.128370 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m13:58:20.128973 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:58:20.129359 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:58:20.129832 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:58:20.130297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:58:20.130623 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:58:20.133236 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:58:20.134048 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:58:20.136361 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:58:20.137150 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:58:20.137438 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:58:20.137698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:21.697817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.560 seconds
[0m13:58:21.702814 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:58:22.251365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278cd310>]}
[0m13:58:22.252421 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.12s]
[0m13:58:22.253149 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:58:22.253681 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:58:22.254408 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:58:22.254966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:58:22.255347 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:58:22.265083 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:58:22.266590 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:58:22.289784 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:58:22.290148 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        g.GAME_ID as THE_GAME_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.game_id, as details_game_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.game_id = g.game_id
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    THE_GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:58:22.290768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:23.837466 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860f2-0102-31cd-0006-c35e000445ca
[0m13:58:23.838365 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 20 unexpected 'as'.
syntax error line 20 at position 10 unexpected '.'.
syntax error line 21 at position 10 unexpected '.'.
syntax error line 22 at position 10 unexpected '.'.
syntax error line 23 at position 10 unexpected '.'.
syntax error line 24 at position 10 unexpected '.'.
syntax error line 25 at position 10 unexpected '.'.
syntax error line 26 at position 10 unexpected '.'.
syntax error line 27 at position 10 unexpected '.'.
syntax error line 28 at position 10 unexpected '.'.
syntax error line 29 at position 10 unexpected '.'.
syntax error line 30 at position 10 unexpected '.'.
syntax error line 31 at position 10 unexpected '.'.
syntax error line 32 at position 10 unexpected '.'.
syntax error line 33 at position 10 unexpected '.'.
syntax error line 34 at position 10 unexpected '.'.
syntax error line 35 at position 10 unexpected '.'.
syntax error line 36 at position 10 unexpected '.'.
syntax error line 37 at position 10 unexpected '.'.
syntax error line 38 at position 10 unexpected '.'.
syntax error line 39 at position 10 unexpected '.'.
syntax error line 40 at position 10 unexpected '.'.
syntax error line 46 at position 0 unexpected 'SELECT'.
[0m13:58:23.839164 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:58:24.442117 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 20 unexpected 'as'.
  syntax error line 20 at position 10 unexpected '.'.
  syntax error line 21 at position 10 unexpected '.'.
  syntax error line 22 at position 10 unexpected '.'.
  syntax error line 23 at position 10 unexpected '.'.
  syntax error line 24 at position 10 unexpected '.'.
  syntax error line 25 at position 10 unexpected '.'.
  syntax error line 26 at position 10 unexpected '.'.
  syntax error line 27 at position 10 unexpected '.'.
  syntax error line 28 at position 10 unexpected '.'.
  syntax error line 29 at position 10 unexpected '.'.
  syntax error line 30 at position 10 unexpected '.'.
  syntax error line 31 at position 10 unexpected '.'.
  syntax error line 32 at position 10 unexpected '.'.
  syntax error line 33 at position 10 unexpected '.'.
  syntax error line 34 at position 10 unexpected '.'.
  syntax error line 35 at position 10 unexpected '.'.
  syntax error line 36 at position 10 unexpected '.'.
  syntax error line 37 at position 10 unexpected '.'.
  syntax error line 38 at position 10 unexpected '.'.
  syntax error line 39 at position 10 unexpected '.'.
  syntax error line 40 at position 10 unexpected '.'.
  syntax error line 46 at position 0 unexpected 'SELECT'.
[0m13:58:24.443203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12531a650>]}
[0m13:58:24.444159 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.19s]
[0m13:58:24.445000 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:58:24.445521 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:58:24.446985 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:58:24.447650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:58:24.448104 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:58:24.451780 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:58:24.452930 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:58:24.455765 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:58:24.457242 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:58:24.457626 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:58:24.457989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:26.205072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m13:58:26.210539 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:58:26.771737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0dc536e-3dd0-4846-9d6e-9c4e7791cd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279ae450>]}
[0m13:58:26.773508 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.32s]
[0m13:58:26.774352 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:58:26.774943 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:58:26.775585 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:58:26.776113 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:58:26.778222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:26.778777 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:58:26.779370 [info ] [MainThread]: 
[0m13:58:26.779807 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 25.67 seconds (25.67s).
[0m13:58:26.782234 [debug] [MainThread]: Command end result
[0m13:58:26.816319 [info ] [MainThread]: 
[0m13:58:26.816617 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:26.816804 [info ] [MainThread]: 
[0m13:58:26.817067 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 20 unexpected 'as'.
  syntax error line 20 at position 10 unexpected '.'.
  syntax error line 21 at position 10 unexpected '.'.
  syntax error line 22 at position 10 unexpected '.'.
  syntax error line 23 at position 10 unexpected '.'.
  syntax error line 24 at position 10 unexpected '.'.
  syntax error line 25 at position 10 unexpected '.'.
  syntax error line 26 at position 10 unexpected '.'.
  syntax error line 27 at position 10 unexpected '.'.
  syntax error line 28 at position 10 unexpected '.'.
  syntax error line 29 at position 10 unexpected '.'.
  syntax error line 30 at position 10 unexpected '.'.
  syntax error line 31 at position 10 unexpected '.'.
  syntax error line 32 at position 10 unexpected '.'.
  syntax error line 33 at position 10 unexpected '.'.
  syntax error line 34 at position 10 unexpected '.'.
  syntax error line 35 at position 10 unexpected '.'.
  syntax error line 36 at position 10 unexpected '.'.
  syntax error line 37 at position 10 unexpected '.'.
  syntax error line 38 at position 10 unexpected '.'.
  syntax error line 39 at position 10 unexpected '.'.
  syntax error line 40 at position 10 unexpected '.'.
  syntax error line 46 at position 0 unexpected 'SELECT'.
[0m13:58:26.817322 [info ] [MainThread]: 
[0m13:58:26.817513 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:58:26.821187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.441193, "process_user_time": 2.076529, "process_kernel_time": 0.322771, "process_mem_max_rss": "198049792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:58:26.821592 [debug] [MainThread]: Command `dbt run` failed at 13:58:26.821541 after 26.44 seconds
[0m13:58:26.821888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10177d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10177cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127aabe10>]}
[0m13:58:26.822099 [debug] [MainThread]: Flushing usage events
[0m13:59:09.695797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b57f90>]}


============================== 13:59:09.698538 | a4a4b837-cf90-445a-9bca-bbd22d14c1c1 ==============================
[0m13:59:09.698538 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:59:09.698845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:59:10.212502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6a210>]}
[0m13:59:10.231216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057adb50>]}
[0m13:59:10.231728 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:59:10.294349 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:59:10.327008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:10.327195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:10.337404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c27f110>]}
[0m13:59:10.374703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c248b90>]}
[0m13:59:10.374943 [info ] [MainThread]: Found 10 models, 459 macros
[0m13:59:10.375109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae77d0>]}
[0m13:59:10.376219 [info ] [MainThread]: 
[0m13:59:10.376492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:10.378416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m13:59:10.384775 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m13:59:10.384936 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m13:59:10.385062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:11.958954 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.574 seconds
[0m13:59:11.962548 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m13:59:12.564040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m13:59:12.577542 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m13:59:12.577977 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m13:59:12.578274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:14.194434 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.616 seconds
[0m13:59:14.198230 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m13:59:14.817247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105206fd0>]}
[0m13:59:14.818523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:14.819038 [info ] [MainThread]: 
[0m13:59:14.823124 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m13:59:14.823909 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m13:59:14.824543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m13:59:14.825141 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m13:59:14.833318 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m13:59:14.834976 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m13:59:14.855844 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m13:59:14.856783 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m13:59:14.857048 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m13:59:14.857281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:16.721525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.864 seconds
[0m13:59:16.746640 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m13:59:17.378579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056acdd0>]}
[0m13:59:17.379747 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.55s]
[0m13:59:17.380471 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m13:59:17.381000 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m13:59:17.381797 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m13:59:17.382463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m13:59:17.382866 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m13:59:17.385229 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m13:59:17.387272 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m13:59:17.390590 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m13:59:17.392080 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m13:59:17.392494 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m13:59:17.392837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:19.417010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.024 seconds
[0m13:59:19.422130 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m13:59:19.997208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065721d0>]}
[0m13:59:19.998327 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.61s]
[0m13:59:19.999066 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m13:59:19.999583 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m13:59:20.000169 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m13:59:20.000675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m13:59:20.001096 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m13:59:20.003653 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m13:59:20.004759 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m13:59:20.008345 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m13:59:20.009383 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m13:59:20.009779 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:59:20.010051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:21.726966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.716 seconds
[0m13:59:21.733132 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m13:59:22.382972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c154fd0>]}
[0m13:59:22.388238 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.38s]
[0m13:59:22.389819 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m13:59:22.390815 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m13:59:22.391637 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m13:59:22.391985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m13:59:22.392191 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m13:59:22.394576 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m13:59:22.395560 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m13:59:22.397659 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m13:59:22.398712 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m13:59:22.399505 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m13:59:22.400277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:24.156690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.756 seconds
[0m13:59:24.161941 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m13:59:24.700886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c2610>]}
[0m13:59:24.702743 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.31s]
[0m13:59:24.704097 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m13:59:24.704753 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m13:59:24.705520 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m13:59:24.706109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m13:59:24.706562 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m13:59:24.709838 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m13:59:24.710687 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m13:59:24.719365 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m13:59:24.721039 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m13:59:24.721295 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m13:59:24.721535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:26.390299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.668 seconds
[0m13:59:26.395727 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m13:59:26.957636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c713510>]}
[0m13:59:26.958745 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.25s]
[0m13:59:26.959377 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m13:59:26.959812 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m13:59:26.960646 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m13:59:26.961226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m13:59:26.961574 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m13:59:26.965273 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m13:59:26.967454 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m13:59:26.970089 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m13:59:26.971072 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m13:59:26.971363 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m13:59:26.971625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:28.761980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.790 seconds
[0m13:59:28.766870 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m13:59:29.349384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae7110>]}
[0m13:59:29.350701 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.39s]
[0m13:59:29.351518 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m13:59:29.352043 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m13:59:29.352735 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m13:59:29.353418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m13:59:29.353866 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m13:59:29.357790 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m13:59:29.358683 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m13:59:29.361849 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m13:59:29.363076 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m13:59:29.363467 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m13:59:29.363812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:30.985280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.621 seconds
[0m13:59:30.992369 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m13:59:31.558547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c77b710>]}
[0m13:59:31.560886 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.20s]
[0m13:59:31.562053 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m13:59:31.562821 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m13:59:31.563903 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m13:59:31.564885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m13:59:31.565534 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m13:59:31.578587 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m13:59:31.580351 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m13:59:31.610529 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:59:31.610905 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH player_stats AS (
    SELECT
        p.PLAYER_ID,
        g.GAME_ID as THE_GAME_ID,
        p.PLAYER_NAME,
        p.TEAM_ID as player_team_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ID as game_team_id,
        gd.game_id as details_game_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM NBA_GAMES.DEV.src_players p
    JOIN NBA_GAMES.DEV.src_games_details gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN NBA_GAMES.DEV.src_games g ON gd.game_id = g.game_id
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    THE_GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m13:59:31.611205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:33.649515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.038 seconds
[0m13:59:33.662056 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:59:33.662651 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m13:59:33.966629 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.303 seconds
[0m13:59:33.974203 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:59:33.974816 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m13:59:34.266486 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.291 seconds
[0m13:59:34.279528 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:59:34.280301 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m13:59:34.575298 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.294 seconds
[0m13:59:34.619675 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m13:59:34.621435 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:59:34.621750 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m13:59:34.952548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m13:59:34.953339 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m13:59:34.953981 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(THE_GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(THE_GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m13:59:35.333082 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860f3-0102-32a8-0006-c35e0004834a
[0m13:59:35.334056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m13:59:35.334801 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m13:59:35.911498 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:59:35.912484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c14e250>]}
[0m13:59:35.913315 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.35s]
[0m13:59:35.914007 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m13:59:35.914516 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m13:59:35.916525 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m13:59:35.917312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m13:59:35.917780 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m13:59:35.921455 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m13:59:35.922570 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m13:59:35.925858 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m13:59:35.927281 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m13:59:35.927650 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m13:59:35.927992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:37.794689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.866 seconds
[0m13:59:37.802553 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m13:59:38.439180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a4b837-cf90-445a-9bca-bbd22d14c1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d69f10>]}
[0m13:59:38.440789 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.52s]
[0m13:59:38.441837 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m13:59:38.442548 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m13:59:38.443316 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m13:59:38.443842 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m13:59:38.445618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:38.445959 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m13:59:38.446807 [info ] [MainThread]: 
[0m13:59:38.447401 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.07 seconds (28.07s).
[0m13:59:38.450011 [debug] [MainThread]: Command end result
[0m13:59:38.496134 [info ] [MainThread]: 
[0m13:59:38.496468 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:59:38.496640 [info ] [MainThread]: 
[0m13:59:38.496852 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m13:59:38.497023 [info ] [MainThread]: 
[0m13:59:38.497199 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m13:59:38.499750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.83295, "process_user_time": 2.148232, "process_kernel_time": 0.405848, "process_mem_max_rss": "195526656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:59:38.500190 [debug] [MainThread]: Command `dbt run` failed at 13:59:38.500127 after 28.83 seconds
[0m13:59:38.500492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031f8d10>]}
[0m13:59:38.500693 [debug] [MainThread]: Flushing usage events
[0m14:04:33.310305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104888c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e3f90>]}


============================== 14:04:33.314206 | 8e1629d7-3167-424d-8b97-7d49a57f505d ==============================
[0m14:04:33.314206 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:04:33.314586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:34.066387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104893610>]}
[0m14:04:34.086118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104335c50>]}
[0m14:04:34.086686 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:04:34.149288 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:04:34.184018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:34.184229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:34.194816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d3a9d0>]}
[0m14:04:34.236908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b9f010>]}
[0m14:04:34.237194 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:04:34.237364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147cb590>]}
[0m14:04:34.238564 [info ] [MainThread]: 
[0m14:04:34.238846 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:34.240812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:04:34.247286 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:04:34.247483 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:04:34.247616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:36.109732 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.862 seconds
[0m14:04:36.112964 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:04:36.697853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:04:36.711557 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:04:36.712061 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:04:36.712379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:38.259599 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.547 seconds
[0m14:04:38.264348 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:04:38.915895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cfbc50>]}
[0m14:04:38.917453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:38.917967 [info ] [MainThread]: 
[0m14:04:38.921739 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:04:38.922556 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:04:38.923256 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:04:38.923955 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:04:38.932003 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:04:38.933600 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:04:38.955002 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:04:38.956098 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:04:38.956363 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:04:38.956622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:40.955804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.999 seconds
[0m14:04:40.983775 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:04:41.562082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c58d90>]}
[0m14:04:41.563649 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.64s]
[0m14:04:41.564599 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:04:41.565246 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:04:41.566230 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:04:41.566786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:04:41.567199 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:04:41.570248 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:04:41.572740 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:04:41.576679 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:04:41.578613 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:04:41.579059 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:04:41.579455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:43.720543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.141 seconds
[0m14:04:43.727929 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:04:44.304587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c93150>]}
[0m14:04:44.312527 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.74s]
[0m14:04:44.316186 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:04:44.317861 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:04:44.318816 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:04:44.319465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:04:44.319941 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:04:44.324879 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:04:44.326998 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:04:44.332665 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:04:44.333867 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:04:44.334397 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:04:44.334766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:45.971871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.636 seconds
[0m14:04:45.979568 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:04:46.555154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034dc7d0>]}
[0m14:04:46.557181 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.23s]
[0m14:04:46.558193 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:04:46.558771 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:04:46.559886 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:04:46.560613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:04:46.561092 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:04:46.577063 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:04:46.579717 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:04:46.586011 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:04:46.589262 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:04:46.593926 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:04:46.596098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:48.328122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.732 seconds
[0m14:04:48.337830 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:04:48.885493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d4f90>]}
[0m14:04:48.888231 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.32s]
[0m14:04:48.890447 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:04:48.891260 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:04:48.892152 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:04:48.892726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:04:48.893132 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:04:48.896782 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:04:48.897756 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:04:48.901330 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:04:48.902163 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:04:48.902476 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:04:48.902721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:51.207296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.304 seconds
[0m14:04:51.214864 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:04:51.774948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bfb050>]}
[0m14:04:51.776614 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.88s]
[0m14:04:51.777686 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:04:51.778334 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:04:51.779461 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:04:51.780031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:04:51.780438 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:04:51.787571 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:04:51.789081 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:04:51.799136 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:04:51.801421 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:04:51.801754 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:04:51.802028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:53.828889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.026 seconds
[0m14:04:53.834912 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:04:54.678171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11581ae50>]}
[0m14:04:54.680523 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.90s]
[0m14:04:54.681726 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:04:54.682488 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:04:54.683426 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:04:54.683993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:04:54.684361 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:04:54.690990 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:04:54.692016 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:04:54.695355 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:04:54.696312 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:04:54.696655 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:04:54.696975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:56.568990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.871 seconds
[0m14:04:56.575261 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:04:57.138418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104318fd0>]}
[0m14:04:57.140504 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.45s]
[0m14:04:57.141533 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:04:57.142558 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:04:57.143764 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:04:57.144279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:04:57.144585 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:04:57.157608 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:04:57.159898 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:04:57.196061 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:04:57.196462 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID as GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.GAME_ID = g.THE_GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:04:57.196843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:58.743898 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860f8-0102-32a8-0006-c35e0004835a
[0m14:04:58.744700 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 91 at position 38
invalid identifier 'G.THE_GAME_ID'
[0m14:04:58.745466 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:04:59.292147 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 91 at position 38
  invalid identifier 'G.THE_GAME_ID'
[0m14:04:59.293275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d674d0>]}
[0m14:04:59.294350 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.15s]
[0m14:04:59.295421 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:04:59.295869 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:04:59.297551 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:04:59.298182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:04:59.298525 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:04:59.302607 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:04:59.303468 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:04:59.307016 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:04:59.308852 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:04:59.309374 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:04:59.310073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:01.006996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.697 seconds
[0m14:05:01.013199 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:05:01.579650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1629d7-3167-424d-8b97-7d49a57f505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030ce090>]}
[0m14:05:01.580992 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.28s]
[0m14:05:01.581627 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:05:01.582101 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:05:01.582585 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:05:01.582831 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:05:01.583958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:01.584125 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:05:01.584260 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:05:01.584589 [info ] [MainThread]: 
[0m14:05:01.584789 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 27.35 seconds (27.35s).
[0m14:05:01.586003 [debug] [MainThread]: Command end result
[0m14:05:01.618199 [info ] [MainThread]: 
[0m14:05:01.618551 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:05:01.618773 [info ] [MainThread]: 
[0m14:05:01.619022 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 91 at position 38
  invalid identifier 'G.THE_GAME_ID'
[0m14:05:01.619221 [info ] [MainThread]: 
[0m14:05:01.619439 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:05:01.622184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.348164, "process_user_time": 2.023095, "process_kernel_time": 0.48262, "process_mem_max_rss": "191086592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:01.622678 [debug] [MainThread]: Command `dbt run` failed at 14:05:01.622619 after 28.35 seconds
[0m14:05:01.623031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f915d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f90d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11708f390>]}
[0m14:05:01.623695 [debug] [MainThread]: Flushing usage events
[0m14:05:24.421561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104912d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104977ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104977f90>]}


============================== 14:05:24.424716 | 34ab3329-731d-44d0-9133-9e3ce933eb7e ==============================
[0m14:05:24.424716 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:05:24.425061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.957971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd20d0>]}
[0m14:05:24.977559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c9d10>]}
[0m14:05:24.978391 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:05:25.039272 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:05:25.071981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:25.072179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:25.082466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570cd90>]}
[0m14:05:25.120184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a05bc50>]}
[0m14:05:25.120448 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:05:25.120611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fbab90>]}
[0m14:05:25.121755 [info ] [MainThread]: 
[0m14:05:25.122037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:25.123964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:05:25.130363 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:05:25.130553 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:05:25.130687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:27.276078 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.145 seconds
[0m14:05:27.280667 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:05:27.833805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:05:27.844163 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:05:27.844429 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:05:27.844594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:29.388072 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.543 seconds
[0m14:05:29.394038 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:05:29.943748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9c210>]}
[0m14:05:29.945735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:29.946611 [info ] [MainThread]: 
[0m14:05:29.951684 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:05:29.952722 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:05:29.953570 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:05:29.953958 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:05:29.961766 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:05:29.963218 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:05:29.988002 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:05:29.989210 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:05:29.989476 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:05:29.989708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:32.157454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.167 seconds
[0m14:05:32.183730 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:05:32.771959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34dfd0>]}
[0m14:05:32.773090 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.82s]
[0m14:05:32.773927 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:05:32.774439 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:05:32.775231 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:05:32.775890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:05:32.776568 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:05:32.780654 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:05:32.783718 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:05:32.788423 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:05:32.790099 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:05:32.790545 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:05:32.790960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.730880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.939 seconds
[0m14:05:34.740242 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:05:35.312014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a311690>]}
[0m14:05:35.313729 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.54s]
[0m14:05:35.314660 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:05:35.315306 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:05:35.316425 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:05:35.317087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:05:35.317349 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:05:35.320380 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:05:35.321571 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:05:35.325436 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:05:35.326576 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:05:35.326885 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:05:35.327159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:36.995750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.668 seconds
[0m14:05:37.007802 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:05:37.573370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bffd0>]}
[0m14:05:37.573881 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.26s]
[0m14:05:37.574283 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:05:37.574526 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:05:37.575028 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:05:37.575316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:05:37.575490 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:05:37.577486 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:05:37.577912 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:05:37.580165 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:05:37.581021 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:05:37.581228 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:05:37.581401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.315901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.734 seconds
[0m14:05:39.320054 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:05:39.884657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f82b90>]}
[0m14:05:39.889653 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.30s]
[0m14:05:39.891907 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:05:39.892261 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:05:39.896181 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:05:39.896502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:05:39.896689 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:05:39.899367 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:05:39.902419 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:05:39.906551 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:05:39.908559 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:05:39.908834 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:05:39.909043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:41.802342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.893 seconds
[0m14:05:41.809332 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:05:42.353762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d3850>]}
[0m14:05:42.355123 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.46s]
[0m14:05:42.356122 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:05:42.356867 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:05:42.357894 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:05:42.358567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:05:42.359066 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:05:42.365961 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:05:42.367975 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:05:42.372851 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:05:42.390771 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:05:42.403370 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:05:42.412091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:44.183951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m14:05:44.191144 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:05:44.753663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035f1910>]}
[0m14:05:44.755279 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.39s]
[0m14:05:44.756354 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:05:44.757165 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:05:44.758159 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:05:44.758762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:05:44.759217 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:05:44.765300 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:05:44.770188 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:05:44.773669 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:05:44.775193 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:05:44.775609 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:05:44.776090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:46.510091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.734 seconds
[0m14:05:46.515465 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:05:47.109266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103527310>]}
[0m14:05:47.110594 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:05:47.111667 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:05:47.112659 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:05:47.113459 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:05:47.114213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:05:47.114781 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:05:47.131969 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:05:47.133085 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:05:47.164342 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:05:47.164840 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID as GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        g.GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:05:47.165169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:49.045907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.881 seconds
[0m14:05:49.057959 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:05:49.058562 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:05:49.363589 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.304 seconds
[0m14:05:49.372299 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:05:49.372844 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:05:49.667196 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.293 seconds
[0m14:05:49.680878 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:05:49.681433 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:05:49.987384 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.305 seconds
[0m14:05:50.027401 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:05:50.029869 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:05:50.030176 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:05:50.471753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m14:05:50.472995 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:05:50.473741 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:05:50.850160 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860f9-0102-3227-0006-c35e00047626
[0m14:05:50.853813 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_ID'
[0m14:05:50.854191 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:05:51.422363 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:05:51.423776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e32450>]}
[0m14:05:51.424987 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.31s]
[0m14:05:51.425844 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:05:51.426418 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:05:51.428666 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:05:51.429474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:05:51.430000 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:05:51.434793 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:05:51.435621 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:05:51.438463 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:05:51.440596 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:05:51.441140 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:05:51.441563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:53.216845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.775 seconds
[0m14:05:53.221614 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:05:53.783973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ab3329-731d-44d0-9133-9e3ce933eb7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103527310>]}
[0m14:05:53.785200 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:05:53.786045 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:05:53.786659 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:05:53.787222 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:05:53.787810 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:05:53.789817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:53.790287 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:05:53.790636 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:05:53.791196 [info ] [MainThread]: 
[0m14:05:53.791702 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.67 seconds (28.67s).
[0m14:05:53.793384 [debug] [MainThread]: Command end result
[0m14:05:53.818637 [info ] [MainThread]: 
[0m14:05:53.818913 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:05:53.819057 [info ] [MainThread]: 
[0m14:05:53.819234 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:05:53.819372 [info ] [MainThread]: 
[0m14:05:53.819523 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:05:53.821869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.437698, "process_user_time": 2.070826, "process_kernel_time": 0.484588, "process_mem_max_rss": "187449344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:53.822238 [debug] [MainThread]: Command `dbt run` failed at 14:05:53.822193 after 29.44 seconds
[0m14:05:53.822488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101024d10>]}
[0m14:05:53.822663 [debug] [MainThread]: Flushing usage events
[0m14:06:44.581112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104289650>]}


============================== 14:06:44.584860 | 565e01e7-68e5-4bfc-91d7-6111f142c489 ==============================
[0m14:06:44.584860 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:06:44.585214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:45.395763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414f910>]}
[0m14:06:45.414911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ce9d10>]}
[0m14:06:45.415436 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:06:45.483481 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:06:45.520305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:45.520525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:45.530975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c17b610>]}
[0m14:06:45.570775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c19e6d0>]}
[0m14:06:45.571057 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:06:45.571238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c241a50>]}
[0m14:06:45.572399 [info ] [MainThread]: 
[0m14:06:45.572695 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:06:45.574795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:06:45.581440 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:06:45.581639 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:06:45.581805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:47.217089 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.635 seconds
[0m14:06:47.221200 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:06:47.839507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:06:47.852738 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:06:47.853326 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:06:47.853706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:49.325633 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.472 seconds
[0m14:06:49.327579 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:06:50.130721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c39c1d0>]}
[0m14:06:50.131401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:50.131796 [info ] [MainThread]: 
[0m14:06:50.136185 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:06:50.137069 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:06:50.138348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:06:50.139147 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:06:50.149571 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:06:50.150971 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:06:50.177134 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:06:50.178192 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:06:50.178464 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:06:50.178698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:52.233508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.054 seconds
[0m14:06:52.263622 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:06:52.849526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042da1d0>]}
[0m14:06:52.851360 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.71s]
[0m14:06:52.852334 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:06:52.853352 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:06:52.854353 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:06:52.855079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:06:52.855535 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:06:52.857961 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:06:52.859459 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:06:52.863516 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:06:52.865082 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:06:52.865513 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:06:52.866204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:54.841542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.975 seconds
[0m14:06:54.846088 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:06:55.416427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8f9790>]}
[0m14:06:55.417574 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.56s]
[0m14:06:55.418281 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:06:55.418895 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:06:55.419648 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:06:55.420296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:06:55.420678 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:06:55.423602 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:06:55.424558 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:06:55.427073 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:06:55.427678 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:06:55.428259 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:06:55.428531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:57.032007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.603 seconds
[0m14:06:57.036784 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:06:57.579789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102993750>]}
[0m14:06:57.580919 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.16s]
[0m14:06:57.581598 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:06:57.582206 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:06:57.582628 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:06:57.583069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:06:57.583292 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:06:57.584799 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:06:57.585658 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:06:57.587558 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:06:57.588312 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:06:57.588647 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:06:57.588923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:59.444302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.855 seconds
[0m14:06:59.446280 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:06:59.984672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d992dd0>]}
[0m14:06:59.986996 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.40s]
[0m14:06:59.987916 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:06:59.988604 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:06:59.989409 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:06:59.990073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:06:59.990503 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:06:59.993888 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:06:59.995611 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:07:00.001898 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:07:00.003546 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:07:00.004055 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:07:00.004466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:01.867274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.863 seconds
[0m14:07:01.871094 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:07:02.427429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8f9f10>]}
[0m14:07:02.429274 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.44s]
[0m14:07:02.430098 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:07:02.430693 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:07:02.431725 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:07:02.432335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:07:02.432749 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:07:02.438727 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:07:02.441597 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:07:02.445821 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:07:02.447034 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:07:02.447442 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:07:02.448016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:04.014644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.566 seconds
[0m14:07:04.018482 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:07:04.601173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df8ed0>]}
[0m14:07:04.603131 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.17s]
[0m14:07:04.604144 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:07:04.604799 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:07:04.605577 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:07:04.606227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:07:04.606655 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:07:04.611975 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:07:04.613084 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:07:04.617168 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:07:04.618396 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:07:04.618805 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:07:04.619204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:06.251396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.632 seconds
[0m14:07:06.257706 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:07:06.799489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f93a50>]}
[0m14:07:06.801336 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.19s]
[0m14:07:06.802367 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:07:06.803141 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:07:06.804005 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:07:06.804688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:07:06.805219 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:07:06.818470 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:07:06.820641 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:07:06.846088 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:07:06.846495 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID as THE_GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        g.THE_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.GAME_ID = g.THE_GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    THE_GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:07:06.846840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:08.875538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.028 seconds
[0m14:07:08.893319 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:07:08.893635 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:07:09.197873 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.304 seconds
[0m14:07:09.208571 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:07:09.209389 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:07:09.492736 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.283 seconds
[0m14:07:09.505170 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:07:09.505840 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:07:09.793763 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.287 seconds
[0m14:07:09.832245 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:07:09.834485 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:07:09.834794 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:07:10.153829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m14:07:10.155477 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:07:10.156291 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(THE_GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(THE_GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:07:10.578632 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860fb-0102-32a8-0006-c35e00048386
[0m14:07:10.579305 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m14:07:10.581100 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:07:11.157454 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:07:11.158631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9c02d0>]}
[0m14:07:11.159740 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.35s]
[0m14:07:11.160441 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:07:11.160924 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:07:11.162555 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:07:11.163216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:07:11.163552 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:07:11.166825 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:07:11.168578 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:07:11.171932 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:07:11.173513 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:07:11.174333 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:07:11.174904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:13.019734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.844 seconds
[0m14:07:13.025096 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:07:13.568698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565e01e7-68e5-4bfc-91d7-6111f142c489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8f9790>]}
[0m14:07:13.570238 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.41s]
[0m14:07:13.571220 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:07:13.571963 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:07:13.572889 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:07:13.573487 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:07:13.575286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:13.575690 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:07:13.576264 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:07:13.576933 [info ] [MainThread]: 
[0m14:07:13.577328 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.00 seconds (28.00s).
[0m14:07:13.580359 [debug] [MainThread]: Command end result
[0m14:07:13.617677 [info ] [MainThread]: 
[0m14:07:13.618007 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:07:13.618200 [info ] [MainThread]: 
[0m14:07:13.618439 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:07:13.618651 [info ] [MainThread]: 
[0m14:07:13.618860 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:07:13.621345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.071524, "process_user_time": 2.207224, "process_kernel_time": 0.420984, "process_mem_max_rss": "188301312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:13.621756 [debug] [MainThread]: Command `dbt run` failed at 14:07:13.621704 after 29.07 seconds
[0m14:07:13.622057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104297c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104297110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009455d0>]}
[0m14:07:13.622262 [debug] [MainThread]: Flushing usage events
[0m14:09:30.413100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106253010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c3f90>]}


============================== 14:09:30.415910 | 88b359eb-12ba-4b76-b0a0-50f93533c247 ==============================
[0m14:09:30.415910 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:09:30.416209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:09:31.067869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f9d10>]}
[0m14:09:31.086692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b45e10>]}
[0m14:09:31.087222 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:09:31.148436 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:09:31.183201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:31.183406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:31.193926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa98fd0>]}
[0m14:09:31.232865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc5c6d0>]}
[0m14:09:31.233121 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:09:31.233286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb46790>]}
[0m14:09:31.234420 [info ] [MainThread]: 
[0m14:09:31.234690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:31.236603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:09:31.243352 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:09:31.243541 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:09:31.243679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:33.217144 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.973 seconds
[0m14:09:33.220939 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:09:33.829727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:09:33.843374 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:09:33.843919 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:09:33.844233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:35.412762 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.568 seconds
[0m14:09:35.417454 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:09:36.186111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fadb810>]}
[0m14:09:36.187185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:36.187697 [info ] [MainThread]: 
[0m14:09:36.191632 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:09:36.192341 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:09:36.192894 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:09:36.193241 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:09:36.200734 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:09:36.201940 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:09:36.266278 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:09:36.267203 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:09:36.267413 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:09:36.267590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:37.957563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.689 seconds
[0m14:09:37.985601 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:09:38.782232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f80ced0>]}
[0m14:09:38.783367 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.59s]
[0m14:09:38.784114 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:09:38.784664 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:09:38.785451 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:09:38.786023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:09:38.786454 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:09:38.788658 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:09:38.790793 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:09:38.794309 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:09:38.795727 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:09:38.796122 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:09:38.796448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:40.683531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.887 seconds
[0m14:09:40.690168 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:09:41.267955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1a110>]}
[0m14:09:41.269662 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.48s]
[0m14:09:41.270565 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:09:41.271160 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:09:41.271879 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:09:41.272790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:09:41.273299 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:09:41.275856 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:09:41.276924 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:09:41.281029 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:09:41.282112 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:09:41.282906 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:09:41.283540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:42.995920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.711 seconds
[0m14:09:43.009210 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:09:43.600742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7a5d0>]}
[0m14:09:43.602646 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.33s]
[0m14:09:43.603678 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:09:43.604387 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:09:43.605611 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:09:43.607202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:09:43.607565 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:09:43.611204 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:09:43.612327 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:09:43.617178 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:09:43.618322 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:09:43.618660 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:09:43.618978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:45.408828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m14:09:45.413975 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:09:46.013122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f80ced0>]}
[0m14:09:46.015057 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.41s]
[0m14:09:46.015980 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:09:46.016532 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:09:46.017238 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:09:46.017941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:09:46.018399 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:09:46.021128 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:09:46.022963 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:09:46.027359 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:09:46.028755 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:09:46.029119 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:09:46.029446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:47.916051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.886 seconds
[0m14:09:47.919261 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:09:48.573860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa79d0>]}
[0m14:09:48.575814 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.56s]
[0m14:09:48.576660 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:09:48.577471 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:09:48.578584 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:09:48.579250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:09:48.579715 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:09:48.584207 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:09:48.586982 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:09:48.590081 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:09:48.591146 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:09:48.591467 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:09:48.591767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:50.309896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.718 seconds
[0m14:09:50.312371 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:09:50.927616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616f7d0>]}
[0m14:09:50.929192 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m14:09:50.930129 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:09:50.930806 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:09:50.931567 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:09:50.932273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:09:50.932758 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:09:50.938276 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:09:50.940421 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:09:50.944037 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:09:50.945139 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:09:50.945533 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:09:50.945934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:52.651384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.705 seconds
[0m14:09:52.656627 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:09:53.192541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddb810>]}
[0m14:09:53.193579 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.26s]
[0m14:09:53.194303 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:09:53.194819 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:09:53.195471 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:09:53.196112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:09:53.196574 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:09:53.207404 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:09:53.209073 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:09:53.232554 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:09:53.232936 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        gd.GAME_ID as details_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    details_game_id as GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:09:53.233293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:55.318180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.085 seconds
[0m14:09:55.325819 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:09:55.326191 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:09:55.626483 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.300 seconds
[0m14:09:55.634587 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:09:55.635130 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:09:55.922434 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.287 seconds
[0m14:09:55.936523 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:09:55.937198 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:09:56.220236 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.282 seconds
[0m14:09:56.255226 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:09:56.257988 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:09:56.258249 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:09:56.638375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m14:09:56.639967 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:09:56.640755 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(gd.game_id, p.player_id) = DBT_INTERNAL_DEST.concat(gd.game_id, p.player_id)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:09:57.014377 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860fd-0102-32a8-0006-c35e000483a2
[0m14:09:57.015043 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 43
invalid identifier 'GD.GAME_ID'
[0m14:09:57.015699 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:09:57.575149 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 4 at position 43
  invalid identifier 'GD.GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:09:57.576122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b19c750>]}
[0m14:09:57.576847 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.38s]
[0m14:09:57.577506 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:09:57.577987 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:09:57.579609 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:09:57.580130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:09:57.580488 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:09:57.584144 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:09:57.585147 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:09:57.587765 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:09:57.589255 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:09:57.589613 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:09:57.589967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:59.286279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.695 seconds
[0m14:09:59.292985 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:09:59.835664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b359eb-12ba-4b76-b0a0-50f93533c247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddbe90>]}
[0m14:09:59.837558 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.26s]
[0m14:09:59.838382 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:09:59.839149 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:09:59.840133 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:09:59.840799 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:09:59.842831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:59.843301 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:09:59.843639 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:09:59.844240 [info ] [MainThread]: 
[0m14:09:59.844677 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.61 seconds (28.61s).
[0m14:09:59.846383 [debug] [MainThread]: Command end result
[0m14:09:59.878670 [info ] [MainThread]: 
[0m14:09:59.879014 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:59.879238 [info ] [MainThread]: 
[0m14:09:59.879471 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 4 at position 43
  invalid identifier 'GD.GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:09:59.879667 [info ] [MainThread]: 
[0m14:09:59.879894 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:09:59.891738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.51061, "process_user_time": 2.274468, "process_kernel_time": 0.432622, "process_mem_max_rss": "191135744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:59.892257 [debug] [MainThread]: Command `dbt run` failed at 14:09:59.892199 after 29.51 seconds
[0m14:09:59.892557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b444d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c00f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10141d4d0>]}
[0m14:09:59.892764 [debug] [MainThread]: Flushing usage events
[0m14:11:19.839474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b26b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b269d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b97f90>]}


============================== 14:11:19.842445 | 6303d1ec-8cec-4264-96c6-1ae5c07aadc2 ==============================
[0m14:11:19.842445 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:11:19.843006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:20.353567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7d390>]}
[0m14:11:20.372231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ddb50>]}
[0m14:11:20.372757 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:11:20.435303 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:11:20.468427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:20.468619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:20.478922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b270d0>]}
[0m14:11:20.516018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf92290>]}
[0m14:11:20.516269 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:11:20.516434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbec50>]}
[0m14:11:20.517541 [info ] [MainThread]: 
[0m14:11:20.517815 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:20.519725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:11:20.526218 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:11:20.526413 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:11:20.526563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:22.225883 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.699 seconds
[0m14:11:22.228919 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:11:22.856995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:11:22.867230 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:11:22.867610 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:11:22.867898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:24.528807 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.661 seconds
[0m14:11:24.530871 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:11:25.137405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf320d0>]}
[0m14:11:25.138678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:25.139203 [info ] [MainThread]: 
[0m14:11:25.143457 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:11:25.144251 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:11:25.144924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:11:25.145465 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:11:25.154034 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:11:25.155673 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:11:25.176935 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:11:25.177911 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:11:25.178187 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:11:25.178426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:27.304159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.125 seconds
[0m14:11:27.327226 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:11:27.900450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c367490>]}
[0m14:11:27.901374 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.75s]
[0m14:11:27.902090 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:11:27.902615 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:11:27.903321 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:11:27.903866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:11:27.904270 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:11:27.906442 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:11:27.908268 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:11:27.911593 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:11:27.912895 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:11:27.913319 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:11:27.913937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:29.994670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.080 seconds
[0m14:11:29.999527 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:11:30.663755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f70b50>]}
[0m14:11:30.665605 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.76s]
[0m14:11:30.666562 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:11:30.667244 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:11:30.668029 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:11:30.668647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:11:30.669108 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:11:30.673342 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:11:30.675432 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:11:30.680085 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:11:30.681732 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:11:30.682228 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:11:30.682594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:32.321726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.639 seconds
[0m14:11:32.326519 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:11:32.916498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b6410>]}
[0m14:11:32.918133 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.25s]
[0m14:11:32.919016 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:11:32.919654 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:11:32.920652 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:11:32.921293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:11:32.921823 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:11:32.926266 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:11:32.927287 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:11:32.931225 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:11:32.932726 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:11:32.933147 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:11:32.933518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:34.858021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.924 seconds
[0m14:11:34.863434 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:11:35.477387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ffb950>]}
[0m14:11:35.479592 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.56s]
[0m14:11:35.480596 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:11:35.481261 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:11:35.482107 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:11:35.482759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:11:35.483410 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:11:35.486349 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:11:35.487374 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:11:35.493357 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:11:35.494999 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:11:35.495416 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:11:35.495788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:37.251923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.756 seconds
[0m14:11:37.257199 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:11:37.834840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ecc10>]}
[0m14:11:37.836892 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.35s]
[0m14:11:37.837751 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:11:37.838434 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:11:37.839475 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:11:37.840092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:11:37.840512 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:11:37.845571 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:11:37.847839 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:11:37.851130 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:11:37.852714 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:11:37.853106 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:11:37.853473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:39.622392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.769 seconds
[0m14:11:39.624954 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:11:40.291811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2cfa50>]}
[0m14:11:40.293262 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.45s]
[0m14:11:40.294259 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:11:40.294921 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:11:40.295638 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:11:40.296228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:11:40.296669 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:11:40.301154 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:11:40.302106 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:11:40.305548 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:11:40.306683 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:11:40.307086 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:11:40.307440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:42.035918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.728 seconds
[0m14:11:42.040750 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:11:42.574130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c555150>]}
[0m14:11:42.575830 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.28s]
[0m14:11:42.576695 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:11:42.577346 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:11:42.578256 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:11:42.579254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:11:42.579866 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:11:42.591508 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:11:42.592646 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:11:42.617787 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:11:42.618156 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        gd.GAME_ID as details_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:11:42.618470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:44.264904 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b860ff-0102-31cd-0006-c35e00044652
[0m14:11:44.265529 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 60 at position 8
invalid identifier 'GD.GAME_ID'
[0m14:11:44.266099 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:11:44.900462 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 60 at position 8
  invalid identifier 'GD.GAME_ID'
[0m14:11:44.901264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ecc10>]}
[0m14:11:44.901970 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.32s]
[0m14:11:44.902668 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:11:44.903121 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:11:44.904960 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:11:44.905585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:11:44.905873 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:11:44.908091 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:11:44.909336 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:11:44.911205 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:11:44.912245 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:11:44.912597 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:11:44.912840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:46.736949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.824 seconds
[0m14:11:46.742866 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:11:47.317827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6303d1ec-8cec-4264-96c6-1ae5c07aadc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c27a490>]}
[0m14:11:47.319510 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.41s]
[0m14:11:47.320350 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:11:47.321205 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:11:47.321859 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:11:47.322357 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:11:47.324516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:47.325059 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:11:47.325662 [info ] [MainThread]: 
[0m14:11:47.326108 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 26.81 seconds (26.81s).
[0m14:11:47.328196 [debug] [MainThread]: Command end result
[0m14:11:47.366306 [info ] [MainThread]: 
[0m14:11:47.367694 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:11:47.367953 [info ] [MainThread]: 
[0m14:11:47.368248 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 60 at position 8
  invalid identifier 'GD.GAME_ID'
[0m14:11:47.368533 [info ] [MainThread]: 
[0m14:11:47.368779 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:11:47.371335 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.563438, "process_user_time": 2.119337, "process_kernel_time": 0.349345, "process_mem_max_rss": "198017024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:11:47.371692 [debug] [MainThread]: Command `dbt run` failed at 14:11:47.371648 after 27.56 seconds
[0m14:11:47.371955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032395d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103238cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c34c610>]}
[0m14:11:47.372152 [debug] [MainThread]: Flushing usage events
[0m14:12:11.183616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069aa7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1bd50>]}


============================== 14:12:11.186178 | 31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5 ==============================
[0m14:12:11.186178 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:12:11.186522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:11.699377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d37e110>]}
[0m14:12:11.718142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fbd10>]}
[0m14:12:11.718647 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:12:11.779174 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:12:11.812479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:11.812671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:11.823025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6c3e50>]}
[0m14:12:11.861901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732f710>]}
[0m14:12:11.862139 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:12:11.862309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4a2410>]}
[0m14:12:11.863397 [info ] [MainThread]: 
[0m14:12:11.863667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:11.865555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:12:11.871925 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:12:11.872122 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:12:11.872275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:13.491346 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.619 seconds
[0m14:12:13.494815 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:12:14.084158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:12:14.095754 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:12:14.096168 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:12:14.096469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:15.902928 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.806 seconds
[0m14:12:15.907987 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:12:16.540736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d1b10>]}
[0m14:12:16.541642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:16.542068 [info ] [MainThread]: 
[0m14:12:16.544865 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:12:16.545587 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:12:16.546121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:12:16.546461 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:12:16.554110 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:12:16.555307 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:12:16.576077 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:12:16.576965 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:12:16.577235 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:12:16.577492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:18.849894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.272 seconds
[0m14:12:18.862493 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:12:19.521694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7e7750>]}
[0m14:12:19.522427 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.97s]
[0m14:12:19.522889 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:12:19.523215 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:12:19.523680 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:12:19.524180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:12:19.524457 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:12:19.525938 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:12:19.527205 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:12:19.529614 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:12:19.530812 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:12:19.531158 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:12:19.531441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:21.774159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.242 seconds
[0m14:12:21.779414 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:12:22.841053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051327d0>]}
[0m14:12:22.844398 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 3.32s]
[0m14:12:22.845495 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:12:22.846200 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:12:22.847204 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:12:22.847956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:12:22.848404 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:12:22.851816 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:12:22.853015 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:12:22.856923 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:12:22.858078 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:12:22.858409 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:12:22.858725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:24.782136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m14:12:24.789476 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:12:25.347332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17ad0>]}
[0m14:12:25.349664 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.50s]
[0m14:12:25.350561 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:12:25.351224 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:12:25.352412 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:12:25.353233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:12:25.353974 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:12:25.357323 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:12:25.358261 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:12:25.362216 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:12:25.363546 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:12:25.363937 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:12:25.364289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:27.001839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.637 seconds
[0m14:12:27.006037 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:12:27.594446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d631fd0>]}
[0m14:12:27.595848 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.24s]
[0m14:12:27.596650 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:12:27.597244 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:12:27.597903 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:12:27.598524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:12:27.598965 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:12:27.602428 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:12:27.603868 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:12:27.610254 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:12:27.611770 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:12:27.612211 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:12:27.612597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:29.332174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.719 seconds
[0m14:12:29.336207 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:12:29.954377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105689850>]}
[0m14:12:29.955302 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.36s]
[0m14:12:29.955993 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:12:29.956516 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:12:29.957198 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:12:29.957935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:12:29.958387 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:12:29.962835 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:12:29.964562 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:12:29.967702 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:12:29.968584 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:12:29.969173 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:12:29.969601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:31.644393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.674 seconds
[0m14:12:31.649220 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:12:32.310640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051327d0>]}
[0m14:12:32.311704 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m14:12:32.312407 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:12:32.312909 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:12:32.313563 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:12:32.314166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:12:32.314621 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:12:32.318107 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:12:32.318954 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:12:32.322390 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:12:32.323413 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:12:32.323741 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:12:32.324064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:34.110239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.786 seconds
[0m14:12:34.115492 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:12:34.766064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106495010>]}
[0m14:12:34.767915 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.45s]
[0m14:12:34.768980 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:12:34.769689 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:12:34.770440 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:12:34.771062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:12:34.771518 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:12:34.784447 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:12:34.785819 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:12:34.811586 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:12:34.812013 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        gd.details_GAME_ID as details_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:12:34.812327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:36.428780 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86100-0102-31cd-0006-c35e00044666
[0m14:12:36.429597 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 97 at position 4
invalid identifier 'GAME_ID'
[0m14:12:36.430339 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:12:37.028965 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 97 at position 4
  invalid identifier 'GAME_ID'
[0m14:12:37.030001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289b8990>]}
[0m14:12:37.030940 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.26s]
[0m14:12:37.031578 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:12:37.032004 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:12:37.033677 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:12:37.034230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:12:37.034571 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:12:37.038511 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:12:37.039545 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:12:37.042394 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:12:37.043895 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:12:37.044280 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:12:37.044630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:38.842271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.797 seconds
[0m14:12:38.847460 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:12:39.425764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d9e82a-f9c5-4e35-b37f-d8ebb38e9eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a7d450>]}
[0m14:12:39.427658 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.39s]
[0m14:12:39.428927 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:12:39.429709 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:12:39.430395 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:12:39.431102 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:12:39.433449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:39.433869 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:12:39.434441 [info ] [MainThread]: 
[0m14:12:39.434869 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 27.57 seconds (27.57s).
[0m14:12:39.436947 [debug] [MainThread]: Command end result
[0m14:12:39.471074 [info ] [MainThread]: 
[0m14:12:39.471462 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:12:39.471651 [info ] [MainThread]: 
[0m14:12:39.471893 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 97 at position 4
  invalid identifier 'GAME_ID'
[0m14:12:39.472079 [info ] [MainThread]: 
[0m14:12:39.472298 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:12:39.475152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.31936, "process_user_time": 2.086248, "process_kernel_time": 0.349346, "process_mem_max_rss": "190267392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:39.475621 [debug] [MainThread]: Command `dbt run` failed at 14:12:39.475576 after 28.32 seconds
[0m14:12:39.476023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030bd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030bcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c859d0>]}
[0m14:12:39.476225 [debug] [MainThread]: Flushing usage events
[0m14:15:48.355282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c656d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7ffd0>]}


============================== 14:15:48.357921 | 463ff6b1-e031-45cc-84f6-dfff897d8ebf ==============================
[0m14:15:48.357921 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:15:48.358232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:15:49.129042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2b9d0>]}
[0m14:15:49.148392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c5e10>]}
[0m14:15:49.148945 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:15:49.209236 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:15:49.249231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:49.249432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:49.260084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e38bc10>]}
[0m14:15:49.298313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e333f10>]}
[0m14:15:49.298544 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:15:49.298708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e37d9d0>]}
[0m14:15:49.299798 [info ] [MainThread]: 
[0m14:15:49.300063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:49.302109 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:15:49.308743 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:15:49.308908 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:15:49.309030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:51.318415 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.009 seconds
[0m14:15:51.323202 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:15:51.894530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:15:51.908907 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:15:51.909486 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:15:51.909843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:53.864117 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.954 seconds
[0m14:15:53.869412 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:15:54.516504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708b8d0>]}
[0m14:15:54.518387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:54.521253 [info ] [MainThread]: 
[0m14:15:54.524501 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:15:54.525115 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:15:54.525723 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:15:54.526027 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:15:54.545999 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:15:54.547167 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:15:54.571386 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:15:54.573163 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:15:54.573488 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:15:54.573698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:56.573242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.999 seconds
[0m14:15:56.637547 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:15:57.243419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e44f990>]}
[0m14:15:57.274914 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.72s]
[0m14:15:57.292058 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:15:57.293243 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:15:57.293716 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:15:57.297335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:15:57.300884 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:15:57.337320 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:15:57.346384 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:15:57.371641 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:15:57.373311 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:15:57.380562 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:15:57.381048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:59.129946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.749 seconds
[0m14:15:59.134975 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:15:59.675324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e720410>]}
[0m14:15:59.676659 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.38s]
[0m14:15:59.677496 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:15:59.678077 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:15:59.678818 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:15:59.679427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:15:59.680224 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:15:59.682096 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:15:59.682679 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:15:59.685806 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:15:59.686998 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:15:59.687328 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:15:59.687644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.244824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.556 seconds
[0m14:16:01.250480 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:16:01.819013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107059cd0>]}
[0m14:16:01.821573 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.14s]
[0m14:16:01.826786 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:16:01.828447 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:16:01.869942 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:16:01.870807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:16:01.871226 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:16:01.874013 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:16:01.876010 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:16:01.897409 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:16:01.898837 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:16:01.899293 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:16:01.899521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:03.641880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.741 seconds
[0m14:16:03.658219 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:16:04.200146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869ac10>]}
[0m14:16:04.202359 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.33s]
[0m14:16:04.203538 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:16:04.204400 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:16:04.205296 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:16:04.206132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:16:04.206600 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:16:04.210245 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:16:04.211459 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:16:04.218538 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:16:04.219535 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:16:04.219802 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:16:04.220039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:06.016957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.796 seconds
[0m14:16:06.021007 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:16:06.632978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e1b90>]}
[0m14:16:06.634555 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.43s]
[0m14:16:06.635580 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:16:06.636296 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:16:06.637455 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:16:06.638104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:16:06.638592 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:16:06.643590 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:16:06.644438 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:16:06.647739 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:16:06.648330 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:16:06.648514 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:16:06.648681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:08.438320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m14:16:08.442066 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:16:08.981482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c66dd0>]}
[0m14:16:08.983324 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.34s]
[0m14:16:08.984326 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:16:08.985014 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:16:08.985783 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:16:08.986389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:16:08.986901 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:16:08.992700 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:16:08.993757 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:16:08.997678 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:16:08.998875 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:16:08.999289 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:16:08.999683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:10.852965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.853 seconds
[0m14:16:10.858259 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:16:11.445627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c5f90>]}
[0m14:16:11.447321 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.46s]
[0m14:16:11.448249 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:16:11.448904 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:16:11.449690 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:16:11.450431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:16:11.450926 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:16:11.465471 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:16:11.467444 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:16:11.493555 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:16:11.493975 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        g.GAME_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:16:11.494325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:13.497955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.003 seconds
[0m14:16:13.512832 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:16:13.513511 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:16:13.814949 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.301 seconds
[0m14:16:13.825147 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:16:13.825876 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:16:14.110536 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.284 seconds
[0m14:16:14.125153 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:16:14.125647 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:16:14.414900 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.289 seconds
[0m14:16:14.450481 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:16:14.452916 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:16:14.453174 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:16:14.810930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m14:16:14.812346 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:16:14.813217 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(game_id, player_id) = DBT_INTERNAL_DEST.concat(game_id, player_id)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:16:15.162844 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86104-0102-31cd-0006-c35e00044686
[0m14:16:15.163689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_ID'
[0m14:16:15.164366 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:16:15.728508 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:16:15.729204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7f2890>]}
[0m14:16:15.729988 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.28s]
[0m14:16:15.730693 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:16:15.731194 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:16:15.733147 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:16:15.733749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:16:15.734081 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:16:15.737421 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:16:15.738530 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:16:15.741258 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:16:15.742850 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:16:15.743281 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:16:15.743638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:17.534478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.790 seconds
[0m14:16:17.541831 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:16:18.095611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463ff6b1-e031-45cc-84f6-dfff897d8ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6170d0>]}
[0m14:16:18.097129 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.36s]
[0m14:16:18.098233 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:16:18.098906 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:16:18.099665 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:16:18.100182 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:16:18.102632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:18.102935 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:16:18.103109 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:16:18.103420 [info ] [MainThread]: 
[0m14:16:18.103620 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.80 seconds (28.80s).
[0m14:16:18.105305 [debug] [MainThread]: Command end result
[0m14:16:18.188256 [info ] [MainThread]: 
[0m14:16:18.188878 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:16:18.189053 [info ] [MainThread]: 
[0m14:16:18.189265 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:16:18.189418 [info ] [MainThread]: 
[0m14:16:18.189931 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:16:18.194932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.874517, "process_user_time": 2.033688, "process_kernel_time": 0.50479, "process_mem_max_rss": "187842560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:18.196128 [debug] [MainThread]: Command `dbt run` failed at 14:16:18.195962 after 29.88 seconds
[0m14:16:18.196847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053215d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105320d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7f9d0>]}
[0m14:16:18.197093 [debug] [MainThread]: Flushing usage events
[0m14:23:02.809583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f3f90>]}


============================== 14:23:02.813191 | f808d5af-e0e5-4df3-8b22-d6bd633ed83c ==============================
[0m14:23:02.813191 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:23:02.813523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:03.586624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24e50>]}
[0m14:23:03.605981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628da10>]}
[0m14:23:03.606534 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:23:03.667114 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:23:03.699892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:03.700085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:03.710299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f107950>]}
[0m14:23:03.749210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f15c510>]}
[0m14:23:03.749454 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:23:03.749620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0e6a10>]}
[0m14:23:03.750713 [info ] [MainThread]: 
[0m14:23:03.750975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:03.752925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:23:03.759598 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:23:03.759775 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:23:03.759922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:05.786185 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.026 seconds
[0m14:23:05.789241 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:23:06.432506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:23:06.446048 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:23:06.446556 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:23:06.446870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:08.011221 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.564 seconds
[0m14:23:08.015188 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:23:08.612181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f138d10>]}
[0m14:23:08.612633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:08.612861 [info ] [MainThread]: 
[0m14:23:08.614981 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:23:08.615320 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:23:08.615634 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:23:08.615826 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:23:08.620303 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:23:08.621519 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:23:08.636846 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:23:08.637642 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:23:08.637850 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:23:08.638034 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:10.645073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.006 seconds
[0m14:23:10.670726 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:23:11.250525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e2e90>]}
[0m14:23:11.252105 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.63s]
[0m14:23:11.252974 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:23:11.253601 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:23:11.255591 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:23:11.256404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:23:11.256916 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:23:11.259387 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:23:11.261089 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:23:11.265217 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:23:11.266872 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:23:11.267316 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:23:11.267704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:13.215089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.947 seconds
[0m14:23:13.217282 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:23:13.741639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dad6d10>]}
[0m14:23:13.744777 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.48s]
[0m14:23:13.746264 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:23:13.746831 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:23:13.747426 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:23:13.747844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:23:13.748102 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:23:13.750116 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:23:13.750843 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:23:13.754523 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:23:13.755296 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:23:13.755565 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:23:13.755789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:15.291089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m14:23:15.296488 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:23:15.866859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625b950>]}
[0m14:23:15.869084 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.12s]
[0m14:23:15.870110 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:23:15.870765 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:23:15.872068 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:23:15.872718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:23:15.873151 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:23:15.876551 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:23:15.878635 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:23:15.882460 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:23:15.883809 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:23:15.884217 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:23:15.884597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:17.598675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.714 seconds
[0m14:23:17.604215 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:23:18.147633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f792150>]}
[0m14:23:18.148739 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.27s]
[0m14:23:18.149591 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:23:18.150381 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:23:18.151272 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:23:18.151907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:23:18.152403 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:23:18.155803 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:23:18.156799 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:23:18.159770 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:23:18.160507 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:23:18.160701 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:23:18.160907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:19.801910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.641 seconds
[0m14:23:19.808496 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:23:20.350347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6f9550>]}
[0m14:23:20.351954 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.20s]
[0m14:23:20.352910 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:23:20.353525 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:23:20.354589 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:23:20.355322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:23:20.355807 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:23:20.361111 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:23:20.362712 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:23:20.366328 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:23:20.367483 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:23:20.367880 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:23:20.368239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:22.130501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.762 seconds
[0m14:23:22.134989 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:23:22.744742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6e2710>]}
[0m14:23:22.745466 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.39s]
[0m14:23:22.745967 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:23:22.746401 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:23:22.747058 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:23:22.747540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:23:22.747873 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:23:22.751207 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:23:22.751828 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:23:22.754365 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:23:22.755216 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:23:22.755513 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:23:22.755794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:24.354787 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.598 seconds
[0m14:23:24.360899 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:23:25.050211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d69050>]}
[0m14:23:25.052118 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.30s]
[0m14:23:25.053151 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:23:25.053836 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:23:25.054661 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:23:25.055312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:23:25.055736 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:23:25.067966 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:23:25.069838 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:23:25.095472 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:23:25.095848 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        g.GAME_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:23:25.096187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:27.064632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.968 seconds
[0m14:23:27.078457 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:23:27.079051 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:23:27.399800 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.320 seconds
[0m14:23:27.406447 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:23:27.406942 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:23:27.711023 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.304 seconds
[0m14:23:27.716053 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:23:27.716291 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:23:28.004362 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.287 seconds
[0m14:23:28.045133 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:23:28.047127 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:23:28.047406 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:23:28.371287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m14:23:28.372688 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:23:28.373488 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(g.game_id, player_id) = DBT_INTERNAL_DEST.concat(g.game_id, player_id)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:23:28.713422 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8610b-0102-31cd-0006-c35e0004478e
[0m14:23:28.714124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 43
invalid identifier 'G.GAME_ID'
[0m14:23:28.714860 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:23:29.298820 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 4 at position 43
  invalid identifier 'G.GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:23:29.299880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f993b10>]}
[0m14:23:29.300682 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.24s]
[0m14:23:29.301504 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:23:29.301929 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:23:29.303377 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:23:29.303811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:23:29.304098 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:23:29.307345 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:23:29.308203 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:23:29.310761 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:23:29.312339 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:23:29.312786 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:23:29.313145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:31.028898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.715 seconds
[0m14:23:31.035434 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:23:31.659203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f808d5af-e0e5-4df3-8b22-d6bd633ed83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f113910>]}
[0m14:23:31.661348 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:23:31.662285 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:23:31.662841 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:23:31.663494 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:23:31.664067 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:23:31.666597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:31.667168 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:23:31.667537 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:23:31.668503 [info ] [MainThread]: 
[0m14:23:31.669071 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 27.92 seconds (27.92s).
[0m14:23:31.671100 [debug] [MainThread]: Command end result
[0m14:23:31.705843 [info ] [MainThread]: 
[0m14:23:31.706164 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:23:31.706360 [info ] [MainThread]: 
[0m14:23:31.706598 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 4 at position 43
  invalid identifier 'G.GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:23:31.706789 [info ] [MainThread]: 
[0m14:23:31.706986 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:23:31.710702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.930923, "process_user_time": 2.087258, "process_kernel_time": 0.440201, "process_mem_max_rss": "192282624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:23:31.711133 [debug] [MainThread]: Command `dbt run` failed at 14:23:31.711081 after 28.93 seconds
[0m14:23:31.711438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a13f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a13e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103508d10>]}
[0m14:23:31.711679 [debug] [MainThread]: Flushing usage events
[0m14:25:22.492536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067da510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b91d10>]}


============================== 14:25:22.496556 | f92464b0-2f2a-49e8-8224-ff14f15b7ab4 ==============================
[0m14:25:22.496556 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:25:22.496884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:25:23.021019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b458d0>]}
[0m14:25:23.040449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f1f10>]}
[0m14:25:23.040990 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:25:23.100778 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:25:23.137805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:23.138030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:23.148411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4c4f50>]}
[0m14:25:23.191036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f422610>]}
[0m14:25:23.191287 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:25:23.191452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f446f90>]}
[0m14:25:23.192582 [info ] [MainThread]: 
[0m14:25:23.192857 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:23.194763 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:25:23.201002 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:25:23.201182 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:25:23.201336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:25.002163 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.801 seconds
[0m14:25:25.006030 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:25:25.628660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:25:25.642900 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:25:25.643406 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:25:25.643738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:27.119178 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.474 seconds
[0m14:25:27.128616 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:25:27.673114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106016690>]}
[0m14:25:27.678977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:27.723779 [info ] [MainThread]: 
[0m14:25:27.772299 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:25:27.773585 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:25:27.774188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:25:27.774415 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:25:27.781651 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:25:27.782732 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:25:27.803433 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:25:27.804337 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:25:27.804586 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:25:27.804847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:29.685697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.880 seconds
[0m14:25:29.711574 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:25:30.243664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b7fc50>]}
[0m14:25:30.245539 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.47s]
[0m14:25:30.246647 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:25:30.247361 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:25:30.248425 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:25:30.249215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:25:30.249648 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:25:30.253881 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:25:30.256150 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:25:30.260090 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:25:30.261720 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:25:30.262280 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:25:30.262914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:32.177926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.914 seconds
[0m14:25:32.200687 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:25:32.748540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1281277d0>]}
[0m14:25:32.749421 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.50s]
[0m14:25:32.750082 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:25:32.750555 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:25:32.751161 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:25:32.751641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:25:32.752003 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:25:32.754555 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:25:32.755532 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:25:32.759518 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:25:32.760685 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:25:32.761045 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:25:32.761519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:34.436001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.674 seconds
[0m14:25:34.439288 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:25:35.049042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d9750>]}
[0m14:25:35.054064 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.30s]
[0m14:25:35.055066 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:25:35.055728 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:25:35.056822 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:25:35.057699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:25:35.058338 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:25:35.061633 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:25:35.062765 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:25:35.066504 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:25:35.067790 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:25:35.068277 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:25:35.068701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:36.715711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.647 seconds
[0m14:25:36.721063 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:25:37.401118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12815d210>]}
[0m14:25:37.401819 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.34s]
[0m14:25:37.402320 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:25:37.402674 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:25:37.403138 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:25:37.403541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:25:37.403814 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:25:37.405298 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:25:37.405810 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:25:37.409833 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:25:37.410909 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:25:37.411188 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:25:37.411457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:39.346537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.934 seconds
[0m14:25:39.354218 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:25:39.965899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a57350>]}
[0m14:25:39.967849 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.56s]
[0m14:25:39.968932 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:25:39.969649 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:25:39.970739 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:25:39.971338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:25:39.971742 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:25:39.978122 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:25:39.980404 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:25:39.983636 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:25:39.984734 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:25:39.985114 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:25:39.985465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:41.700450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.715 seconds
[0m14:25:41.704284 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:25:42.316796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105783850>]}
[0m14:25:42.317536 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m14:25:42.318177 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:25:42.318654 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:25:42.319598 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:25:42.319917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:25:42.320125 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:25:42.322139 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:25:42.322877 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:25:42.325238 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:25:42.326022 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:25:42.326247 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:25:42.326465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:44.091786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.764 seconds
[0m14:25:44.098859 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:25:44.647265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1a4350>]}
[0m14:25:44.648574 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.33s]
[0m14:25:44.649539 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:25:44.650253 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:25:44.651127 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:25:44.652152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:25:44.652890 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:25:44.664986 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:25:44.666659 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:25:44.692735 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:25:44.693173 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        -- g.GAME_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:25:44.693559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:46.586700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.893 seconds
[0m14:25:46.602036 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:25:46.602729 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:25:46.906583 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.303 seconds
[0m14:25:46.915798 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:25:46.916330 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:25:47.199296 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.282 seconds
[0m14:25:47.214646 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:25:47.215149 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:25:47.510426 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.295 seconds
[0m14:25:47.551328 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:25:47.553439 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:25:47.553741 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:25:47.869294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m14:25:47.870492 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:25:47.871162 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(DETAILS_GAME_ID, player_id) = DBT_INTERNAL_DEST.concat(DETAILS_GAME_ID, player_id)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:25:48.218500 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8610d-0102-31cd-0006-c35e000447c6
[0m14:25:48.219476 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m14:25:48.220510 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:25:48.781732 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:25:48.782991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f22aa10>]}
[0m14:25:48.783899 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.13s]
[0m14:25:48.784789 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:25:48.785391 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:25:48.787815 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:25:48.788523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:25:48.788981 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:25:48.793044 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:25:48.794134 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:25:48.796996 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:25:48.798506 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:25:48.798875 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:25:48.799297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:50.449454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.649 seconds
[0m14:25:50.455042 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:25:51.021116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92464b0-2f2a-49e8-8224-ff14f15b7ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f691650>]}
[0m14:25:51.023493 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.23s]
[0m14:25:51.024844 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:25:51.025795 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:25:51.028129 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:25:51.029105 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:25:51.033109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:51.033305 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:25:51.033570 [info ] [MainThread]: 
[0m14:25:51.033741 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 27.84 seconds (27.84s).
[0m14:25:51.034658 [debug] [MainThread]: Command end result
[0m14:25:51.056437 [info ] [MainThread]: 
[0m14:25:51.056705 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:25:51.056852 [info ] [MainThread]: 
[0m14:25:51.057034 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:25:51.057235 [info ] [MainThread]: 
[0m14:25:51.057734 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:25:51.070359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.606941, "process_user_time": 2.092113, "process_kernel_time": 0.433685, "process_mem_max_rss": "194707456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:25:51.070896 [debug] [MainThread]: Command `dbt run` failed at 14:25:51.070810 after 28.61 seconds
[0m14:25:51.071194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f24c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324d5d0>]}
[0m14:25:51.071433 [debug] [MainThread]: Flushing usage events
[0m14:27:12.078861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba3f90>]}


============================== 14:27:12.081699 | 4e25c627-6036-406a-8a22-0fae0f2ec679 ==============================
[0m14:27:12.081699 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:27:12.081995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:12.832388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f6c490>]}
[0m14:27:12.851470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f5d90>]}
[0m14:27:12.852014 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:27:12.915819 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:27:12.949679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:12.949925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:12.960515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a283590>]}
[0m14:27:12.998591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2bc450>]}
[0m14:27:12.998837 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:27:12.999005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cb410>]}
[0m14:27:13.000101 [info ] [MainThread]: 
[0m14:27:13.000368 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:13.002525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:27:13.008523 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:27:13.008681 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:27:13.008807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:14.844075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.835 seconds
[0m14:27:14.847883 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:27:15.481419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:27:15.495745 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:27:15.496243 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:27:15.496566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:17.138761 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.642 seconds
[0m14:27:17.143148 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:27:17.746540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a360250>]}
[0m14:27:17.747935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:17.748448 [info ] [MainThread]: 
[0m14:27:17.752671 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:27:17.753408 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:27:17.754270 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:27:17.754768 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:27:17.762473 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:27:17.764169 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:27:17.785494 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:27:17.786466 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:27:17.786730 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:27:17.786959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:19.700883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.914 seconds
[0m14:27:19.714684 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:27:20.323119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594cc90>]}
[0m14:27:20.324854 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.57s]
[0m14:27:20.326001 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:27:20.326645 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:27:20.327495 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:27:20.328191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:27:20.328629 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:27:20.331136 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:27:20.333522 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:27:20.337572 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:27:20.339131 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:27:20.339552 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:27:20.339922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:22.592906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.253 seconds
[0m14:27:22.595741 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:27:23.185050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a3710>]}
[0m14:27:23.185937 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.86s]
[0m14:27:23.186362 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:27:23.186642 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:27:23.187020 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:27:23.187388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:27:23.187620 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:27:23.188878 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:27:23.190786 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:27:23.193135 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:27:23.193735 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:27:23.193942 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:27:23.194133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:24.951046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.757 seconds
[0m14:27:24.954607 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:27:25.497939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103631b50>]}
[0m14:27:25.499484 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.31s]
[0m14:27:25.500822 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:27:25.501563 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:27:25.502637 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:27:25.503288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:27:25.503737 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:27:25.507803 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:27:25.508968 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:27:25.512581 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:27:25.513949 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:27:25.514348 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:27:25.514722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:27.163609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.648 seconds
[0m14:27:27.169720 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:27:27.754713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d9910>]}
[0m14:27:27.755825 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.25s]
[0m14:27:27.756683 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:27:27.757298 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:27:27.757930 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:27:27.758401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:27:27.758760 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:27:27.761771 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:27:27.762846 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:27:27.767277 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:27:27.768154 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:27:27.768409 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:27:27.768619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:29.475231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.707 seconds
[0m14:27:29.478203 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:27:30.019383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104011810>]}
[0m14:27:30.020564 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.26s]
[0m14:27:30.021441 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:27:30.021944 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:27:30.022460 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:27:30.023070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:27:30.023513 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:27:30.033752 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:27:30.035439 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:27:30.039005 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:27:30.040142 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:27:30.040930 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:27:30.041705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:31.838664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.795 seconds
[0m14:27:31.848108 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:27:32.382885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2dc090>]}
[0m14:27:32.385136 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.36s]
[0m14:27:32.386821 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:27:32.405697 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:27:32.406945 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:27:32.407822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:27:32.408091 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:27:32.411389 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:27:32.411852 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:27:32.413594 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:27:32.414200 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:27:32.414444 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:27:32.414672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:34.341878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.926 seconds
[0m14:27:34.347766 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:27:34.936570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b36a50>]}
[0m14:27:34.939701 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.53s]
[0m14:27:34.945346 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:27:34.946051 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:27:34.946894 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:27:34.947606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:27:34.948073 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:27:34.959724 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:27:34.962095 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:27:34.985979 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:27:34.986353 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:27:34.986689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:37.105103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.118 seconds
[0m14:27:37.116428 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:27:37.116938 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:27:37.412835 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.295 seconds
[0m14:27:37.418473 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:27:37.418992 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:27:37.722157 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.302 seconds
[0m14:27:37.734530 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:27:37.735098 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:27:38.029955 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.294 seconds
[0m14:27:38.066522 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:27:38.069562 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:27:38.069840 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:27:38.374286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m14:27:38.375028 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:27:38.376403 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(DETAILS_GAME_ID, player_id) = DBT_INTERNAL_DEST.concat(DETAILS_GAME_ID, player_id)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:27:38.731976 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8610f-0102-32a8-0006-c35e0004850e
[0m14:27:38.732914 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m14:27:38.733741 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:27:39.288516 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:27:39.289241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f3050>]}
[0m14:27:39.289829 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.34s]
[0m14:27:39.290221 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:27:39.290498 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:27:39.291549 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:27:39.291816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:27:39.292006 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:27:39.294895 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:27:39.295619 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:27:39.297736 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:27:39.298724 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:27:39.299001 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:27:39.299276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:41.047361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m14:27:41.055601 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:27:41.619061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e25c627-6036-406a-8a22-0fae0f2ec679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc0510>]}
[0m14:27:41.620507 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.33s]
[0m14:27:41.623281 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:27:41.647859 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:27:41.650507 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:27:41.650982 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:27:41.652266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:41.652578 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:27:41.652736 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:27:41.653043 [info ] [MainThread]: 
[0m14:27:41.653358 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.65 seconds (28.65s).
[0m14:27:41.656889 [debug] [MainThread]: Command end result
[0m14:27:41.682552 [info ] [MainThread]: 
[0m14:27:41.682826 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:27:41.683004 [info ] [MainThread]: 
[0m14:27:41.683500 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:27:41.683806 [info ] [MainThread]: 
[0m14:27:41.684000 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:27:41.688317 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.639658, "process_user_time": 2.048236, "process_kernel_time": 0.415456, "process_mem_max_rss": "196034560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:41.688698 [debug] [MainThread]: Command `dbt run` failed at 14:27:41.688655 after 29.64 seconds
[0m14:27:41.688966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba2490>]}
[0m14:27:41.689144 [debug] [MainThread]: Flushing usage events
[0m14:28:43.071267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10883b910>]}


============================== 14:28:43.074048 | 6e760925-5b0f-4a1a-9f38-89f6c86162b9 ==============================
[0m14:28:43.074048 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:28:43.074346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:28:43.602638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0d090>]}
[0m14:28:43.621369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b9cd0>]}
[0m14:28:43.621858 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:28:43.681545 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:28:43.731346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:43.731551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:43.742043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df0a450>]}
[0m14:28:43.780656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df2bcd0>]}
[0m14:28:43.780952 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:28:43.781122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b738c10>]}
[0m14:28:43.782337 [info ] [MainThread]: 
[0m14:28:43.782630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:43.784737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:28:43.791084 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:28:43.791263 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:28:43.791391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:45.843544 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.052 seconds
[0m14:28:45.847288 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:28:46.404792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:28:46.415029 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:28:46.415422 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:28:46.415839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:48.021360 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.605 seconds
[0m14:28:48.022934 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:28:48.686938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc72910>]}
[0m14:28:48.687670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:48.688049 [info ] [MainThread]: 
[0m14:28:48.690738 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:28:48.691209 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:28:48.691651 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:28:48.691931 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:28:48.697415 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:28:48.698938 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:28:48.717730 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:28:48.719087 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:28:48.719368 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:28:48.719593 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:50.631798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.912 seconds
[0m14:28:50.653674 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:28:51.252006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac3990>]}
[0m14:28:51.254072 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.56s]
[0m14:28:51.254988 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:28:51.255622 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:28:51.256690 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:28:51.257585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:28:51.258367 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:28:51.261364 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:28:51.263429 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:28:51.267473 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:28:51.269171 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:28:51.269620 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:28:51.270020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:53.128919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.859 seconds
[0m14:28:53.132078 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:28:53.707206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa7950>]}
[0m14:28:53.708727 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.45s]
[0m14:28:53.709708 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:28:53.710541 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:28:53.711321 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:28:53.711917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:28:53.712357 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:28:53.714892 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:28:53.716686 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:28:53.720467 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:28:53.721653 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:28:53.722055 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:28:53.722404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:55.274346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.552 seconds
[0m14:28:55.278330 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:28:55.856809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f65690>]}
[0m14:28:55.857896 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.14s]
[0m14:28:55.858642 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:28:55.859256 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:28:55.860054 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:28:55.860708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:28:55.861174 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:28:55.863649 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:28:55.865600 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:28:55.868753 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:28:55.870150 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:28:55.870870 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:28:55.871456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:57.798951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.927 seconds
[0m14:28:57.802355 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:28:58.423400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbe9650>]}
[0m14:28:58.424453 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.56s]
[0m14:28:58.425169 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:28:58.425702 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:28:58.426387 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:28:58.427038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:28:58.427480 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:28:58.429777 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:28:58.431648 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:28:58.436489 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:28:58.437962 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:28:58.438554 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:28:58.438990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:00.196657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.758 seconds
[0m14:29:00.197913 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:29:00.731690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5b78d0>]}
[0m14:29:00.733542 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.30s]
[0m14:29:00.734477 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:29:00.735137 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:29:00.736031 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:29:00.736700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:29:00.737158 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:29:00.742748 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:29:00.745033 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:29:00.748252 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:29:00.749288 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:29:00.749670 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:29:00.750017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:02.331651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.581 seconds
[0m14:29:02.337043 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:29:02.884999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a1c50>]}
[0m14:29:02.886482 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.15s]
[0m14:29:02.887341 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:29:02.887959 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:29:02.888731 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:29:02.889305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:29:02.889758 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:29:02.894661 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:29:02.895656 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:29:02.900101 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:29:02.901245 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:29:02.901605 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:29:02.901892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:04.679706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.777 seconds
[0m14:29:04.685949 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:29:05.277852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c97b50>]}
[0m14:29:05.279469 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.39s]
[0m14:29:05.280240 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:29:05.280801 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:29:05.281458 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:29:05.282263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:29:05.282752 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:29:05.294371 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:29:05.296736 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:29:05.320853 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:29:05.321238 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        GAMES_MIN,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    TEAM_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:29:05.321579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:06.924837 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86111-0102-31cd-0006-c35e00044806
[0m14:29:06.925455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 67 at position 8
invalid identifier 'GD.GAME_TEAM_ID'
[0m14:29:06.926030 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:29:07.528195 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 67 at position 8
  invalid identifier 'GD.GAME_TEAM_ID'
[0m14:29:07.529247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbcfc10>]}
[0m14:29:07.530161 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.25s]
[0m14:29:07.530891 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:29:07.531403 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:29:07.533264 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:29:07.534044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:29:07.534463 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:29:07.538672 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:29:07.539907 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:29:07.543250 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:29:07.544598 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:29:07.544959 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:29:07.545295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:09.297596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.752 seconds
[0m14:29:09.301203 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:29:09.839024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e760925-5b0f-4a1a-9f38-89f6c86162b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d6390>]}
[0m14:29:09.840836 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.30s]
[0m14:29:09.841727 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:29:09.842445 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:29:09.843270 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:29:09.843889 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:29:09.846175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:09.846604 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:29:09.846944 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:29:09.847550 [info ] [MainThread]: 
[0m14:29:09.848092 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 26.06 seconds (26.06s).
[0m14:29:09.849739 [debug] [MainThread]: Command end result
[0m14:29:09.881054 [info ] [MainThread]: 
[0m14:29:09.881339 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:29:09.881525 [info ] [MainThread]: 
[0m14:29:09.881745 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 67 at position 8
  invalid identifier 'GD.GAME_TEAM_ID'
[0m14:29:09.881938 [info ] [MainThread]: 
[0m14:29:09.882124 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:29:09.884423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.842085, "process_user_time": 1.984537, "process_kernel_time": 0.3294, "process_mem_max_rss": "190447616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:29:09.884929 [debug] [MainThread]: Command `dbt run` failed at 14:29:09.884867 after 26.84 seconds
[0m14:29:09.885238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f154d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f155d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e214950>]}
[0m14:29:09.885450 [debug] [MainThread]: Flushing usage events
[0m14:30:02.494751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff3e90>]}


============================== 14:30:02.497662 | 052e7417-06a8-4878-aec9-8d9f0e7dc469 ==============================
[0m14:30:02.497662 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:30:02.497979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:03.020691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f99d90>]}
[0m14:30:03.040271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a45f90>]}
[0m14:30:03.040814 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:30:03.104273 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:30:03.137014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:03.137196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:03.147484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfdecd0>]}
[0m14:30:03.186567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd39010>]}
[0m14:30:03.186813 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:30:03.186986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cb88110>]}
[0m14:30:03.188156 [info ] [MainThread]: 
[0m14:30:03.188424 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:30:03.190389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:30:03.196375 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:30:03.196525 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:30:03.196649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:04.883238 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.686 seconds
[0m14:30:04.886302 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:30:05.449766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:30:05.463945 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:30:05.464407 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:30:05.464712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:07.034568 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.570 seconds
[0m14:30:07.039846 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:30:07.636622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1e0dd0>]}
[0m14:30:07.637023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:07.637232 [info ] [MainThread]: 
[0m14:30:07.638557 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:30:07.638838 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:30:07.639083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:30:07.639269 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:30:07.643074 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:30:07.644047 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:30:07.658693 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:30:07.659437 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:30:07.659647 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:30:07.659834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:09.683487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.023 seconds
[0m14:30:09.712742 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:30:10.304278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2911d0>]}
[0m14:30:10.305494 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.66s]
[0m14:30:10.306286 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:30:10.306824 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:30:10.307608 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:30:10.308247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:30:10.308669 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:30:10.311014 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:30:10.313608 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:30:10.317525 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:30:10.319010 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:30:10.319375 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:30:10.319713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:12.283573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.963 seconds
[0m14:30:12.287719 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:30:12.838062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5bb050>]}
[0m14:30:12.839658 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.53s]
[0m14:30:12.840516 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:30:12.841131 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:30:12.842006 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:30:12.842728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:30:12.843201 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:30:12.846209 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:30:12.847092 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:30:12.851058 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:30:12.852175 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:30:12.852516 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:30:12.852832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:14.498581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.645 seconds
[0m14:30:14.503929 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:30:15.205769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598f950>]}
[0m14:30:15.207277 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.36s]
[0m14:30:15.208234 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:30:15.208939 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:30:15.210234 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:30:15.210913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:30:15.211375 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:30:15.216018 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:30:15.217152 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:30:15.220930 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:30:15.222339 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:30:15.222754 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:30:15.223506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:17.362482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.139 seconds
[0m14:30:17.367783 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:30:17.981379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cb8bed0>]}
[0m14:30:17.983119 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.77s]
[0m14:30:17.983937 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:30:17.984534 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:30:17.985457 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:30:17.986423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:30:17.987027 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:30:17.989601 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:30:17.991506 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:30:17.997180 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:30:17.998650 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:30:17.999054 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:30:17.999382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:19.923339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m14:30:19.927599 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:30:20.538185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f43d50>]}
[0m14:30:20.538822 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.55s]
[0m14:30:20.539261 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:30:20.539571 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:30:20.539986 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:30:20.540451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:30:20.540699 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:30:20.543246 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:30:20.544853 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:30:20.546906 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:30:20.547611 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:30:20.547857 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:30:20.548083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:22.334598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.786 seconds
[0m14:30:22.340934 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:30:23.104546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e7150>]}
[0m14:30:23.105650 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.56s]
[0m14:30:23.106275 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:30:23.106707 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:30:23.107261 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:30:23.107805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:30:23.108188 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:30:23.111595 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:30:23.112627 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:30:23.115793 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:30:23.116717 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:30:23.117039 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:30:23.117341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:24.859636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.742 seconds
[0m14:30:24.865201 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:30:25.458036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d120150>]}
[0m14:30:25.459571 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:30:25.460432 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:30:25.461007 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:30:25.461726 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:30:25.462428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:30:25.462956 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:30:25.473788 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:30:25.475548 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:30:25.499263 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:30:25.499649 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        GAMES_MIN,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    TEAM_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:30:25.499966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:27.891658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.391 seconds
[0m14:30:27.907876 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:30:27.908475 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:30:28.217010 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.308 seconds
[0m14:30:28.224439 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:30:28.224934 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:30:28.508775 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.283 seconds
[0m14:30:28.521309 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:30:28.521762 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:30:28.802272 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.280 seconds
[0m14:30:28.852001 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:30:28.854098 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:30:28.854422 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:30:29.184806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m14:30:29.186481 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:30:29.187278 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:30:29.551044 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86112-0102-32a8-0006-c35e0004854a
[0m14:30:29.552108 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 37
invalid identifier 'PLAYER_TEAM_ID'
[0m14:30:29.552860 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:30:30.089010 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 37
  invalid identifier 'PLAYER_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:30:30.089773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb1610>]}
[0m14:30:30.090507 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.63s]
[0m14:30:30.091158 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:30:30.091587 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:30:30.093475 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:30:30.093976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:30:30.094319 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:30:30.097913 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:30:30.099309 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:30:30.102235 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:30:30.103601 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:30:30.103917 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:30:30.104211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:31.926450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.822 seconds
[0m14:30:31.932022 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:30:32.531942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052e7417-06a8-4878-aec9-8d9f0e7dc469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d195e10>]}
[0m14:30:32.533173 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.44s]
[0m14:30:32.533635 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:30:32.534215 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:30:32.534745 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:30:32.535179 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:30:32.537737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:32.537958 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:30:32.538226 [info ] [MainThread]: 
[0m14:30:32.538417 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 29.35 seconds (29.35s).
[0m14:30:32.539533 [debug] [MainThread]: Command end result
[0m14:30:32.574119 [info ] [MainThread]: 
[0m14:30:32.574453 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:30:32.574666 [info ] [MainThread]: 
[0m14:30:32.574931 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 37
  invalid identifier 'PLAYER_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:30:32.575149 [info ] [MainThread]: 
[0m14:30:32.575358 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:30:32.579799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 30.115618, "process_user_time": 2.184879, "process_kernel_time": 0.354909, "process_mem_max_rss": "193593344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:30:32.580198 [debug] [MainThread]: Command `dbt run` failed at 14:30:32.580151 after 30.12 seconds
[0m14:30:32.580556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100efcd10>]}
[0m14:30:32.580827 [debug] [MainThread]: Flushing usage events
[0m14:31:33.205962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaa3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1bf90>]}


============================== 14:31:33.208797 | d43b9329-7738-4d50-ab5f-a6cd5cd67d3b ==============================
[0m14:31:33.208797 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:31:33.209096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:31:33.826509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c55cdd0>]}
[0m14:31:33.845233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106961d10>]}
[0m14:31:33.845822 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:31:33.910023 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:31:33.955721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:33.955944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:33.966768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc69d50>]}
[0m14:31:34.006553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c6bf790>]}
[0m14:31:34.006837 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:31:34.007011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5cb550>]}
[0m14:31:34.008168 [info ] [MainThread]: 
[0m14:31:34.008446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:31:34.010382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:31:34.016359 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:31:34.016513 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:31:34.016636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:35.715882 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.699 seconds
[0m14:31:35.719453 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:31:36.317666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:31:36.329707 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:31:36.330168 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:31:36.330481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:37.974485 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.644 seconds
[0m14:31:37.979008 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:31:38.566603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc69890>]}
[0m14:31:38.568920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:31:38.569531 [info ] [MainThread]: 
[0m14:31:38.573951 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:31:38.574743 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:31:38.575304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:31:38.575887 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:31:38.583775 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:31:38.585030 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:31:38.605030 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:31:38.605974 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:31:38.606236 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:31:38.606492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:40.611622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.005 seconds
[0m14:31:40.626907 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:31:41.315325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd1c0d0>]}
[0m14:31:41.316357 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.74s]
[0m14:31:41.316996 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:31:41.317462 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:31:41.318195 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:31:41.318798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:31:41.319228 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:31:41.321291 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:31:41.323502 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:31:41.326450 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:31:41.327627 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:31:41.327934 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:31:41.328221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:43.277276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.948 seconds
[0m14:31:43.282503 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:31:43.895975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f00f50>]}
[0m14:31:43.898902 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.58s]
[0m14:31:43.899803 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:31:43.900390 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:31:43.901122 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:31:43.901944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:31:43.902704 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:31:43.905432 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:31:43.906529 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:31:43.910694 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:31:43.911840 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:31:43.912243 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:31:43.912612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:45.702356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m14:31:45.707325 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:31:46.355605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f33d10>]}
[0m14:31:46.357342 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.45s]
[0m14:31:46.358293 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:31:46.358953 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:31:46.360355 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:31:46.361200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:31:46.361673 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:31:46.364705 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:31:46.365845 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:31:46.369164 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:31:46.370707 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:31:46.371246 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:31:46.371632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:48.196256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.824 seconds
[0m14:31:48.202054 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:31:48.818194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f5a90>]}
[0m14:31:48.820111 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.46s]
[0m14:31:48.821046 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:31:48.821738 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:31:48.822490 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:31:48.823141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:31:48.823570 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:31:48.827059 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:31:48.829397 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:31:48.835594 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:31:48.837089 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:31:48.837576 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:31:48.838036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:50.751844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.913 seconds
[0m14:31:50.757364 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:31:51.371362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c9fdc50>]}
[0m14:31:51.373241 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.55s]
[0m14:31:51.374109 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:31:51.374744 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:31:51.375717 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:31:51.376364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:31:51.377251 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:31:51.382051 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:31:51.383515 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:31:51.387659 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:31:51.388742 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:31:51.389168 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:31:51.389829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:53.109356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.719 seconds
[0m14:31:53.111139 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:31:53.675335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4daa90>]}
[0m14:31:53.677382 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.30s]
[0m14:31:53.678211 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:31:53.678997 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:31:53.680195 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:31:53.680955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:31:53.681425 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:31:53.685905 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:31:53.686913 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:31:53.690610 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:31:53.691600 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:31:53.691972 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:31:53.692311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:55.563568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.871 seconds
[0m14:31:55.567491 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:31:56.180833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b60990>]}
[0m14:31:56.181730 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.50s]
[0m14:31:56.182385 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:31:56.182880 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:31:56.183399 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:31:56.183807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:31:56.184119 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:31:56.192725 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:31:56.193912 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:31:56.216486 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:31:56.216843 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        GAMES_MIN,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    TEAM_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:31:56.217114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:58.227679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.010 seconds
[0m14:31:58.241888 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:31:58.242482 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:31:58.569908 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.327 seconds
[0m14:31:58.578265 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:31:58.578834 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:31:58.859373 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.280 seconds
[0m14:31:58.871441 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:31:58.871811 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:31:59.159716 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.287 seconds
[0m14:31:59.198747 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:31:59.200839 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:31:59.201127 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:31:59.552175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m14:31:59.553103 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:31:59.553864 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(DETAILS_GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(DETAILS_GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:31:59.940320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86113-0102-32a8-0006-c35e0004856e
[0m14:31:59.940829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 37
invalid identifier 'PLAYER_TEAM_ID'
[0m14:31:59.941378 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:32:00.555236 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 37
  invalid identifier 'PLAYER_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:32:00.556050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c970390>]}
[0m14:32:00.556665 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.37s]
[0m14:32:00.557196 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:32:00.557551 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:32:00.558983 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:32:00.559373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:32:00.559665 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:32:00.562639 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:32:00.563764 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:32:00.566239 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:32:00.567887 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:32:00.568418 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:32:00.568732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:02.630586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.062 seconds
[0m14:32:02.633678 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:32:03.250220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43b9329-7738-4d50-ab5f-a6cd5cd67d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd814d0>]}
[0m14:32:03.251370 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.69s]
[0m14:32:03.252113 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:32:03.252612 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:32:03.253239 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:32:03.254109 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:32:03.256224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:03.256695 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:32:03.257258 [info ] [MainThread]: 
[0m14:32:03.257748 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 29.25 seconds (29.25s).
[0m14:32:03.259266 [debug] [MainThread]: Command end result
[0m14:32:03.315509 [info ] [MainThread]: 
[0m14:32:03.315861 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:03.316024 [info ] [MainThread]: 
[0m14:32:03.316225 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 37
  invalid identifier 'PLAYER_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:32:03.316380 [info ] [MainThread]: 
[0m14:32:03.316535 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:32:03.320781 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 30.144627, "process_user_time": 2.142703, "process_kernel_time": 0.37563, "process_mem_max_rss": "196886528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:32:03.321114 [debug] [MainThread]: Command `dbt run` failed at 14:32:03.321072 after 30.15 seconds
[0m14:32:03.321348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035bd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035bcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105215190>]}
[0m14:32:03.321530 [debug] [MainThread]: Flushing usage events
[0m14:33:30.316570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f3fd0>]}


============================== 14:33:30.319863 | e7154e34-3d08-49ff-a81e-45dbdb98d1b5 ==============================
[0m14:33:30.319863 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:33:30.320221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:33:30.853416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107912010>]}
[0m14:33:30.872348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107245e90>]}
[0m14:33:30.873088 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:33:30.932676 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:33:30.965009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:33:30.965420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:33:30.975704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113085f10>]}
[0m14:33:31.021554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11702fc90>]}
[0m14:33:31.021802 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:33:31.021971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116746bd0>]}
[0m14:33:31.023122 [info ] [MainThread]: 
[0m14:33:31.023394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:31.025301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:33:31.031704 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:33:31.031857 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:33:31.031981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:32.776279 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.744 seconds
[0m14:33:32.780134 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:33:33.340193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:33:33.349004 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:33:33.349365 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:33:33.349629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:34.934151 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.584 seconds
[0m14:33:34.938875 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:33:35.525596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105496f90>]}
[0m14:33:35.526961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:35.527633 [info ] [MainThread]: 
[0m14:33:35.531472 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:33:35.532191 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:33:35.532832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:33:35.533436 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:33:35.541419 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:33:35.542538 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:33:35.563430 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:33:35.564324 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:33:35.564583 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:33:35.564847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:37.454035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.889 seconds
[0m14:33:37.480857 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:33:38.073530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117044910>]}
[0m14:33:38.075005 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.54s]
[0m14:33:38.076070 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:33:38.076774 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:33:38.077683 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:33:38.078449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:33:38.078906 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:33:38.081327 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:33:38.084048 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:33:38.087949 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:33:38.089581 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:33:38.090025 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:33:38.090421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:40.015139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m14:33:40.022762 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:33:40.574068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117046bd0>]}
[0m14:33:40.575551 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.50s]
[0m14:33:40.576446 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:33:40.577031 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:33:40.578046 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:33:40.578731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:33:40.579208 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:33:40.582269 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:33:40.583107 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:33:40.586678 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:33:40.587567 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:33:40.587891 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:33:40.588192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:42.259678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.671 seconds
[0m14:33:42.265132 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:33:42.809621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174bcb90>]}
[0m14:33:42.811302 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.23s]
[0m14:33:42.812245 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:33:42.812825 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:33:42.813733 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:33:42.814404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:33:42.814926 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:33:42.817793 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:33:42.818737 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:33:42.822153 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:33:42.823447 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:33:42.823841 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:33:42.824208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:44.600845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.776 seconds
[0m14:33:44.606423 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:33:45.143380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608ccd0>]}
[0m14:33:45.145100 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.33s]
[0m14:33:45.146078 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:33:45.146788 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:33:45.147565 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:33:45.148221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:33:45.148714 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:33:45.152753 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:33:45.154068 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:33:45.160028 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:33:45.161528 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:33:45.161933 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:33:45.162315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:47.021306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.859 seconds
[0m14:33:47.026576 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:33:47.663434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788ee10>]}
[0m14:33:47.665036 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.52s]
[0m14:33:47.666045 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:33:47.666752 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:33:47.667605 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:33:47.668573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:33:47.669056 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:33:47.675273 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:33:47.677577 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:33:47.681130 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:33:47.682205 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:33:47.682609 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:33:47.682993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:50.152794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.469 seconds
[0m14:33:50.158703 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:33:50.766222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c38050>]}
[0m14:33:50.767984 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 3.10s]
[0m14:33:50.768782 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:33:50.769428 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:33:50.770346 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:33:50.771070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:33:50.771539 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:33:50.775522 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:33:50.776379 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:33:50.779793 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:33:50.780840 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:33:50.781220 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:33:50.781584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:52.508209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.726 seconds
[0m14:33:52.512970 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:33:53.126450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174f3d10>]}
[0m14:33:53.127984 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.36s]
[0m14:33:53.128817 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:33:53.129726 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:33:53.130696 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:33:53.131391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:33:53.131842 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:33:53.143599 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:33:53.145762 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:33:53.170006 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:33:53.170368 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        GAMES_MIN,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    TEAM_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:33:53.170697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:55.127937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.956 seconds
[0m14:33:55.141819 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:33:55.142357 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:33:55.480150 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.337 seconds
[0m14:33:55.487907 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:33:55.488447 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:33:55.765759 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.277 seconds
[0m14:33:55.778290 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:33:55.778756 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:33:56.092238 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.313 seconds
[0m14:33:56.128736 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:33:56.130686 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:33:56.130966 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:33:56.452532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m14:33:56.453513 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:33:56.454136 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(DETAILS_GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(DETAILS_GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:33:56.833318 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86115-0102-32a8-0006-c35e00048586
[0m14:33:56.833875 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 37
invalid identifier 'PLAYER_TEAM_ID'
[0m14:33:56.834533 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:33:57.432499 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 37
  invalid identifier 'PLAYER_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:33:57.433543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1176bb310>]}
[0m14:33:57.434458 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.30s]
[0m14:33:57.435075 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:33:57.435507 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:33:57.437182 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:33:57.437660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:33:57.438005 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:33:57.441717 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:33:57.442701 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:33:57.445563 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:33:57.446936 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:33:57.447291 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:33:57.447626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:59.572016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.124 seconds
[0m14:33:59.576842 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:34:00.198504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7154e34-3d08-49ff-a81e-45dbdb98d1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116728dd0>]}
[0m14:34:00.200272 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.76s]
[0m14:34:00.201423 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:34:00.202007 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:34:00.202651 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:34:00.203250 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:34:00.205254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:00.205642 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:34:00.206191 [info ] [MainThread]: 
[0m14:34:00.206783 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 29.18 seconds (29.18s).
[0m14:34:00.208581 [debug] [MainThread]: Command end result
[0m14:34:00.238484 [info ] [MainThread]: 
[0m14:34:00.238810 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:34:00.238996 [info ] [MainThread]: 
[0m14:34:00.239227 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 37
  invalid identifier 'PLAYER_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:34:00.239412 [info ] [MainThread]: 
[0m14:34:00.239611 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:34:00.242045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.953691, "process_user_time": 2.249498, "process_kernel_time": 0.355956, "process_mem_max_rss": "191135744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:34:00.242484 [debug] [MainThread]: Command `dbt run` failed at 14:34:00.242428 after 29.95 seconds
[0m14:34:00.242784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034895d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103488d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1176c1350>]}
[0m14:34:00.243006 [debug] [MainThread]: Flushing usage events
[0m14:34:16.108332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108726310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879bf90>]}


============================== 14:34:16.110972 | f4098249-7a94-40d4-abba-e21ce9e6ddce ==============================
[0m14:34:16.110972 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:34:16.111279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:34:16.629492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc7e510>]}
[0m14:34:16.648206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073edb90>]}
[0m14:34:16.648715 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:34:16.708146 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:34:16.750979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:16.751186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:16.761600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280f64d0>]}
[0m14:34:16.799398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d66be50>]}
[0m14:34:16.799635 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:34:16.799800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128246910>]}
[0m14:34:16.800919 [info ] [MainThread]: 
[0m14:34:16.801197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:16.803094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:34:16.809330 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:34:16.809496 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:34:16.809622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:18.570118 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.760 seconds
[0m14:34:18.573486 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:34:19.239115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:34:19.252428 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:34:19.252850 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:34:19.253157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:20.952655 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.699 seconds
[0m14:34:20.956917 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:34:21.592868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128246910>]}
[0m14:34:21.593800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:21.594233 [info ] [MainThread]: 
[0m14:34:21.597777 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:34:21.598392 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:34:21.598939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:34:21.599413 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:34:21.607695 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:34:21.608775 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:34:21.628724 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:34:21.629630 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:34:21.629889 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:34:21.630144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:23.693973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.063 seconds
[0m14:34:23.722873 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:34:24.355790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128320790>]}
[0m14:34:24.356922 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.76s]
[0m14:34:24.357706 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:34:24.358246 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:34:24.359013 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:34:24.359632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:34:24.360078 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:34:24.362268 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:34:24.364941 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:34:24.368040 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:34:24.369465 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:34:24.369848 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:34:24.370188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:26.228136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.858 seconds
[0m14:34:26.233394 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:34:26.920687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f2350>]}
[0m14:34:26.922102 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.56s]
[0m14:34:26.922950 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:34:26.923494 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:34:26.924202 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:34:26.924859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:34:26.925389 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:34:26.927834 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:34:26.928627 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:34:26.932173 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:34:26.933230 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:34:26.933604 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:34:26.933968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:28.691945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.758 seconds
[0m14:34:28.697434 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:34:29.348275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877ed90>]}
[0m14:34:29.350390 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.42s]
[0m14:34:29.351170 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:34:29.351706 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:34:29.352524 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:34:29.353222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:34:29.353753 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:34:29.356746 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:34:29.357624 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:34:29.360906 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:34:29.362148 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:34:29.362497 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:34:29.362814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:31.213997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.851 seconds
[0m14:34:31.219116 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:34:31.832468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129231450>]}
[0m14:34:31.834025 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.48s]
[0m14:34:31.834992 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:34:31.835613 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:34:31.836349 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:34:31.837010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:34:31.837464 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:34:31.841065 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:34:31.842028 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:34:31.847828 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:34:31.849253 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:34:31.849672 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:34:31.850041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:33.634282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.784 seconds
[0m14:34:33.639000 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:34:34.285595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280de0d0>]}
[0m14:34:34.286296 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.45s]
[0m14:34:34.286706 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:34:34.286980 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:34:34.287348 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:34:34.287730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:34:34.287931 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:34:34.291203 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:34:34.294538 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:34:34.308560 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:34:34.335909 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:34:34.336878 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:34:34.337083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:35.975743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.638 seconds
[0m14:34:35.995310 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:34:36.630392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283947d0>]}
[0m14:34:36.633060 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.34s]
[0m14:34:36.634181 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:34:36.635142 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:34:36.636634 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:34:36.637399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:34:36.637890 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:34:36.644560 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:34:36.645507 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:34:36.649381 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:34:36.650436 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:34:36.650782 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:34:36.651131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:38.339684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.687 seconds
[0m14:34:38.365139 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:34:38.900058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129292150>]}
[0m14:34:38.901662 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.26s]
[0m14:34:38.902673 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:34:38.903361 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:34:38.904364 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:34:38.904968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:34:38.905390 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:34:38.918630 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:34:38.919851 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:34:38.946527 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:34:38.946982 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID AS PLAYER_TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        GAMES_MIN,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.TEAM_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    TEAM_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:34:38.947355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:40.536287 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86116-0102-31cd-0006-c35e00044876
[0m14:34:40.537489 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 58 at position 8
invalid identifier 'P.TEAM_ID'
[0m14:34:40.538148 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:34:41.150370 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 58 at position 8
  invalid identifier 'P.TEAM_ID'
[0m14:34:41.151169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283ffcd0>]}
[0m14:34:41.151994 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.25s]
[0m14:34:41.152604 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:34:41.153030 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:34:41.154839 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:34:41.155313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:34:41.155634 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:34:41.158928 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:34:41.159894 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:34:41.162763 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:34:41.163965 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:34:41.164313 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:34:41.164612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:42.864648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.700 seconds
[0m14:34:42.870407 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:34:43.415434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4098249-7a94-40d4-abba-e21ce9e6ddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12937f990>]}
[0m14:34:43.417032 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.26s]
[0m14:34:43.418013 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:34:43.418592 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:34:43.419273 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:34:43.419818 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:34:43.421915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:43.422601 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:34:43.423351 [info ] [MainThread]: 
[0m14:34:43.423843 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 26.62 seconds (26.62s).
[0m14:34:43.426392 [debug] [MainThread]: Command end result
[0m14:34:43.459314 [info ] [MainThread]: 
[0m14:34:43.459660 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:34:43.459849 [info ] [MainThread]: 
[0m14:34:43.460077 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 58 at position 8
  invalid identifier 'P.TEAM_ID'
[0m14:34:43.460277 [info ] [MainThread]: 
[0m14:34:43.460469 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:34:43.462939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.3833, "process_user_time": 2.065593, "process_kernel_time": 0.367807, "process_mem_max_rss": "189890560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:34:43.463359 [debug] [MainThread]: Command `dbt run` failed at 14:34:43.463312 after 27.38 seconds
[0m14:34:43.463659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e394d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e395d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108730750>]}
[0m14:34:43.463890 [debug] [MainThread]: Flushing usage events
[0m14:35:04.383506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107999d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fbe50>]}


============================== 14:35:04.386778 | 0ddfa956-0258-46e7-97c5-db39b2644c25 ==============================
[0m14:35:04.386778 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:35:04.387099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:35:04.902032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fca190>]}
[0m14:35:04.921016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107445e10>]}
[0m14:35:04.921527 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:35:04.981165 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:35:05.013690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:05.013876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:05.024029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202ccd90>]}
[0m14:35:05.061351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120278c10>]}
[0m14:35:05.061604 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:35:05.061763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120466b50>]}
[0m14:35:05.062841 [info ] [MainThread]: 
[0m14:35:05.063099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:05.065010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:35:05.071271 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:35:05.071433 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:35:05.071558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:06.954496 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.883 seconds
[0m14:35:06.957750 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:35:07.571494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:35:07.584044 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:35:07.584491 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:35:07.584797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:09.203999 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.619 seconds
[0m14:35:09.207901 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:35:09.757542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050001d0>]}
[0m14:35:09.758930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:09.759428 [info ] [MainThread]: 
[0m14:35:09.763793 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:35:09.764618 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:35:09.765393 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:35:09.765946 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:35:09.774399 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:35:09.775557 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:35:09.797049 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:35:09.798034 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:35:09.798323 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:35:09.798567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:11.648734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.850 seconds
[0m14:35:11.677838 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:35:12.280025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121430690>]}
[0m14:35:12.281511 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.51s]
[0m14:35:12.282520 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:35:12.283168 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:35:12.284150 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:35:12.284788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:35:12.285195 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:35:12.288517 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:35:12.290609 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:35:12.294690 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:35:12.296270 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:35:12.296694 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:35:12.297094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:14.221996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.924 seconds
[0m14:35:14.226710 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:35:14.802889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120503ad0>]}
[0m14:35:14.804477 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.52s]
[0m14:35:14.805279 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:35:14.806063 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:35:14.806891 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:35:14.807547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:35:14.807994 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:35:14.810482 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:35:14.811384 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:35:14.815286 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:35:14.816415 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:35:14.816798 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:35:14.817153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:16.513135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.696 seconds
[0m14:35:16.515591 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:35:17.078515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212ecf90>]}
[0m14:35:17.079447 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.27s]
[0m14:35:17.080065 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:35:17.080490 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:35:17.081062 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:35:17.081536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:35:17.081918 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:35:17.084057 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:35:17.084796 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:35:17.087699 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:35:17.088666 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:35:17.088942 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:35:17.089198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:18.867196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.778 seconds
[0m14:35:18.870884 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:35:19.424110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100cd0>]}
[0m14:35:19.425204 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.34s]
[0m14:35:19.425871 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:35:19.426447 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:35:19.427130 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:35:19.427725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:35:19.428201 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:35:19.431047 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:35:19.431920 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:35:19.437273 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:35:19.438570 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:35:19.438955 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:35:19.439553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:21.335522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.896 seconds
[0m14:35:21.341271 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:35:21.907030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212ad250>]}
[0m14:35:21.909097 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.48s]
[0m14:35:21.910135 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:35:21.910765 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:35:21.911939 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:35:21.912679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:35:21.913155 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:35:21.917972 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:35:21.920052 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:35:21.923864 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:35:21.924937 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:35:21.925287 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:35:21.925581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:23.637504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.712 seconds
[0m14:35:23.640932 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:35:24.197201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12042f8d0>]}
[0m14:35:24.198343 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.28s]
[0m14:35:24.199351 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:35:24.199840 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:35:24.200486 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:35:24.201142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:35:24.201742 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:35:24.214207 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:35:24.215597 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:35:24.218214 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:35:24.218908 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:35:24.219191 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:35:24.219423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:25.919646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.700 seconds
[0m14:35:25.921127 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:35:26.489204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120567e10>]}
[0m14:35:26.490584 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.29s]
[0m14:35:26.491563 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:35:26.492267 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:35:26.493077 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:35:26.493680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:35:26.494226 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:35:26.507018 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:35:26.509056 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:35:26.539114 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:35:26.539579 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID AS PLAYER_TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        GAMES_MIN,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.PLAYER_TEAM_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    PLAYER_TEAM_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:35:26.539964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:28.591177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.051 seconds
[0m14:35:28.608375 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:35:28.608952 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:35:28.928846 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.319 seconds
[0m14:35:28.938872 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:35:28.939491 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:35:29.240975 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.301 seconds
[0m14:35:29.255856 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:35:29.256483 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:35:29.536196 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.279 seconds
[0m14:35:29.568976 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:35:29.571155 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:35:29.571448 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:35:29.905477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m14:35:29.906927 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:35:29.907719 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(DETAILS_GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(DETAILS_GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:35:30.312851 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86117-0102-32a8-0006-c35e000485ae
[0m14:35:30.313320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m14:35:30.313853 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:35:30.877504 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:35:30.879576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206eb850>]}
[0m14:35:30.881664 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.39s]
[0m14:35:30.883022 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:35:30.883501 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:35:30.885531 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:35:30.886202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:35:30.886437 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:35:30.890298 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:35:30.893309 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:35:30.907863 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:35:30.909721 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:35:30.910150 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:35:30.910449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:32.757250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.846 seconds
[0m14:35:32.764623 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:35:33.328850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddfa956-0258-46e7-97c5-db39b2644c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212e1550>]}
[0m14:35:33.330896 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.44s]
[0m14:35:33.331967 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:35:33.332627 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:35:33.333292 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:35:33.333884 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:35:33.336294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:33.336899 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:35:33.337265 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:35:33.337873 [info ] [MainThread]: 
[0m14:35:33.338325 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.27 seconds (28.27s).
[0m14:35:33.340397 [debug] [MainThread]: Command end result
[0m14:35:33.376730 [info ] [MainThread]: 
[0m14:35:33.377047 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:35:33.377235 [info ] [MainThread]: 
[0m14:35:33.377463 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:35:33.377662 [info ] [MainThread]: 
[0m14:35:33.377867 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:35:33.380237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.027012, "process_user_time": 2.156378, "process_kernel_time": 0.350883, "process_mem_max_rss": "198868992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:33.380629 [debug] [MainThread]: Command `dbt run` failed at 14:35:33.380583 after 29.03 seconds
[0m14:35:33.380908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105970150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215c0e10>]}
[0m14:35:33.381116 [debug] [MainThread]: Flushing usage events
[0m14:36:18.775308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c52390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc3ed0>]}


============================== 14:36:18.778319 | 4aa49475-53c0-4e66-8168-566ab9198a0b ==============================
[0m14:36:18.778319 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:36:18.778638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:36:19.334255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdbfd0>]}
[0m14:36:19.354126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105545d10>]}
[0m14:36:19.354710 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:36:19.414528 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:36:19.452823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:36:19.453073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:36:19.464030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb10e90>]}
[0m14:36:19.505031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc2d410>]}
[0m14:36:19.505345 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:36:19.505519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af61910>]}
[0m14:36:19.506736 [info ] [MainThread]: 
[0m14:36:19.507019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:19.509015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:36:19.515197 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:36:19.515365 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:36:19.515493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:21.105439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.590 seconds
[0m14:36:21.107441 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:36:21.666436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:36:21.673823 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:36:21.674195 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:36:21.674663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:23.240057 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.565 seconds
[0m14:36:23.244092 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:36:23.783786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669fa50>]}
[0m14:36:23.785023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:23.785552 [info ] [MainThread]: 
[0m14:36:23.789304 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:36:23.790067 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:36:23.790683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:36:23.791197 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:36:23.798904 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:36:23.800139 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:36:23.820837 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:36:23.821813 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:36:23.822086 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:36:23.822319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:25.720802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.898 seconds
[0m14:36:25.746034 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:36:26.330662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1e5c10>]}
[0m14:36:26.331914 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.54s]
[0m14:36:26.332679 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:36:26.333215 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:36:26.333902 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:36:26.334718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:36:26.335151 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:36:26.337603 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:36:26.340184 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:36:26.343788 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:36:26.345206 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:36:26.345580 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:36:26.345910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:28.126749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.780 seconds
[0m14:36:28.130532 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:36:28.681945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b59690>]}
[0m14:36:28.683859 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.35s]
[0m14:36:28.684715 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:36:28.685349 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:36:28.686120 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:36:28.686892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:36:28.687675 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:36:28.690508 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:36:28.691748 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:36:28.696023 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:36:28.697116 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:36:28.697491 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:36:28.697845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:30.528704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.830 seconds
[0m14:36:30.532377 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:36:31.129402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e45d150>]}
[0m14:36:31.131212 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.44s]
[0m14:36:31.132182 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:36:31.133039 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:36:31.134050 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:36:31.134748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:36:31.135212 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:36:31.139506 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:36:31.140654 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:36:31.144229 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:36:31.146108 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:36:31.146597 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:36:31.146982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:32.947883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.800 seconds
[0m14:36:32.954024 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:36:33.550647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cd9c10>]}
[0m14:36:33.552271 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.42s]
[0m14:36:33.553133 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:36:33.553796 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:36:33.554830 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:36:33.555785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:36:33.556318 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:36:33.558929 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:36:33.561070 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:36:33.566660 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:36:33.568171 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:36:33.568635 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:36:33.569033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:35.527325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.958 seconds
[0m14:36:35.532367 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:36:36.146156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572e150>]}
[0m14:36:36.147207 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.59s]
[0m14:36:36.147917 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:36:36.148429 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:36:36.149235 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:36:36.149784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:36:36.150192 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:36:36.154635 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:36:36.156869 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:36:36.160043 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:36:36.161007 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:36:36.161361 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:36:36.161676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:37.942435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.780 seconds
[0m14:36:37.947793 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:36:38.573080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104562310>]}
[0m14:36:38.575063 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.42s]
[0m14:36:38.575808 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:36:38.576360 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:36:38.577048 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:36:38.577729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:36:38.578175 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:36:38.581855 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:36:38.582843 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:36:38.586409 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:36:38.587480 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:36:38.587806 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:36:38.588153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:40.344503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.756 seconds
[0m14:36:40.349496 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:36:40.925823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dace490>]}
[0m14:36:40.927129 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:36:40.927889 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:36:40.928473 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:36:40.929173 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:36:40.929863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:36:40.930325 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:36:40.941920 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:36:40.943552 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:36:40.967923 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:36:40.968336 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID AS PLAYER_TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAME_ID AS GAME_GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        GAMES_MIN,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.PLAYER_TEAM_ID,
        gd.DETAILS_GAME_ID,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAME_GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID,
    PLAYER_TEAM_ID,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:36:40.968677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:43.002993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.034 seconds
[0m14:36:43.015510 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:36:43.016006 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:36:43.305251 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.288 seconds
[0m14:36:43.316232 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:36:43.316783 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:36:43.620017 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.302 seconds
[0m14:36:43.635814 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:36:43.636425 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:36:43.924856 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.288 seconds
[0m14:36:43.958697 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:36:43.961480 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:36:43.961734 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:36:44.290449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m14:36:44.291991 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:36:44.293251 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(DETAILS_GAME_ID, PLAYER_ID) = DBT_INTERNAL_DEST.concat(DETAILS_GAME_ID, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:36:44.627569 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86118-0102-31cd-0006-c35e000448d2
[0m14:36:44.628538 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 55
invalid identifier 'GAME_ID'
[0m14:36:44.629422 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:36:45.208383 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:36:45.209125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4c1b10>]}
[0m14:36:45.209948 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.28s]
[0m14:36:45.210676 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:36:45.211147 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:36:45.212656 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:36:45.213099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:36:45.213439 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:36:45.216834 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:36:45.217984 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:36:45.220708 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:36:45.222041 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:36:45.222394 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:36:45.222762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:46.997804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.774 seconds
[0m14:36:47.003740 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:36:47.589099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa49475-53c0-4e66-8168-566ab9198a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105302410>]}
[0m14:36:47.590214 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.38s]
[0m14:36:47.590953 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:36:47.591479 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:36:47.592076 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:36:47.592685 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:36:47.594545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:47.594873 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:36:47.595282 [info ] [MainThread]: 
[0m14:36:47.595612 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.09 seconds (28.09s).
[0m14:36:47.597180 [debug] [MainThread]: Command end result
[0m14:36:47.627718 [info ] [MainThread]: 
[0m14:36:47.628016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:36:47.628204 [info ] [MainThread]: 
[0m14:36:47.628426 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 55
  invalid identifier 'GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:36:47.628612 [info ] [MainThread]: 
[0m14:36:47.628795 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:36:47.632785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.887733, "process_user_time": 2.216188, "process_kernel_time": 0.348281, "process_mem_max_rss": "191889408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:47.633195 [debug] [MainThread]: Command `dbt run` failed at 14:36:47.633144 after 28.89 seconds
[0m14:36:47.633467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c65b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102daac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10176d5d0>]}
[0m14:36:47.633669 [debug] [MainThread]: Flushing usage events
[0m14:39:30.440795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108786110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108786690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087dff90>]}


============================== 14:39:30.443377 | 4ab9b4e6-1a72-4fde-80b4-131dbe8699f9 ==============================
[0m14:39:30.443377 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:39:30.443703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:31.052544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db38e10>]}
[0m14:39:31.071461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107441b90>]}
[0m14:39:31.071956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:39:31.132075 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:39:31.164690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:31.164880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:31.175117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df169d0>]}
[0m14:39:31.213888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5ae10>]}
[0m14:39:31.214121 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:39:31.214283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db861d0>]}
[0m14:39:31.215382 [info ] [MainThread]: 
[0m14:39:31.215653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:31.217621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:39:31.223936 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:39:31.224109 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:39:31.224238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:33.093639 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.869 seconds
[0m14:39:33.097155 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:39:33.710401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:39:33.720797 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:39:33.721191 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:39:33.721486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:35.337003 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.615 seconds
[0m14:39:35.338946 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:39:35.962720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c56510>]}
[0m14:39:35.963830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:35.964254 [info ] [MainThread]: 
[0m14:39:35.968045 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:39:35.968804 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:39:35.969420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:39:35.969860 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:39:35.977495 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:39:35.978858 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:39:36.000166 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:39:36.001111 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:39:36.001367 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:39:36.001600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:37.918003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.916 seconds
[0m14:39:37.942232 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:39:38.475717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf7010>]}
[0m14:39:38.476476 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.51s]
[0m14:39:38.476932 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:39:38.477368 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:39:38.477943 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:39:38.478538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:39:38.478864 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:39:38.480418 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:39:38.481671 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:39:38.484209 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:39:38.485345 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:39:38.485637 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:39:38.485922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:39.436196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:40.407646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.921 seconds
[0m14:39:40.617791 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.nba_analysis.src_games_details' (1903658354909886)
[0m14:39:40.619215 [debug] [MainThread]: Using snowflake connection "master"
[0m14:39:40.619721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(1903658354909886)
[0m14:39:40.620152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:42.202509 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.582 seconds
[0m14:39:42.206138 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.nba_analysis.src_games_details': ('0 cancelled. ',)
[0m14:39:42.207389 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:39:42.206866 [error] [MainThread]: CANCEL query model.nba_analysis.src_games_details .............................. [[31mCANCEL[0m]
[0m14:39:42.209267 [debug] [MainThread]: On master: Close
[0m14:39:42.841960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab9b4e6-1a72-4fde-80b4-131dbe8699f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a8b90>]}
[0m14:39:42.843780 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 4.36s]
[0m14:39:42.844939 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:39:42.845541 [info ] [MainThread]: 
[0m14:39:42.846206 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m14:39:42.846623 [info ] [MainThread]: 
[0m14:39:42.847046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:42.847428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:42.847741 [debug] [MainThread]: Connection 'model.nba_analysis.src_games_details' was properly closed.
[0m14:39:42.848100 [info ] [MainThread]: 
[0m14:39:42.848475 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.63 seconds (11.63s).
[0m14:39:42.849110 [error] [MainThread]: Encountered an error:

[0m14:39:42.854895 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 305, in run_queue
    self.handle_job_queue(pool, callback)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 324, in handle_job_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/anaconda3/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/Users/Shared/anaconda3/lib/python3.11/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m14:39:42.858868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.447068, "process_user_time": 1.506968, "process_kernel_time": 0.28999, "process_mem_max_rss": "192135168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:39:42.859474 [debug] [MainThread]: Command `dbt run` failed at 14:39:42.859392 after 12.45 seconds
[0m14:39:42.859913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108419790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5adcd0>]}
[0m14:39:42.860243 [debug] [MainThread]: Flushing usage events
[0m14:39:52.174182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106451d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106817f90>]}


============================== 14:39:52.176585 | 6cdc7e5e-2dfb-4280-bc55-4aeb6f657698 ==============================
[0m14:39:52.176585 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:39:52.176888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:52.674451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ebdd0>]}
[0m14:39:52.693748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106269cd0>]}
[0m14:39:52.694808 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:39:52.754926 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:39:52.789062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:52.789293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:52.799935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2f810>]}
[0m14:39:52.837210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc1f450>]}
[0m14:39:52.837486 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:39:52.837654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be5a450>]}
[0m14:39:52.838783 [info ] [MainThread]: 
[0m14:39:52.839072 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:52.841117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:39:52.847240 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:39:52.847397 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:39:52.847522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:54.407070 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.559 seconds
[0m14:39:54.409541 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:39:55.003366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:39:55.013272 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:39:55.013656 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:39:55.013917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:56.535232 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.521 seconds
[0m14:39:56.538447 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:39:57.156638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2fad0>]}
[0m14:39:57.157495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:57.158043 [info ] [MainThread]: 
[0m14:39:57.160375 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:39:57.161070 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:39:57.161903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:39:57.162218 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:39:57.166991 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:39:57.167456 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:39:57.190703 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:39:57.191795 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:39:57.192069 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:39:57.192279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:59.100172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.907 seconds
[0m14:39:59.128504 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:39:59.682019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6bc90>]}
[0m14:39:59.682869 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.52s]
[0m14:39:59.683474 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:39:59.683910 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:39:59.684485 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:39:59.685151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:39:59.685534 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:39:59.687614 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:39:59.689702 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:39:59.692580 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:39:59.693936 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:39:59.694354 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:39:59.694772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:01.659755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.964 seconds
[0m14:40:01.665818 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:40:02.276923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c3f50>]}
[0m14:40:02.278499 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.59s]
[0m14:40:02.279454 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:40:02.280125 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:40:02.280930 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:40:02.281557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:40:02.282010 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:40:02.284666 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:40:02.285529 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:40:02.290367 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:40:02.291548 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:40:02.291943 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:40:02.292290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:03.985107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.692 seconds
[0m14:40:03.989872 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:40:04.576590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af09690>]}
[0m14:40:04.577762 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.29s]
[0m14:40:04.578513 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:40:04.579048 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:40:04.579748 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:40:04.580584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:40:04.581039 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:40:04.583754 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:40:04.584611 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:40:04.587998 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:40:04.589167 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:40:04.589544 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:40:04.589853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:06.369523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m14:40:06.374998 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:40:06.988911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bea0290>]}
[0m14:40:06.990727 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.41s]
[0m14:40:06.991685 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:40:06.992351 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:40:06.993106 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:40:06.993780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:40:06.994207 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:40:06.997803 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:40:06.998939 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:40:07.004812 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:40:07.006233 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:40:07.006615 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:40:07.006968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:09.236059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.229 seconds
[0m14:40:09.240847 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:40:09.814472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c8390>]}
[0m14:40:09.816215 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.82s]
[0m14:40:09.817397 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:40:09.818136 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:40:09.819058 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:40:09.819873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:40:09.820361 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:40:09.824594 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:40:09.826776 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:40:09.830026 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:40:09.830995 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:40:09.831323 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:40:09.831624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:11.590110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.758 seconds
[0m14:40:11.593238 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:40:12.280036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e9090>]}
[0m14:40:12.280936 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.46s]
[0m14:40:12.281538 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:40:12.281967 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:40:12.282532 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:40:12.283100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:40:12.283493 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:40:12.286909 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:40:12.287781 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:40:12.290486 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:40:12.291453 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:40:12.291776 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:40:12.292077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:13.936457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.644 seconds
[0m14:40:13.943261 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:40:14.540485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c8390>]}
[0m14:40:14.541818 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.26s]
[0m14:40:14.542607 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:40:14.543311 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:40:14.544238 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:40:14.544930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:40:14.545384 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:40:14.556752 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:40:14.558477 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:40:14.581931 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:40:14.582288 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_details_data AS (
    SELECT
        GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        gd.GAME_ID as details_game_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    details_game_id as GAME_ID,
    player_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:40:14.582580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:16.141642 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8611c-0102-31cd-0006-c35e00044962
[0m14:40:16.142284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 103 at position 8
invalid identifier 'PLAYER_STATS.GAME_DATE_EST'
[0m14:40:16.142865 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:40:16.679549 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 103 at position 8
  invalid identifier 'PLAYER_STATS.GAME_DATE_EST'
[0m14:40:16.680272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545c290>]}
[0m14:40:16.680998 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.14s]
[0m14:40:16.681680 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:40:16.682065 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:40:16.683451 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:40:16.683908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:40:16.684239 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:40:16.687540 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:40:16.688826 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:40:16.691257 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:40:16.692458 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:40:16.692765 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:40:16.693052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:18.438941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.745 seconds
[0m14:40:18.444148 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:40:19.031065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc7e5e-2dfb-4280-bc55-4aeb6f657698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2d390>]}
[0m14:40:19.032390 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:40:19.033159 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:40:19.033689 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:40:19.034287 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:40:19.034899 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:40:19.036618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:19.036993 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:40:19.037516 [info ] [MainThread]: 
[0m14:40:19.037914 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 26.20 seconds (26.20s).
[0m14:40:19.039912 [debug] [MainThread]: Command end result
[0m14:40:19.072234 [info ] [MainThread]: 
[0m14:40:19.072530 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:40:19.072714 [info ] [MainThread]: 
[0m14:40:19.072939 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 103 at position 8
  invalid identifier 'PLAYER_STATS.GAME_DATE_EST'
[0m14:40:19.073143 [info ] [MainThread]: 
[0m14:40:19.073345 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:40:19.076680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.93151, "process_user_time": 2.065437, "process_kernel_time": 0.317517, "process_mem_max_rss": "191430656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:40:19.077071 [debug] [MainThread]: Command `dbt run` failed at 14:40:19.077014 after 26.93 seconds
[0m14:40:19.077336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ec54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ec55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105480f90>]}
[0m14:40:19.077538 [debug] [MainThread]: Flushing usage events
[0m14:40:28.542901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108310d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835cf50>]}


============================== 14:40:28.545385 | 7c9c6d67-5afc-486a-85d8-7ed1aecee01f ==============================
[0m14:40:28.545385 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:40:28.545683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:40:29.052554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c6750>]}
[0m14:40:29.071676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbdd10>]}
[0m14:40:29.072274 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:40:29.134351 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:40:29.185528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:29.185724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:29.196090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daa56d0>]}
[0m14:40:29.232291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da76e50>]}
[0m14:40:29.232539 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:40:29.232704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d832650>]}
[0m14:40:29.233929 [info ] [MainThread]: 
[0m14:40:29.234201 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:29.236132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:40:29.242064 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:40:29.242216 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:40:29.242338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:30.799849 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.557 seconds
[0m14:40:30.803257 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:40:31.464404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:40:31.474175 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:40:31.474527 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:40:31.474788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:33.072544 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.598 seconds
[0m14:40:33.076808 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:40:33.645497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e25d0>]}
[0m14:40:33.646905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:33.647460 [info ] [MainThread]: 
[0m14:40:33.652004 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:40:33.652802 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:40:33.653507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:40:33.654109 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:40:33.662832 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:40:33.664330 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:40:33.686451 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:40:33.687406 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:40:33.687669 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:40:33.687897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:35.655391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.967 seconds
[0m14:40:35.677993 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:40:36.276016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c88350>]}
[0m14:40:36.277356 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.62s]
[0m14:40:36.278321 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:40:36.278901 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:40:36.279687 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:40:36.280350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:40:36.280773 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:40:36.283343 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:40:36.285764 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:40:36.289943 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:40:36.291432 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:40:36.291800 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:40:36.292133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:38.169521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.877 seconds
[0m14:40:38.174992 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:40:38.772523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da68dd0>]}
[0m14:40:38.774743 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.49s]
[0m14:40:38.775648 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:40:38.776266 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:40:38.777056 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:40:38.778106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:40:38.778641 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:40:38.781743 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:40:38.782714 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:40:38.786539 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:40:38.787619 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:40:38.788000 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:40:38.788360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:40.603436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.815 seconds
[0m14:40:40.610083 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:40:41.291323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df2aa10>]}
[0m14:40:41.293368 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.51s]
[0m14:40:41.294484 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:40:41.295556 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:40:41.299414 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:40:41.300201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:40:41.300730 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:40:41.305081 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:40:41.306223 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:40:41.309956 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:40:41.311263 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:40:41.311673 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:40:41.312026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.128879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.817 seconds
[0m14:40:43.131588 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:40:43.692029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da68210>]}
[0m14:40:43.693754 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.39s]
[0m14:40:43.694645 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:40:43.695501 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:40:43.697425 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:40:43.698259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:40:43.698744 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:40:43.701524 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:40:43.702505 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:40:43.707619 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:40:43.708973 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:40:43.709386 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:40:43.709751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:45.415079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.705 seconds
[0m14:40:45.417197 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:40:45.974704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e3550>]}
[0m14:40:45.975620 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.28s]
[0m14:40:45.976309 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:40:45.976809 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:40:45.977572 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:40:45.978191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:40:45.978601 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:40:45.982693 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:40:45.984942 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:40:45.988183 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:40:45.989163 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:40:45.989492 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:40:45.989797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:47.588926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.599 seconds
[0m14:40:47.595111 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:40:48.152808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839d050>]}
[0m14:40:48.154950 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.17s]
[0m14:40:48.155929 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:40:48.156727 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:40:48.157896 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:40:48.158749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:40:48.159383 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:40:48.163830 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:40:48.165877 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:40:48.169075 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:40:48.170139 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:40:48.170530 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:40:48.170884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:49.928026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.757 seconds
[0m14:40:49.931287 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:40:50.493332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c78e50>]}
[0m14:40:50.494249 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.33s]
[0m14:40:50.494789 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:40:50.495190 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:40:50.495697 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:40:50.496196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:40:50.496538 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:40:50.504684 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:40:50.506417 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:40:50.526910 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:40:50.527225 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_details_data AS (
    SELECT
        GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        gd.GAME_ID as details_game_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    details_game_id as GAME_ID,
    player_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE player_stats.GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:40:50.527514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:52.013004 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8611c-0102-32a8-0006-c35e00048686
[0m14:40:52.013505 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 103 at position 8
invalid identifier 'PLAYER_STATS.GAME_DATE_EST'
[0m14:40:52.013988 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:40:52.568984 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 103 at position 8
  invalid identifier 'PLAYER_STATS.GAME_DATE_EST'
[0m14:40:52.569944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e074190>]}
[0m14:40:52.570812 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.07s]
[0m14:40:52.571541 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:40:52.572050 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:40:52.574028 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:40:52.574751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:40:52.575276 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:40:52.579027 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:40:52.580262 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:40:52.583120 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:40:52.584555 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:40:52.584926 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:40:52.585535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:54.401974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.816 seconds
[0m14:40:54.407869 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:40:55.009034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9c6d67-5afc-486a-85d8-7ed1aecee01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df2ab90>]}
[0m14:40:55.010086 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.43s]
[0m14:40:55.010816 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:40:55.011336 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:40:55.011910 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:40:55.012530 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:40:55.014545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:55.014953 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:40:55.015503 [info ] [MainThread]: 
[0m14:40:55.015870 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 25.78 seconds (25.78s).
[0m14:40:55.017356 [debug] [MainThread]: Command end result
[0m14:40:55.055512 [info ] [MainThread]: 
[0m14:40:55.055842 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:40:55.056032 [info ] [MainThread]: 
[0m14:40:55.056269 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 103 at position 8
  invalid identifier 'PLAYER_STATS.GAME_DATE_EST'
[0m14:40:55.056462 [info ] [MainThread]: 
[0m14:40:55.056649 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:40:55.060158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.551525, "process_user_time": 2.092253, "process_kernel_time": 0.342664, "process_mem_max_rss": "190988288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:40:55.060587 [debug] [MainThread]: Command `dbt run` failed at 14:40:55.060534 after 26.55 seconds
[0m14:40:55.060892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a195d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a18d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d713b90>]}
[0m14:40:55.061108 [debug] [MainThread]: Flushing usage events
[0m14:41:15.370659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104680c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104316510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dbf90>]}


============================== 14:41:15.373378 | c8de97ac-85bb-4592-bf9f-3ae53706340d ==============================
[0m14:41:15.373378 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:41:15.373702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:15.921340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db9e50>]}
[0m14:41:15.940955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412dcd0>]}
[0m14:41:15.941501 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:41:16.001293 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:41:16.034310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:16.034500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:16.044865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df2d50>]}
[0m14:41:16.085992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce45d0>]}
[0m14:41:16.086247 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:41:16.086421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1e710>]}
[0m14:41:16.087619 [info ] [MainThread]: 
[0m14:41:16.087915 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:16.089909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:41:16.096801 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:41:16.097012 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:41:16.097175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:17.741175 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.644 seconds
[0m14:41:17.744920 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:41:18.311544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:41:18.325573 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:41:18.326018 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:41:18.326329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:19.994859 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.668 seconds
[0m14:41:19.998729 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:41:20.618019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d96e50>]}
[0m14:41:20.619543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:20.620221 [info ] [MainThread]: 
[0m14:41:20.624593 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:41:20.625422 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:41:20.626212 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:41:20.626667 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:41:20.634707 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:41:20.636318 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:41:20.657783 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:41:20.658797 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:41:20.659085 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:41:20.659341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:22.565393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.906 seconds
[0m14:41:22.590855 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:41:23.286630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ac1250>]}
[0m14:41:23.288015 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.66s]
[0m14:41:23.289051 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:41:23.289724 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:41:23.290574 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:41:23.291341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:41:23.292107 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:41:23.295537 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:41:23.297597 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:41:23.305030 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:41:23.314568 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:41:23.315037 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:41:23.315329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:25.763211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.447 seconds
[0m14:41:25.771938 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:41:26.320328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb5ad0>]}
[0m14:41:26.321674 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 3.03s]
[0m14:41:26.322560 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:41:26.323215 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:41:26.324086 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:41:26.324627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:41:26.325043 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:41:26.327286 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:41:26.327747 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:41:26.330409 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:41:26.331176 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:41:26.331447 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:41:26.332221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:27.873298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.540 seconds
[0m14:41:27.888077 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:41:28.463108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e56690>]}
[0m14:41:28.463974 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.14s]
[0m14:41:28.464684 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:41:28.465421 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:41:28.467120 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:41:28.467677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:41:28.467953 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:41:28.470526 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:41:28.471287 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:41:28.473674 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:41:28.474987 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:41:28.475204 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:41:28.475392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:30.223390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.748 seconds
[0m14:41:30.227989 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:41:30.776161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b04c90>]}
[0m14:41:30.778762 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.31s]
[0m14:41:30.779623 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:41:30.780223 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:41:30.780926 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:41:30.782164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:41:30.782650 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:41:30.787706 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:41:30.788908 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:41:30.795290 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:41:30.796234 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:41:30.796474 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:41:30.796670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:32.634143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.836 seconds
[0m14:41:32.640984 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:41:33.186254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412c5d0>]}
[0m14:41:33.196280 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.40s]
[0m14:41:33.197526 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:41:33.198251 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:41:33.199517 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:41:33.200448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:41:33.201063 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:41:33.207605 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:41:33.208891 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:41:33.212431 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:41:33.214085 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:41:33.214512 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:41:33.214887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:36.125391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.910 seconds
[0m14:41:36.130902 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:41:36.685135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104102590>]}
[0m14:41:36.686429 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 3.48s]
[0m14:41:36.687302 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:41:36.687955 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:41:36.688788 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:41:36.689363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:41:36.689819 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:41:36.694930 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:41:36.696441 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:41:36.700995 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:41:36.702253 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:41:36.702684 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:41:36.703063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:38.281348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.577 seconds
[0m14:41:38.304045 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:41:38.858722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1ec50>]}
[0m14:41:38.860918 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.17s]
[0m14:41:38.861764 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:41:38.862391 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:41:38.863130 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:41:38.863754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:41:38.864533 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:41:38.876273 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:41:38.877560 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:41:38.905815 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:41:38.906232 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as player_team_id
    FROM NBA_GAMES.DEV.src_players
),

games_details_data AS (
    SELECT
        GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.player_team_id,
        gd.GAME_ID as details_game_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    details_game_id as GAME_ID,
    player_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:41:38.906559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:40.489101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8611d-0102-31cd-0006-c35e0004498e
[0m14:41:40.489580 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 103 at position 8
invalid identifier 'GAME_DATE_EST'
[0m14:41:40.490094 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:41:41.061313 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 103 at position 8
  invalid identifier 'GAME_DATE_EST'
[0m14:41:41.062616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a139210>]}
[0m14:41:41.063452 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.20s]
[0m14:41:41.063846 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:41:41.064127 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:41:41.065191 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:41:41.065630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:41:41.065870 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:41:41.068547 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:41:41.069268 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:41:41.071752 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:41:41.072845 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:41:41.073073 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:41:41.073276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:42.948341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.874 seconds
[0m14:41:42.954477 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:41:43.496677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8de97ac-85bb-4592-bf9f-3ae53706340d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a088510>]}
[0m14:41:43.498064 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.43s]
[0m14:41:43.498831 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:41:43.499445 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:41:43.500061 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:41:43.500675 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:41:43.502570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:43.502961 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:41:43.503250 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:41:43.503768 [info ] [MainThread]: 
[0m14:41:43.504116 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 27.42 seconds (27.42s).
[0m14:41:43.506830 [debug] [MainThread]: Command end result
[0m14:41:43.553717 [info ] [MainThread]: 
[0m14:41:43.554072 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:41:43.554270 [info ] [MainThread]: 
[0m14:41:43.554491 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 103 at position 8
  invalid identifier 'GAME_DATE_EST'
[0m14:41:43.554667 [info ] [MainThread]: 
[0m14:41:43.554854 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:41:43.561007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 28.219858, "process_user_time": 1.898584, "process_kernel_time": 0.47671, "process_mem_max_rss": "195330048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:41:43.562548 [debug] [MainThread]: Command `dbt run` failed at 14:41:43.562464 after 28.22 seconds
[0m14:41:43.563490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d895d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d88d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a263c10>]}
[0m14:41:43.563760 [debug] [MainThread]: Flushing usage events
[0m14:45:25.363141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083167d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108316690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837bf90>]}


============================== 14:45:25.365816 | 62a6e132-014b-4895-af5c-cb27fa98d228 ==============================
[0m14:45:25.365816 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:45:25.366112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:45:26.111419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6a9c90>]}
[0m14:45:26.130169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc1e10>]}
[0m14:45:26.130709 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:45:26.191507 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:45:26.224403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:26.224604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:26.234852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daa69d0>]}
[0m14:45:26.273733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da10650>]}
[0m14:45:26.274000 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:45:26.274171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4f250>]}
[0m14:45:26.275347 [info ] [MainThread]: 
[0m14:45:26.275637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:26.277541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:45:26.284329 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:45:26.284498 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:45:26.284633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:28.157164 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.873 seconds
[0m14:45:28.160862 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:45:28.713319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:45:28.724130 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:45:28.724575 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:45:28.724907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:30.291932 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.567 seconds
[0m14:45:30.296718 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:45:30.979126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da11510>]}
[0m14:45:30.980307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:30.980891 [info ] [MainThread]: 
[0m14:45:30.984990 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:45:30.985907 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:45:30.986799 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:45:30.987303 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:45:30.995355 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:45:30.997311 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:45:31.108642 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:45:31.117083 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:45:31.123538 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:45:31.124370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:32.920564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.796 seconds
[0m14:45:32.947757 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:45:33.511743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787bd0>]}
[0m14:45:33.512363 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.52s]
[0m14:45:33.512815 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:45:33.513132 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:45:33.513589 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:45:33.513913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:45:33.514159 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:45:33.515597 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:45:33.517634 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:45:33.519870 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:45:33.520935 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:45:33.521229 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:45:33.521491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:35.584019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.062 seconds
[0m14:45:35.589314 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:45:36.200455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7049d0>]}
[0m14:45:36.202070 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.69s]
[0m14:45:36.203123 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:45:36.203805 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:45:36.204586 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:45:36.205232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:45:36.205658 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:45:36.209193 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:45:36.211414 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:45:36.215969 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:45:36.217264 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:45:36.217684 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:45:36.218051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.851377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.633 seconds
[0m14:45:37.856822 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:45:38.403617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d842e10>]}
[0m14:45:38.404751 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.20s]
[0m14:45:38.405588 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:45:38.406184 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:45:38.407140 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:45:38.407784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:45:38.408256 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:45:38.411640 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:45:38.414577 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:45:38.418113 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:45:38.419899 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:45:38.420424 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:45:38.420811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:40.125012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m14:45:40.130413 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:45:40.669049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779fb90>]}
[0m14:45:40.671136 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.26s]
[0m14:45:40.672211 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:45:40.672966 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:45:40.673911 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:45:40.674494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:45:40.674904 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:45:40.678287 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:45:40.681107 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:45:40.687696 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:45:40.689212 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:45:40.689642 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:45:40.689980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:42.543388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.853 seconds
[0m14:45:42.548449 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:45:43.159138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108314b90>]}
[0m14:45:43.160213 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.48s]
[0m14:45:43.161028 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:45:43.161545 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:45:43.162411 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:45:43.162996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:45:43.163386 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:45:43.167045 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:45:43.169924 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:45:43.172302 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:45:43.173126 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:45:43.173413 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:45:43.173671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:44.907064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.733 seconds
[0m14:45:44.913716 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:45:45.515159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108232250>]}
[0m14:45:45.516045 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m14:45:45.516571 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:45:45.516960 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:45:45.517489 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:45:45.517949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:45:45.518289 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:45:45.520856 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:45:45.522895 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:45:45.525206 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:45:45.526307 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:45:45.526596 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:45:45.526830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:47.302717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.776 seconds
[0m14:45:47.307766 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:45:47.848684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e7c10>]}
[0m14:45:47.850253 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.33s]
[0m14:45:47.851224 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:45:47.851784 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:45:47.852532 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:45:47.853209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:45:47.853671 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:45:47.864512 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:45:47.865803 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:45:47.890027 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:45:47.890434 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as PLAYER_TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAMES_GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as game_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.PLAYER_TEAM_ID,
        gd.DETAILS_GAME_ID as details_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.game_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAMES_GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID as GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    game_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:45:47.890811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:49.787248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.896 seconds
[0m14:45:49.799381 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:45:49.799871 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:45:50.086735 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.286 seconds
[0m14:45:50.091735 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:45:50.092130 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:45:50.379883 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.287 seconds
[0m14:45:50.393325 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:45:50.393866 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:45:50.675813 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.281 seconds
[0m14:45:50.712279 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:45:50.715402 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:45:50.715664 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:45:51.043329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m14:45:51.044285 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:45:51.045058 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(games_game_id, PLAYER_ID) = DBT_INTERNAL_DEST.concat(games_game_id, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:45:51.378216 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86121-0102-32a8-0006-c35e000486ba
[0m14:45:51.378925 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 43
invalid identifier 'GAMES_GAME_ID'
[0m14:45:51.379580 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:45:51.973470 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 4 at position 43
  invalid identifier 'GAMES_GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:45:51.974062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f3b50>]}
[0m14:45:51.974683 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.12s]
[0m14:45:51.975241 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:45:51.975597 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:45:51.976980 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:45:51.977349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:45:51.977634 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:45:51.980624 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:45:51.981704 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:45:51.984078 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:45:51.985903 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:45:51.986238 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:45:51.986540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:53.803172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.816 seconds
[0m14:45:53.808254 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:45:54.390455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a6e132-014b-4895-af5c-cb27fa98d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd76d90>]}
[0m14:45:54.391680 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.41s]
[0m14:45:54.392447 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:45:54.392963 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:45:54.393610 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:45:54.394220 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:45:54.395988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:54.396298 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:45:54.396548 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:45:54.397012 [info ] [MainThread]: 
[0m14:45:54.397339 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.12 seconds (28.12s).
[0m14:45:54.399129 [debug] [MainThread]: Command end result
[0m14:45:54.450296 [info ] [MainThread]: 
[0m14:45:54.450580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:45:54.450750 [info ] [MainThread]: 
[0m14:45:54.450939 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 4 at position 43
  invalid identifier 'GAMES_GAME_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:45:54.451093 [info ] [MainThread]: 
[0m14:45:54.451249 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:45:54.453741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.132393, "process_user_time": 2.166602, "process_kernel_time": 0.417526, "process_mem_max_rss": "190775296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:45:54.454063 [debug] [MainThread]: Command `dbt run` failed at 14:45:54.454025 after 29.13 seconds
[0m14:45:54.454317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1cd10>]}
[0m14:45:54.454486 [debug] [MainThread]: Flushing usage events
[0m14:46:38.911121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ab7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709ca90>]}


============================== 14:46:38.914144 | 44616d13-333b-46ca-8139-bf5889827501 ==============================
[0m14:46:38.914144 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:46:38.914480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:46:39.690103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfcd390>]}
[0m14:46:39.708829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f91b90>]}
[0m14:46:39.709339 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:46:39.770090 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:46:39.802541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:39.802731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:39.812989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd5a250>]}
[0m14:46:39.852753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd21650>]}
[0m14:46:39.853006 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:46:39.853172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cddbb90>]}
[0m14:46:39.854273 [info ] [MainThread]: 
[0m14:46:39.854546 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:46:39.856534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:46:39.863447 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:46:39.863636 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:46:39.863772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:41.481693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.617 seconds
[0m14:46:41.486829 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:46:42.024760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:46:42.035825 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:46:42.036177 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:46:42.036404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:43.478644 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.442 seconds
[0m14:46:43.480666 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:46:44.047151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ab810>]}
[0m14:46:44.048942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:44.049644 [info ] [MainThread]: 
[0m14:46:44.054471 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:46:44.055408 [info ] [Thread-1 (]: 1 of 9 START sql table model DEV.int_season_stats .............................. [RUN]
[0m14:46:44.056058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.int_season_stats)
[0m14:46:44.056702 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_season_stats
[0m14:46:44.072175 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_season_stats"
[0m14:46:44.073442 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_season_stats
[0m14:46:44.097438 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_season_stats"
[0m14:46:44.099070 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_season_stats"
[0m14:46:44.099393 [debug] [Thread-1 (]: On model.nba_analysis.int_season_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_season_stats"} */
create or replace transient table NBA_GAMES.DEV.int_season_stats
         as
        (

WITH season_stats AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        SEASON,
        SUM(PTS) AS total_points,
        SUM(AST) AS total_assists,
        SUM(REB) AS total_rebounds,
        AVG(FG_PCT) AS avg_field_goal_pct,
        AVG(FT_PCT) AS avg_free_throw_pct,
        AVG(FG3_PCT) AS avg_three_point_pct,
        SUM(FGM) AS total_field_goals_made,
        SUM(FGA) AS total_field_goals_attempted,
        SUM(FG3M) AS total_three_points_made,
        SUM(FG3A) AS total_three_points_attempted,
        SUM(FTM) AS total_free_throws_made,
        SUM(FTA) AS total_free_throws_attempted,
        SUM(STL) AS total_steals,
        SUM(BLK) AS total_blocks,
        SUM(turnover) AS total_turnovers,
        SUM(PF) AS total_personal_fouls,
        COUNT(DISTINCT GAME_ID) AS games_played
    FROM NBA_GAMES.DEV.int_player_stats
    GROUP BY PLAYER_ID, PLAYER_NAME, SEASON
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    SEASON,
    total_points,
    total_assists,
    total_rebounds,
    avg_field_goal_pct,
    avg_free_throw_pct,
    avg_three_point_pct,
    total_field_goals_made,
    total_field_goals_attempted,
    total_three_points_made,
    total_three_points_attempted,
    total_free_throws_made,
    total_free_throws_attempted,
    total_steals,
    total_blocks,
    total_turnovers,
    total_personal_fouls,
    games_played
FROM season_stats
        );
[0m14:46:44.099702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:47.169896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.069 seconds
[0m14:46:47.205938 [debug] [Thread-1 (]: On model.nba_analysis.int_season_stats: Close
[0m14:46:47.762288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747010>]}
[0m14:46:47.764510 [info ] [Thread-1 (]: 1 of 9 OK created sql table model DEV.int_season_stats ......................... [[32mSUCCESS 1[0m in 3.70s]
[0m14:46:47.765973 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:46:47.766853 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:46:47.767866 [info ] [Thread-1 (]: 2 of 9 START sql view model DEV.src_games ...................................... [RUN]
[0m14:46:47.768587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_season_stats, now model.nba_analysis.src_games)
[0m14:46:47.769069 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:46:47.772574 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:46:47.783383 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:46:47.808602 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:46:47.809787 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:46:47.810106 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:46:47.810402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:49.719299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.909 seconds
[0m14:46:49.729100 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:46:50.271144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2e0690>]}
[0m14:46:50.272047 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.50s]
[0m14:46:50.272775 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:46:50.273235 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:46:50.274022 [info ] [Thread-1 (]: 3 of 9 START sql view model DEV.src_games_details .............................. [RUN]
[0m14:46:50.274512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:46:50.274884 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:46:50.277872 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:46:50.279594 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:46:50.283800 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:46:50.286071 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:46:50.286665 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:46:50.287105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:52.148736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.861 seconds
[0m14:46:52.153427 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:46:52.690760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cdff510>]}
[0m14:46:52.692260 [info ] [Thread-1 (]: 3 of 9 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.42s]
[0m14:46:52.693035 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:46:52.693653 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:46:52.694360 [info ] [Thread-1 (]: 4 of 9 START sql view model DEV.src_players .................................... [RUN]
[0m14:46:52.694963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:46:52.695376 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:46:52.699044 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:46:52.700360 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:46:52.704816 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:46:52.706623 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:46:52.707378 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:46:52.708013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:54.542865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.835 seconds
[0m14:46:54.547980 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:46:55.150235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d358b90>]}
[0m14:46:55.152015 [info ] [Thread-1 (]: 4 of 9 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.45s]
[0m14:46:55.152835 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:46:55.153451 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:46:55.154679 [info ] [Thread-1 (]: 5 of 9 START sql view model DEV.src_ranking .................................... [RUN]
[0m14:46:55.155429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:46:55.155881 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:46:55.158763 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:46:55.163002 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:46:55.166846 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:46:55.168166 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:46:55.168523 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:46:55.168857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:56.985265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.816 seconds
[0m14:46:56.990032 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:46:57.591582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd5a150>]}
[0m14:46:57.593258 [info ] [Thread-1 (]: 5 of 9 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.44s]
[0m14:46:57.594276 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:46:57.594918 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:46:57.595616 [info ] [Thread-1 (]: 6 of 9 START sql view model DEV.src_teams ...................................... [RUN]
[0m14:46:57.596197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:46:57.596611 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:46:57.599085 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:46:57.600191 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:46:57.603897 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:46:57.605664 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:46:57.606080 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:46:57.606489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:59.326667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.720 seconds
[0m14:46:59.332217 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:46:59.878875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd22c50>]}
[0m14:46:59.880568 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.28s]
[0m14:46:59.881523 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:46:59.882214 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:46:59.883395 [info ] [Thread-1 (]: 7 of 9 START sql view model DEV.dim_seasons .................................... [RUN]
[0m14:46:59.884048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:46:59.884532 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:46:59.890673 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:46:59.892971 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:46:59.896556 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:46:59.897653 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:46:59.898027 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:46:59.898379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:01.554910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.656 seconds
[0m14:47:01.560148 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:47:02.129817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccb7e90>]}
[0m14:47:02.131897 [info ] [Thread-1 (]: 7 of 9 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.25s]
[0m14:47:02.132911 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:47:02.133660 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:47:02.134527 [info ] [Thread-1 (]: 8 of 9 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m14:47:02.135155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:47:02.135586 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:47:02.141752 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:47:02.143271 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:47:02.147203 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:47:02.148382 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:47:02.148784 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:47:02.149152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:03.695605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.546 seconds
[0m14:47:03.700591 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:47:04.254320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915dd90>]}
[0m14:47:04.255765 [info ] [Thread-1 (]: 8 of 9 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.12s]
[0m14:47:04.256466 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:47:04.257004 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:47:04.257757 [info ] [Thread-1 (]: 9 of 9 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m14:47:04.258354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m14:47:04.258815 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:47:04.268082 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:47:04.270133 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:47:04.274153 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:47:04.276023 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:47:04.276450 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:47:04.276811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:06.202523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.925 seconds
[0m14:47:06.208049 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:47:06.823406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44616d13-333b-46ca-8139-bf5889827501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d327e90>]}
[0m14:47:06.825336 [info ] [Thread-1 (]: 9 of 9 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.56s]
[0m14:47:06.826314 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:47:06.829942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:06.830528 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:47:06.831399 [info ] [MainThread]: 
[0m14:47:06.831910 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 26.98 seconds (26.98s).
[0m14:47:06.834125 [debug] [MainThread]: Command end result
[0m14:47:06.876992 [info ] [MainThread]: 
[0m14:47:06.877306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:06.877493 [info ] [MainThread]: 
[0m14:47:06.877698 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:47:06.880861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.002003, "process_user_time": 2.055883, "process_kernel_time": 0.464838, "process_mem_max_rss": "186564608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:47:06.881333 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:06.881272 after 28.00 seconds
[0m14:47:06.881634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a81c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dd5d0>]}
[0m14:47:06.881856 [debug] [MainThread]: Flushing usage events
[0m14:47:29.804928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c3f50>]}


============================== 14:47:29.807629 | 29a08b62-49cb-41df-a198-f272954fca5f ==============================
[0m14:47:29.807629 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:47:29.807996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --exclude int_player_stats int_season_stats', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:30.536555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f03e50>]}
[0m14:47:30.555464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e41d10>]}
[0m14:47:30.556035 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:47:30.617655 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:47:30.664368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:47:30.664579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:47:30.675213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070db510>]}
[0m14:47:30.731313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b303d0>]}
[0m14:47:30.731842 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:47:30.732208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a66410>]}
[0m14:47:30.734373 [info ] [MainThread]: 
[0m14:47:30.734801 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:47:30.737134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:47:30.750220 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:47:30.750617 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:47:30.750932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:32.289237 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.538 seconds
[0m14:47:32.293282 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:47:32.840710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:47:32.852706 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:47:32.853254 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:47:32.853613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:34.329194 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.475 seconds
[0m14:47:34.332896 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:47:34.863398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11682c750>]}
[0m14:47:34.864238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:34.864615 [info ] [MainThread]: 
[0m14:47:34.867195 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:47:34.867661 [info ] [Thread-1 (]: 1 of 8 START sql view model DEV.src_games ...................................... [RUN]
[0m14:47:34.868004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:47:34.868246 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:47:34.874211 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:47:34.875171 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:47:34.893026 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:47:34.893902 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:47:34.894142 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:47:34.894558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:36.820847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.926 seconds
[0m14:47:36.844766 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:47:37.407709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116859550>]}
[0m14:47:37.409081 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.54s]
[0m14:47:37.409884 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:47:37.410442 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:47:37.411379 [info ] [Thread-1 (]: 2 of 8 START sql view model DEV.src_games_details .............................. [RUN]
[0m14:47:37.412035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:47:37.412451 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:47:37.415858 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:47:37.418834 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:47:37.422829 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:47:37.424463 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:47:37.424943 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:47:37.425546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:39.241333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.815 seconds
[0m14:47:39.246755 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:47:39.801599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103befd90>]}
[0m14:47:39.803486 [info ] [Thread-1 (]: 2 of 8 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.39s]
[0m14:47:39.804686 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:47:39.805511 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:47:39.806460 [info ] [Thread-1 (]: 3 of 8 START sql view model DEV.src_players .................................... [RUN]
[0m14:47:39.807118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:47:39.807546 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:47:39.811531 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:47:39.812389 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:47:39.816113 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:47:39.817114 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:47:39.817418 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:47:39.817707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:41.461786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.644 seconds
[0m14:47:41.466899 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:47:42.007388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103befd90>]}
[0m14:47:42.008435 [info ] [Thread-1 (]: 3 of 8 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.20s]
[0m14:47:42.009223 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:47:42.009777 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:47:42.010715 [info ] [Thread-1 (]: 4 of 8 START sql view model DEV.src_ranking .................................... [RUN]
[0m14:47:42.011214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:47:42.011573 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:47:42.014309 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:47:42.015686 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:47:42.019144 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:47:42.020209 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:47:42.020545 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:47:42.020819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.792984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.770 seconds
[0m14:47:43.795537 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:47:44.399217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116bffa90>]}
[0m14:47:44.400399 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.39s]
[0m14:47:44.401454 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:47:44.402061 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:47:44.402602 [info ] [Thread-1 (]: 5 of 8 START sql view model DEV.src_teams ...................................... [RUN]
[0m14:47:44.403096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:47:44.403454 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:47:44.406366 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:47:44.407662 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:47:44.411538 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:47:44.412678 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:47:44.413016 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:47:44.413306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:46.241501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.827 seconds
[0m14:47:46.250288 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:47:46.859549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ed0fd0>]}
[0m14:47:46.861670 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.46s]
[0m14:47:46.862747 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:47:46.863500 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:47:46.864857 [info ] [Thread-1 (]: 6 of 8 START sql view model DEV.dim_seasons .................................... [RUN]
[0m14:47:46.865545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:47:46.866074 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:47:46.871426 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:47:46.873665 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:47:46.877063 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:47:46.878276 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:47:46.878714 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:47:46.879121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:48.594045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.715 seconds
[0m14:47:48.597509 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:47:49.147838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b4e10>]}
[0m14:47:49.149270 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.28s]
[0m14:47:49.150086 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:47:49.150671 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:47:49.151349 [info ] [Thread-1 (]: 7 of 8 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m14:47:49.152168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:47:49.152866 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:47:49.157349 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:47:49.158494 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:47:49.161810 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:47:49.162821 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:47:49.163197 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:47:49.163766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:50.826539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.662 seconds
[0m14:47:50.832236 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:47:51.468130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103428990>]}
[0m14:47:51.469592 [info ] [Thread-1 (]: 7 of 8 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.32s]
[0m14:47:51.470587 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:47:51.471239 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:47:51.472008 [info ] [Thread-1 (]: 8 of 8 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m14:47:51.472698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m14:47:51.473155 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:47:51.477635 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:47:51.480081 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:47:51.483794 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:47:51.485530 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:47:51.485925 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:47:51.486269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:53.274182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.787 seconds
[0m14:47:53.279485 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:47:53.925891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a08b62-49cb-41df-a198-f272954fca5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a2f090>]}
[0m14:47:53.927166 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.45s]
[0m14:47:53.927926 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:47:53.929888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:53.930334 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:47:53.930890 [info ] [MainThread]: 
[0m14:47:53.931319 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 23.20 seconds (23.20s).
[0m14:47:53.932979 [debug] [MainThread]: Command end result
[0m14:47:53.968705 [info ] [MainThread]: 
[0m14:47:53.969012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:53.969206 [info ] [MainThread]: 
[0m14:47:53.969418 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:47:53.972379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.199305, "process_user_time": 1.931091, "process_kernel_time": 0.433691, "process_mem_max_rss": "187842560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:47:53.972753 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:53.972710 after 24.20 seconds
[0m14:47:53.973015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dedc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116804310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bc5a10>]}
[0m14:47:53.973212 [debug] [MainThread]: Flushing usage events
[0m14:50:41.650378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112752690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c3f90>]}


============================== 14:50:41.653162 | 19cbaca3-245a-430c-9850-bef541078d0c ==============================
[0m14:50:41.653162 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:50:41.653470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --exclude int_player_stats int_season_stats', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:42.166303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240c4fd0>]}
[0m14:50:42.185046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f45e10>]}
[0m14:50:42.185562 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:50:42.245428 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:50:42.296645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:42.296836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:42.307241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127057cd0>]}
[0m14:50:42.350988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110656f90>]}
[0m14:50:42.351349 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:50:42.351541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b5690>]}
[0m14:50:42.352696 [info ] [MainThread]: 
[0m14:50:42.352968 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:42.354880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:50:42.361583 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:50:42.361765 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:50:42.361895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:44.017654 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.655 seconds
[0m14:50:44.021105 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:50:44.569249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:50:44.582868 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:50:44.583491 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:50:44.583958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:46.066844 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.483 seconds
[0m14:50:46.071631 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:50:46.636070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126441090>]}
[0m14:50:46.637064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:46.637570 [info ] [MainThread]: 
[0m14:50:46.640116 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:50:46.640775 [info ] [Thread-1 (]: 1 of 8 START sql view model DEV.src_games ...................................... [RUN]
[0m14:50:46.641273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:50:46.641660 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:50:46.646234 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:50:46.647031 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:50:46.663324 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:50:46.664810 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:50:46.664998 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:50:46.665240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:48.460306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.794 seconds
[0m14:50:48.488641 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:50:49.049704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084c7d0>]}
[0m14:50:49.051106 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.41s]
[0m14:50:49.051929 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:50:49.052735 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:50:49.053699 [info ] [Thread-1 (]: 2 of 8 START sql view model DEV.src_games_details .............................. [RUN]
[0m14:50:49.054414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:50:49.054917 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:50:49.057534 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:50:49.059962 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:50:49.063558 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:50:49.065193 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:50:49.065639 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:50:49.066029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:50.983836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.917 seconds
[0m14:50:50.989348 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:50:51.588700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b5ae410>]}
[0m14:50:51.590520 [info ] [Thread-1 (]: 2 of 8 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.53s]
[0m14:50:51.591579 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:50:51.592286 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:50:51.593042 [info ] [Thread-1 (]: 3 of 8 START sql view model DEV.src_players .................................... [RUN]
[0m14:50:51.593682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:50:51.594101 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:50:51.596348 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:50:51.596930 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:50:51.599292 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:50:51.599872 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:50:51.600053 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:50:51.600214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:53.278085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.678 seconds
[0m14:50:53.282385 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:50:53.945121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112457fd0>]}
[0m14:50:53.946342 [info ] [Thread-1 (]: 3 of 8 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:50:53.947092 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:50:53.947645 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:50:53.948393 [info ] [Thread-1 (]: 4 of 8 START sql view model DEV.src_ranking .................................... [RUN]
[0m14:50:53.949259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:50:53.949691 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:50:53.952109 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:50:53.954165 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:50:53.957415 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:50:53.958669 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:50:53.959438 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:50:53.959840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:55.783388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.823 seconds
[0m14:50:55.790146 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:50:56.377853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b4b10>]}
[0m14:50:56.378403 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.43s]
[0m14:50:56.378818 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:50:56.379133 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:50:56.379493 [info ] [Thread-1 (]: 5 of 8 START sql view model DEV.src_teams ...................................... [RUN]
[0m14:50:56.379801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:50:56.380048 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:50:56.381464 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:50:56.381974 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:50:56.385555 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:50:56.386559 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:50:56.386852 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:50:56.387276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:58.239750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.852 seconds
[0m14:50:58.244783 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:50:58.859617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e66390>]}
[0m14:50:58.861412 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.48s]
[0m14:50:58.862395 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:50:58.863031 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:50:58.863965 [info ] [Thread-1 (]: 6 of 8 START sql view model DEV.dim_seasons .................................... [RUN]
[0m14:50:58.864598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:50:58.865046 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:50:58.871440 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:50:58.873093 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:50:58.877002 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:50:58.878113 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:50:58.878504 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:50:58.878865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:00.622705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m14:51:00.628142 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:51:01.215937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f299d0>]}
[0m14:51:01.217783 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:51:01.218777 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:51:01.219439 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:51:01.220156 [info ] [Thread-1 (]: 7 of 8 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m14:51:01.220752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:51:01.221153 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:51:01.226234 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:51:01.227288 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:51:01.230662 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:51:01.232115 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:51:01.232594 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:51:01.233031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:03.260078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.026 seconds
[0m14:51:03.266437 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:51:03.875654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127039350>]}
[0m14:51:03.876722 [info ] [Thread-1 (]: 7 of 8 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.65s]
[0m14:51:03.877440 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:51:03.877996 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:51:03.878583 [info ] [Thread-1 (]: 8 of 8 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m14:51:03.879051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m14:51:03.879406 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:51:03.883132 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:51:03.884852 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:51:03.887694 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:51:03.889335 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:51:03.890176 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:51:03.890521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:05.920453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.029 seconds
[0m14:51:05.924998 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:51:06.526372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cbaca3-245a-430c-9850-bef541078d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c5ed90>]}
[0m14:51:06.528409 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.65s]
[0m14:51:06.529550 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:51:06.531862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:06.532296 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:51:06.532987 [info ] [MainThread]: 
[0m14:51:06.533404 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 24.18 seconds (24.18s).
[0m14:51:06.535395 [debug] [MainThread]: Command end result
[0m14:51:06.569390 [info ] [MainThread]: 
[0m14:51:06.569703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:06.569910 [info ] [MainThread]: 
[0m14:51:06.570112 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:51:06.572472 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.95149, "process_user_time": 1.926911, "process_kernel_time": 0.331164, "process_mem_max_rss": "189431808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:06.572915 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:06.572864 after 24.95 seconds
[0m14:51:06.573186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a9590>]}
[0m14:51:06.573395 [debug] [MainThread]: Flushing usage events
[0m14:52:55.778389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddf450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e35b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e4ff90>]}


============================== 14:52:55.781179 | 7c6169d2-d5ac-4925-aac6-e92a56fec22d ==============================
[0m14:52:55.781179 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:52:55.781525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:56.309443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e24a010>]}
[0m14:52:56.328661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108895e90>]}
[0m14:52:56.329214 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:52:56.390610 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:52:56.424489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:56.424695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:56.435032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e55b210>]}
[0m14:52:56.473808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2dc510>]}
[0m14:52:56.474161 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:52:56.474332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd2de10>]}
[0m14:52:56.475470 [info ] [MainThread]: 
[0m14:52:56.475744 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:56.477679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:52:56.484259 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:52:56.484432 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:52:56.484561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:58.353056 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.868 seconds
[0m14:52:58.356260 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:52:58.971099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:52:58.979017 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:52:58.979314 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:52:58.979547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:00.553217 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.573 seconds
[0m14:53:00.558524 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:53:01.226447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fef90>]}
[0m14:53:01.227257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:01.227670 [info ] [MainThread]: 
[0m14:53:01.231145 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:53:01.231819 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:53:01.232360 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:53:01.232696 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:53:01.240154 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:53:01.241340 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:53:01.262186 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:53:01.263144 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:53:01.263412 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:53:01.263699 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:03.490394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.226 seconds
[0m14:53:03.519510 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:53:04.195067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e835e90>]}
[0m14:53:04.196230 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.96s]
[0m14:53:04.196969 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:53:04.197497 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:53:04.198200 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:53:04.198873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:53:04.199290 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:53:04.201430 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:53:04.203341 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:53:04.206459 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:53:04.207921 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:53:04.208299 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:53:04.208638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:06.243551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.034 seconds
[0m14:53:06.250324 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:53:06.860473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a8710>]}
[0m14:53:06.862463 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.66s]
[0m14:53:06.863745 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:53:06.864378 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:53:06.865235 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:53:06.865964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:53:06.866424 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:53:06.869541 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:53:06.871727 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:53:06.876011 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:53:06.877141 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:53:06.877526 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:53:06.877872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:08.673074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.795 seconds
[0m14:53:08.678413 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:53:09.225552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e989c10>]}
[0m14:53:09.226641 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.36s]
[0m14:53:09.227393 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:53:09.227948 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:53:09.228847 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:53:09.229465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:53:09.229989 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:53:09.232665 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:53:09.234743 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:53:09.237855 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:53:09.239617 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:53:09.239993 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:53:09.240308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:10.951172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.710 seconds
[0m14:53:10.956054 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:53:11.556405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824be50>]}
[0m14:53:11.557310 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.33s]
[0m14:53:11.558000 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:53:11.558512 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:53:11.559177 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:53:11.559830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:53:11.560445 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:53:11.562781 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:53:11.563541 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:53:11.568807 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:53:11.570256 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:53:11.570617 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:53:11.570956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:13.355418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.784 seconds
[0m14:53:13.360607 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:53:14.028389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a79010>]}
[0m14:53:14.030298 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.47s]
[0m14:53:14.031265 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:53:14.031941 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:53:14.032857 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:53:14.033468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:53:14.033936 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:53:14.039876 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:53:14.041655 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:53:14.045112 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:53:14.046405 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:53:14.046855 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:53:14.047225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:15.770882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.723 seconds
[0m14:53:15.775659 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:53:16.387510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108895850>]}
[0m14:53:16.389367 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m14:53:16.392853 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:53:16.393701 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:53:16.394758 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:53:16.395589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:53:16.396061 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:53:16.400217 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:53:16.401448 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:53:16.405040 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:53:16.406074 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:53:16.406449 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:53:16.406796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:18.126536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.719 seconds
[0m14:53:18.131059 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:53:18.684729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a79010>]}
[0m14:53:18.686568 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.29s]
[0m14:53:18.687414 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:53:18.688062 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:53:18.688853 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:53:18.689497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:53:18.689967 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:53:18.703127 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:53:18.705911 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:53:18.729355 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:53:18.729746 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as PLAYER_TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAMES_GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        TEAM_ID as DETAILS_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.PLAYER_TEAM_ID,
        gd.DETAILS_GAME_ID as details_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.DETAILS_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAMES_GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID as GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    DETAILS_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:53:18.730115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:20.781883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.051 seconds
[0m14:53:20.794018 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:53:20.794585 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats__dbt_tmp
[0m14:53:21.096333 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.301 seconds
[0m14:53:21.105960 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:53:21.106487 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table NBA_GAMES.DEV.int_player_stats
[0m14:53:21.395822 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.289 seconds
[0m14:53:21.410320 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:53:21.410820 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
describe table "NBA_GAMES"."DEV"."INT_PLAYER_STATS"
[0m14:53:21.703251 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.292 seconds
[0m14:53:21.738454 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.int_player_stats"
[0m14:53:21.740533 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:53:21.740806 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
-- back compat for old kwarg name
  
  begin;
[0m14:53:22.055591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m14:53:22.056906 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:53:22.057841 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
merge into NBA_GAMES.DEV.int_player_stats as DBT_INTERNAL_DEST
        using NBA_GAMES.DEV.int_player_stats__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.concat(games_game_id, PLAYER_ID) = DBT_INTERNAL_DEST.concat(games_game_id, PLAYER_ID)
            )

    
    when matched then update set
        "PLAYER_ID" = DBT_INTERNAL_SOURCE."PLAYER_ID","PLAYER_NAME" = DBT_INTERNAL_SOURCE."PLAYER_NAME","PLAYER_TEAM_ID" = DBT_INTERNAL_SOURCE."PLAYER_TEAM_ID","GAME_ID" = DBT_INTERNAL_SOURCE."GAME_ID","GAME_DATE_EST" = DBT_INTERNAL_SOURCE."GAME_DATE_EST","SEASON" = DBT_INTERNAL_SOURCE."SEASON","HOME_TEAM_ID" = DBT_INTERNAL_SOURCE."HOME_TEAM_ID","VISITOR_TEAM_ID" = DBT_INTERNAL_SOURCE."VISITOR_TEAM_ID","HOME_TEAM_WINS" = DBT_INTERNAL_SOURCE."HOME_TEAM_WINS","GAME_STATUS_TEXT" = DBT_INTERNAL_SOURCE."GAME_STATUS_TEXT","GAME_TEAM_ID" = DBT_INTERNAL_SOURCE."GAME_TEAM_ID","TEAM_ABBREVIATION" = DBT_INTERNAL_SOURCE."TEAM_ABBREVIATION","TEAM_CITY" = DBT_INTERNAL_SOURCE."TEAM_CITY","PLAYER_START_POSITION" = DBT_INTERNAL_SOURCE."PLAYER_START_POSITION","GAMES_MIN" = DBT_INTERNAL_SOURCE."GAMES_MIN","FGM" = DBT_INTERNAL_SOURCE."FGM","FGA" = DBT_INTERNAL_SOURCE."FGA","FG_PCT" = DBT_INTERNAL_SOURCE."FG_PCT","FT_PCT" = DBT_INTERNAL_SOURCE."FT_PCT","FG3_PCT" = DBT_INTERNAL_SOURCE."FG3_PCT","FG3M" = DBT_INTERNAL_SOURCE."FG3M","FG3A" = DBT_INTERNAL_SOURCE."FG3A","FTM" = DBT_INTERNAL_SOURCE."FTM","FTA" = DBT_INTERNAL_SOURCE."FTA","PTS" = DBT_INTERNAL_SOURCE."PTS","AST" = DBT_INTERNAL_SOURCE."AST","REB" = DBT_INTERNAL_SOURCE."REB","STL" = DBT_INTERNAL_SOURCE."STL","BLK" = DBT_INTERNAL_SOURCE."BLK","TURNOVER" = DBT_INTERNAL_SOURCE."TURNOVER","PF" = DBT_INTERNAL_SOURCE."PF","PLUS_MINUS" = DBT_INTERNAL_SOURCE."PLUS_MINUS"
    

    when not matched then insert
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")
    values
        ("PLAYER_ID", "PLAYER_NAME", "PLAYER_TEAM_ID", "GAME_ID", "GAME_DATE_EST", "SEASON", "HOME_TEAM_ID", "VISITOR_TEAM_ID", "HOME_TEAM_WINS", "GAME_STATUS_TEXT", "GAME_TEAM_ID", "TEAM_ABBREVIATION", "TEAM_CITY", "PLAYER_START_POSITION", "GAMES_MIN", "FGM", "FGA", "FG_PCT", "FT_PCT", "FG3_PCT", "FG3M", "FG3A", "FTM", "FTA", "PTS", "AST", "REB", "STL", "BLK", "TURNOVER", "PF", "PLUS_MINUS")

;
[0m14:53:22.432289 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86129-0102-31cd-0006-c35e00044c72
[0m14:53:22.432925 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 166
invalid identifier 'GAME_TEAM_ID'
[0m14:53:22.433596 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:53:23.005926 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 166
  invalid identifier 'GAME_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:53:23.006561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca7650>]}
[0m14:53:23.007259 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 4.32s]
[0m14:53:23.007850 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:53:23.008261 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:53:23.009780 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:53:23.010192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:53:23.010496 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:53:23.013442 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:53:23.014565 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:53:23.017267 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:53:23.018558 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:53:23.018861 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:53:23.019152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:24.879400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.860 seconds
[0m14:53:24.884975 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:53:25.458920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6169d2-d5ac-4925-aac6-e92a56fec22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824be50>]}
[0m14:53:25.460746 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.45s]
[0m14:53:25.461681 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:53:25.462341 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:53:25.463075 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:53:25.463737 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:53:25.465924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:25.466325 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:53:25.466958 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:53:25.467793 [info ] [MainThread]: 
[0m14:53:25.468313 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 28.99 seconds (28.99s).
[0m14:53:25.470203 [debug] [MainThread]: Command end result
[0m14:53:25.506264 [info ] [MainThread]: 
[0m14:53:25.506761 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:25.506977 [info ] [MainThread]: 
[0m14:53:25.507251 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 15 at position 166
  invalid identifier 'GAME_TEAM_ID'
  compiled code at target/run/nba_analysis/models/intermediate/int_player_stats.sql
[0m14:53:25.507503 [info ] [MainThread]: 
[0m14:53:25.507708 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:53:25.512029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 29.762753, "process_user_time": 2.216367, "process_kernel_time": 0.34287, "process_mem_max_rss": "195936256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:53:25.512428 [debug] [MainThread]: Command `dbt run` failed at 14:53:25.512373 after 29.76 seconds
[0m14:53:25.512724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de8610>]}
[0m14:53:25.512936 [debug] [MainThread]: Flushing usage events
[0m14:53:40.729695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f3fd0>]}


============================== 14:53:40.732347 | 310f9c52-04da-4cb7-9f09-5a16230c264b ==============================
[0m14:53:40.732347 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:53:40.732650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --exclude int_player_stats int_season_stats', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:53:41.251761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135613d0>]}
[0m14:53:41.271523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112207d10>]}
[0m14:53:41.272106 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:53:41.335524 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:53:41.386644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:41.386835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:41.397316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114944310>]}
[0m14:53:41.437038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148dfa10>]}
[0m14:53:41.437271 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:53:41.437563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e5c90>]}
[0m14:53:41.438740 [info ] [MainThread]: 
[0m14:53:41.439014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:41.440983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:53:41.447396 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:53:41.447552 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:53:41.447672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:43.215538 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.768 seconds
[0m14:53:43.219315 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:53:43.827973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:53:43.842004 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:53:43.842514 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:53:43.842839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:45.367686 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.525 seconds
[0m14:53:45.371980 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:53:45.979044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cd2190>]}
[0m14:53:45.980337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:45.980959 [info ] [MainThread]: 
[0m14:53:45.984991 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:53:45.985704 [info ] [Thread-1 (]: 1 of 8 START sql view model DEV.src_games ...................................... [RUN]
[0m14:53:45.986500 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:53:45.987072 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:53:45.995110 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:53:45.996254 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:53:46.017040 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:53:46.018019 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:53:46.018283 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:53:46.018516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:47.805988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.787 seconds
[0m14:53:47.832027 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:53:48.394436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd0c90>]}
[0m14:53:48.395580 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.41s]
[0m14:53:48.396321 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:53:48.396846 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:53:48.397532 [info ] [Thread-1 (]: 2 of 8 START sql view model DEV.src_games_details .............................. [RUN]
[0m14:53:48.398317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:53:48.398751 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:53:48.401264 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:53:48.403648 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:53:48.406981 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:53:48.408446 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:53:48.408803 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:53:48.409135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:50.578375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.169 seconds
[0m14:53:50.581454 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:53:51.192322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dc31d0>]}
[0m14:53:51.192882 [info ] [Thread-1 (]: 2 of 8 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.79s]
[0m14:53:51.193294 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:53:51.193551 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:53:51.193880 [info ] [Thread-1 (]: 3 of 8 START sql view model DEV.src_players .................................... [RUN]
[0m14:53:51.194209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:53:51.194431 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:53:51.195550 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:53:51.195964 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:53:51.197776 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:53:51.198330 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:53:51.198535 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:53:51.198726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:53.037113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.838 seconds
[0m14:53:53.041754 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:53:53.656888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10312a610>]}
[0m14:53:53.658635 [info ] [Thread-1 (]: 3 of 8 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.46s]
[0m14:53:53.659583 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:53:53.660186 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:53:53.661016 [info ] [Thread-1 (]: 4 of 8 START sql view model DEV.src_ranking .................................... [RUN]
[0m14:53:53.661744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:53:53.662196 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:53:53.664639 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:53:53.666740 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:53:53.670310 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:53:53.671684 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:53:53.672084 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:53:53.672390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:55.755135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.082 seconds
[0m14:53:55.760858 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:53:56.340110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c6e50>]}
[0m14:53:56.341830 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.68s]
[0m14:53:56.342692 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:53:56.343353 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:53:56.344057 [info ] [Thread-1 (]: 5 of 8 START sql view model DEV.src_teams ...................................... [RUN]
[0m14:53:56.344661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:53:56.345483 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:53:56.348181 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:53:56.349195 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:53:56.355110 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:53:56.356548 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:53:56.356970 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:53:56.357346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:58.055296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.697 seconds
[0m14:53:58.060125 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:53:58.743134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc5810>]}
[0m14:53:58.744913 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.40s]
[0m14:53:58.745713 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:53:58.746526 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:53:58.747498 [info ] [Thread-1 (]: 6 of 8 START sql view model DEV.dim_seasons .................................... [RUN]
[0m14:53:58.748200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:53:58.748696 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:53:58.752968 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:53:58.755073 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:53:58.758873 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:53:58.759974 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:53:58.760320 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:53:58.760664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:00.422781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.662 seconds
[0m14:54:00.428217 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:54:01.031046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250ecd10>]}
[0m14:54:01.032897 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.28s]
[0m14:54:01.033949 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:54:01.034691 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:54:01.035481 [info ] [Thread-1 (]: 7 of 8 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m14:54:01.036126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:54:01.036566 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:54:01.041596 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:54:01.042804 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:54:01.046163 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:54:01.047279 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:54:01.047662 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:54:01.048013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:02.882925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.834 seconds
[0m14:54:02.888254 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:54:03.425978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251525d0>]}
[0m14:54:03.427071 [info ] [Thread-1 (]: 7 of 8 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.39s]
[0m14:54:03.427803 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:54:03.428339 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:54:03.429069 [info ] [Thread-1 (]: 8 of 8 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m14:54:03.429727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m14:54:03.430179 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:54:03.433910 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:54:03.435787 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:54:03.438568 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:54:03.440043 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:54:03.440455 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:54:03.440832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.325528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.885 seconds
[0m14:54:05.328543 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:54:05.949273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310f9c52-04da-4cb7-9f09-5a16230c264b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cc510>]}
[0m14:54:05.951042 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.52s]
[0m14:54:05.951872 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:54:05.954764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:05.955368 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:54:05.955747 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:54:05.956332 [info ] [MainThread]: 
[0m14:54:05.956787 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 24.52 seconds (24.52s).
[0m14:54:05.958793 [debug] [MainThread]: Command end result
[0m14:54:06.000544 [info ] [MainThread]: 
[0m14:54:06.000880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:06.001084 [info ] [MainThread]: 
[0m14:54:06.001281 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:54:06.005629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.307606, "process_user_time": 1.949091, "process_kernel_time": 0.315558, "process_mem_max_rss": "192544768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:54:06.006050 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:06.005995 after 25.31 seconds
[0m14:54:06.006346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c45b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ba0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ba1490>]}
[0m14:54:06.006610 [debug] [MainThread]: Flushing usage events
[0m14:54:18.130401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043da150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104433f90>]}


============================== 14:54:18.132767 | c4ccb48c-fd2b-497e-a2e3-300cf612ce5e ==============================
[0m14:54:18.132767 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:54:18.133075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:18.612724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d6b50>]}
[0m14:54:18.631639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e85cd0>]}
[0m14:54:18.632680 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:54:18.697690 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:54:18.730852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:18.731045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:18.741391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b177d0>]}
[0m14:54:18.778030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6cc90>]}
[0m14:54:18.778288 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:54:18.778455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a358d0>]}
[0m14:54:18.779566 [info ] [MainThread]: 
[0m14:54:18.779841 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:54:18.781797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:54:18.787938 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:54:18.788109 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:54:18.788241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:20.483145 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.694 seconds
[0m14:54:20.487822 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:54:21.205328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:54:21.219051 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:54:21.219561 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:54:21.219902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:22.729220 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.509 seconds
[0m14:54:22.762184 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:54:23.319844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038aa5d0>]}
[0m14:54:23.321146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:23.321733 [info ] [MainThread]: 
[0m14:54:23.324764 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:54:23.325579 [info ] [Thread-1 (]: 1 of 10 START sql view model DEV.src_games ..................................... [RUN]
[0m14:54:23.326207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now model.nba_analysis.src_games)
[0m14:54:23.326532 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:54:23.333694 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:54:23.334668 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:54:23.368291 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:54:23.369319 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:54:23.369534 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:54:23.369701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:25.397741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.027 seconds
[0m14:54:25.427675 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:54:25.986355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109edc890>]}
[0m14:54:25.988293 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DEV.src_games ................................ [[32mSUCCESS 1[0m in 2.66s]
[0m14:54:25.989494 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:54:25.990293 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:54:25.991191 [info ] [Thread-1 (]: 2 of 10 START sql view model DEV.src_games_details ............................. [RUN]
[0m14:54:25.992180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:54:25.992657 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:54:25.995615 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:54:25.996970 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:54:26.000774 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:54:26.002537 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:54:26.003123 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:54:26.003569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:28.059677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.055 seconds
[0m14:54:28.073225 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:54:28.623830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10380fc90>]}
[0m14:54:28.625518 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DEV.src_games_details ........................ [[32mSUCCESS 1[0m in 2.63s]
[0m14:54:28.626642 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:54:28.627572 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:54:28.628645 [info ] [Thread-1 (]: 3 of 10 START sql view model DEV.src_players ................................... [RUN]
[0m14:54:28.629281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:54:28.629745 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:54:28.633185 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:54:28.634147 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:54:28.637658 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:54:28.638729 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:54:28.638958 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:54:28.639162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:30.239128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.599 seconds
[0m14:54:30.244051 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:54:30.798194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104433f50>]}
[0m14:54:30.803590 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DEV.src_players .............................. [[32mSUCCESS 1[0m in 2.17s]
[0m14:54:30.804967 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:54:30.805628 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:54:30.807736 [info ] [Thread-1 (]: 4 of 10 START sql view model DEV.src_ranking ................................... [RUN]
[0m14:54:30.808896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:54:30.809181 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:54:30.826797 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:54:30.828861 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:54:30.832151 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:54:30.833961 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:54:30.834231 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:54:30.834511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:32.584503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.750 seconds
[0m14:54:32.591003 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:54:33.131752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e868d0>]}
[0m14:54:33.133709 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DEV.src_ranking .............................. [[32mSUCCESS 1[0m in 2.32s]
[0m14:54:33.134831 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:54:33.135619 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:54:33.137193 [info ] [Thread-1 (]: 5 of 10 START sql view model DEV.src_teams ..................................... [RUN]
[0m14:54:33.137972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:54:33.138476 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:54:33.141992 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:54:33.143229 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:54:33.149488 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:54:33.151304 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:54:33.151979 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:54:33.152575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:34.908848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.756 seconds
[0m14:54:34.912194 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:54:35.449369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103094c90>]}
[0m14:54:35.452418 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DEV.src_teams ................................ [[32mSUCCESS 1[0m in 2.31s]
[0m14:54:35.454856 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:54:35.455559 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:54:35.456783 [info ] [Thread-1 (]: 6 of 10 START sql view model DEV.dim_seasons ................................... [RUN]
[0m14:54:35.457493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:54:35.458180 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:54:35.463368 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:54:35.465157 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:54:35.469025 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:54:35.470264 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:54:35.470685 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:54:35.471051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:37.174110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.702 seconds
[0m14:54:37.183422 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:54:37.726720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104405510>]}
[0m14:54:37.728855 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DEV.dim_seasons .............................. [[32mSUCCESS 1[0m in 2.27s]
[0m14:54:37.730010 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:54:37.731028 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:54:37.732105 [info ] [Thread-1 (]: 7 of 10 START sql view model DEV.dim_players_cleansed .......................... [RUN]
[0m14:54:37.733071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:54:37.733701 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:54:37.740535 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:54:37.741813 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:54:37.746009 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:54:37.747089 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:54:37.747434 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:54:37.747764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.435813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.687 seconds
[0m14:54:39.441431 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:54:40.038715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c795d0>]}
[0m14:54:40.039666 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DEV.dim_players_cleansed ..................... [[32mSUCCESS 1[0m in 2.31s]
[0m14:54:40.040211 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:54:40.040641 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_player_stats
[0m14:54:40.041193 [info ] [Thread-1 (]: 8 of 10 START sql incremental model DEV.int_player_stats ....................... [RUN]
[0m14:54:40.041711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.int_player_stats)
[0m14:54:40.042033 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.int_player_stats
[0m14:54:40.050585 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.int_player_stats"
[0m14:54:40.052434 [debug] [Thread-1 (]: Began executing node model.nba_analysis.int_player_stats
[0m14:54:40.073477 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.int_player_stats"
[0m14:54:40.073833 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.int_player_stats"} */
create or replace  temporary view NBA_GAMES.DEV.int_player_stats__dbt_tmp
  
   as (
    

WITH players_data AS (
    SELECT
        PLAYER_ID,
        PLAYER_NAME,
        TEAM_ID as PLAYER_TEAM_ID
    FROM NBA_GAMES.DEV.src_players
),

games_data AS (
    SELECT
        GAMES_GAME_ID,
        GAME_DATE_EST,
        SEASON,
        HOME_TEAM_ID,
        VISITOR_TEAM_ID,
        HOME_TEAM_WINS,
        GAME_STATUS_TEXT
    FROM NBA_GAMES.DEV.src_games
),

games_details_data AS (
    SELECT
        DETAILS_GAME_ID,
        DETAILS_team_id,
        TEAM_ABBREVIATION,
        TEAM_CITY,
        PLAYER_ID,
        PLAYER_START_POSITION,
        games_min,
        FGM,
        FGA,
        FG_PCT,
        FT_PCT,
        FG3_PCT,
        FG3M,
        FG3A,
        FTM,
        FTA,
        PTS,
        AST,
        REB,
        STL,
        BLK,
        turnover,
        PF,
        PLUS_MINUS
    FROM NBA_GAMES.DEV.src_games_details
),

combined_player_stats AS (
    SELECT
        p.PLAYER_ID,
        p.PLAYER_NAME,
        p.PLAYER_TEAM_ID,
        gd.DETAILS_GAME_ID as details_game_id,
        g.GAME_DATE_EST,
        g.SEASON,
        g.HOME_TEAM_ID,
        g.VISITOR_TEAM_ID,
        g.HOME_TEAM_WINS,
        g.GAME_STATUS_TEXT,
        gd.DETAILS_team_id,
        gd.TEAM_ABBREVIATION,
        gd.TEAM_CITY,
        gd.PLAYER_START_POSITION,
        gd.games_min,
        gd.FGM,
        gd.FGA,
        gd.FG_PCT,
        gd.FT_PCT,
        gd.FG3_PCT,
        gd.FG3M,
        gd.FG3A,
        gd.FTM,
        gd.FTA,
        gd.PTS,
        gd.AST,
        gd.REB,
        gd.STL,
        gd.BLK,
        gd.turnover,
        gd.PF,
        gd.PLUS_MINUS
    FROM players_data p
    JOIN games_details_data gd ON p.PLAYER_ID = gd.PLAYER_ID
    JOIN games_data g ON gd.DETAILS_GAME_ID = g.GAMES_GAME_ID
)

SELECT
    PLAYER_ID,
    PLAYER_NAME,
    DETAILS_GAME_ID as GAME_ID,
    player_team_id,
    GAME_DATE_EST,
    SEASON,
    HOME_TEAM_ID,
    VISITOR_TEAM_ID,
    HOME_TEAM_WINS,
    GAME_STATUS_TEXT,
    DETAILS_team_id,
    TEAM_ABBREVIATION,
    TEAM_CITY,
    PLAYER_START_POSITION,
    games_min,
    FGM,
    FGA,
    FG_PCT,
    FT_PCT,
    FG3_PCT,
    FG3M,
    FG3A,
    FTM,
    FTA,
    PTS,
    AST,
    REB,
    STL,
    BLK,
    turnover,
    PF,
    PLUS_MINUS
FROM combined_player_stats


  WHERE GAME_DATE_EST > (SELECT MAX(GAME_DATE_EST) FROM NBA_GAMES.DEV.int_player_stats)

  );
[0m14:54:40.074134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:41.600616 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8612a-0102-31cd-0006-c35e00044caa
[0m14:54:41.601317 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'DETAILS_TEAM_ID'
[0m14:54:41.601844 [debug] [Thread-1 (]: On model.nba_analysis.int_player_stats: Close
[0m14:54:42.151262 [debug] [Thread-1 (]: Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'DETAILS_TEAM_ID'
[0m14:54:42.152281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109838310>]}
[0m14:54:42.153122 [error] [Thread-1 (]: 8 of 10 ERROR creating sql incremental model DEV.int_player_stats .............. [[31mERROR[0m in 2.11s]
[0m14:54:42.153860 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_player_stats
[0m14:54:42.154378 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:54:42.156609 [info ] [Thread-1 (]: 9 of 10 START sql view model DEV.dim_teams_cleansed ............................ [RUN]
[0m14:54:42.157189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.int_player_stats, now model.nba_analysis.dim_teams_cleansed)
[0m14:54:42.157606 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:54:42.161604 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:54:42.162982 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:54:42.166095 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:54:42.167755 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:54:42.168272 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:54:42.168730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:43.803713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.635 seconds
[0m14:54:43.808856 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:54:44.352714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ccb48c-fd2b-497e-a2e3-300cf612ce5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104425790>]}
[0m14:54:44.354599 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DEV.dim_teams_cleansed ....................... [[32mSUCCESS 1[0m in 2.20s]
[0m14:54:44.355459 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:54:44.356047 [debug] [Thread-1 (]: Began running node model.nba_analysis.int_season_stats
[0m14:54:44.356732 [info ] [Thread-1 (]: 10 of 10 SKIP relation DEV.int_season_stats .................................... [[33mSKIP[0m]
[0m14:54:44.357357 [debug] [Thread-1 (]: Finished running node model.nba_analysis.int_season_stats
[0m14:54:44.359559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:44.359890 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:54:44.360427 [info ] [MainThread]: 
[0m14:54:44.360770 [info ] [MainThread]: Finished running 8 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 25.58 seconds (25.58s).
[0m14:54:44.363594 [debug] [MainThread]: Command end result
[0m14:54:44.403064 [info ] [MainThread]: 
[0m14:54:44.403408 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:54:44.403626 [info ] [MainThread]: 
[0m14:54:44.403868 [error] [MainThread]:   Database Error in model int_player_stats (models/intermediate/int_player_stats.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'DETAILS_TEAM_ID'
[0m14:54:44.404049 [info ] [MainThread]: 
[0m14:54:44.404240 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:54:44.408524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.307598, "process_user_time": 1.983816, "process_kernel_time": 0.464029, "process_mem_max_rss": "184598528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:54:44.408942 [debug] [MainThread]: Command `dbt run` failed at 14:54:44.408888 after 26.31 seconds
[0m14:54:44.409222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104432150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ae15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5b710>]}
[0m14:54:44.409428 [debug] [MainThread]: Flushing usage events
[0m14:55:54.483703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104366650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cbf90>]}


============================== 14:55:54.486414 | 8364736b-7881-4a02-85cb-b45f3b63e1bc ==============================
[0m14:55:54.486414 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:55:54.486716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --exclude int_player_stats int_season_stats', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:55.206153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed1950>]}
[0m14:55:55.230156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d1de50>]}
[0m14:55:55.230709 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:55:55.292665 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:55:55.346086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:55.346345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:55.357187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c5c0d0>]}
[0m14:55:55.397570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280f350>]}
[0m14:55:55.397828 [info ] [MainThread]: Found 10 models, 459 macros
[0m14:55:55.398002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b2d850>]}
[0m14:55:55.399186 [info ] [MainThread]: 
[0m14:55:55.399472 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:55.401422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m14:55:55.407977 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m14:55:55.408158 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m14:55:55.408295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:57.127416 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.707 seconds
[0m14:55:57.131303 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m14:55:57.678974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m14:55:57.689345 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m14:55:57.689935 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m14:55:57.690341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:59.290823 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.600 seconds
[0m14:55:59.295686 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m14:55:59.835059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e65610>]}
[0m14:55:59.836825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:59.837364 [info ] [MainThread]: 
[0m14:55:59.843127 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games
[0m14:55:59.844063 [info ] [Thread-1 (]: 1 of 8 START sql view model DEV.src_games ...................................... [RUN]
[0m14:55:59.845009 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.nba_analysis.src_games'
[0m14:55:59.845484 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games
[0m14:55:59.858053 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games"
[0m14:55:59.868461 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games
[0m14:55:59.934917 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games"
[0m14:55:59.935776 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games"
[0m14:55:59.935991 [debug] [Thread-1 (]: On model.nba_analysis.src_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games"} */
create or replace   view NBA_GAMES.DEV.src_games
  
   as (
    with raw_games AS (
SELECT * FROM NBA_GAMES.RAW.GAMES
)
SELECT 
CAST(GAME_DATE_EST AS DATE) as game_date_est,
CAST(GAME_ID AS INT) as games_game_id,
GAME_STATUS_TEXT as game_status_text,
CAST(HOME_TEAM_ID AS INT) as home_team_id, 
CAST(VISITOR_TEAM_ID AS INT) as visitor_team_id,
SEASON as season,
CAST("TEAM_ID_home" AS INT) as team_id_home,
"PTS_home" as pts_home,
"FT_PCT_home" as ft_pct_home,
"FG3_PCT_home" as fg3_pct_home,
"AST_home" as ast_home,
"REB_home" as reb_home,
CAST("TEAM_ID_away" AS INT) as team_id_away,
"PTS_away" as pts_away,
"FG_PCT_away" as fg_pct_away,
"FT_PCT_away" as ft_pct_away,
"FG3_PCT_away" as fg3_pct_away,
"AST_away" as ast_away,
"REB_away" as reb_away,
HOME_TEAM_WINS as home_team_wins
FROM raw_games
  );
[0m14:55:59.936195 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:56:01.700487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.764 seconds
[0m14:56:01.720967 [debug] [Thread-1 (]: On model.nba_analysis.src_games: Close
[0m14:56:02.296742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142acdd0>]}
[0m14:56:02.297736 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DEV.src_games ................................. [[32mSUCCESS 1[0m in 2.45s]
[0m14:56:02.298614 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games
[0m14:56:02.299341 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_games_details
[0m14:56:02.300042 [info ] [Thread-1 (]: 2 of 8 START sql view model DEV.src_games_details .............................. [RUN]
[0m14:56:02.300598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games, now model.nba_analysis.src_games_details)
[0m14:56:02.300779 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_games_details
[0m14:56:02.302157 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_games_details"
[0m14:56:02.303502 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_games_details
[0m14:56:02.306386 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_games_details"
[0m14:56:02.307307 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_games_details"
[0m14:56:02.307746 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_games_details"} */
create or replace   view NBA_GAMES.DEV.src_games_details
  
   as (
    WITH raw_games_details as (
SELECT * FROM NBA_GAMES.RAW.GAMES_DETAILS
)

SELECT 
CAST(GAME_ID AS INT) as details_game_id,
CAST(TEAM_ID AS INT) as details_team_id,
TEAM_ABBREVIATION as team_abbreviation,
TEAM_CITY as team_city,
CAST(PLAYER_ID AS INT) as player_id,
PLAYER_NAME as player_name,
NICKNAME as player_nickname,
START_POSITION as player_start_position,
COMMENT as comment_text, 
MIN as games_min,
FGM as fgm,
FGA as fga,
FG_PCT as fg_pct,
FG3M as fg3m,
FG3A as fg3a,
FG3_PCT as fg3_pct,
FTM as ftm,
FTA as fta,
FT_PCT as ft_pct,
OREB as oreb,
DREB as dreb,
REB as reb,
AST as ast,
STL as stl,
BLK as blk,
"TO" as turnover,
PF as pf,
PTS as pts,
PLUS_MINUS as plus_minus


FROM raw_games_details
  );
[0m14:56:02.308384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:04.075222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.766 seconds
[0m14:56:04.083732 [debug] [Thread-1 (]: On model.nba_analysis.src_games_details: Close
[0m14:56:04.628971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102570610>]}
[0m14:56:04.630495 [info ] [Thread-1 (]: 2 of 8 OK created sql view model DEV.src_games_details ......................... [[32mSUCCESS 1[0m in 2.33s]
[0m14:56:04.631606 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_games_details
[0m14:56:04.632410 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_players
[0m14:56:04.633266 [info ] [Thread-1 (]: 3 of 8 START sql view model DEV.src_players .................................... [RUN]
[0m14:56:04.633802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_games_details, now model.nba_analysis.src_players)
[0m14:56:04.634503 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_players
[0m14:56:04.637903 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_players"
[0m14:56:04.639419 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_players
[0m14:56:04.644096 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_players"
[0m14:56:04.644860 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_players"
[0m14:56:04.645164 [debug] [Thread-1 (]: On model.nba_analysis.src_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_players"} */
create or replace   view NBA_GAMES.DEV.src_players
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.RAW.PLAYERS
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:56:04.645486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:06.219923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m14:56:06.224333 [debug] [Thread-1 (]: On model.nba_analysis.src_players: Close
[0m14:56:06.770128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440b290>]}
[0m14:56:06.771530 [info ] [Thread-1 (]: 3 of 8 OK created sql view model DEV.src_players ............................... [[32mSUCCESS 1[0m in 2.14s]
[0m14:56:06.772403 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_players
[0m14:56:06.773035 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_ranking
[0m14:56:06.774077 [info ] [Thread-1 (]: 4 of 8 START sql view model DEV.src_ranking .................................... [RUN]
[0m14:56:06.774689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_players, now model.nba_analysis.src_ranking)
[0m14:56:06.775206 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_ranking
[0m14:56:06.778536 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_ranking"
[0m14:56:06.780769 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_ranking
[0m14:56:06.784779 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_ranking"
[0m14:56:06.786017 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_ranking"
[0m14:56:06.786302 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_ranking"} */
create or replace   view NBA_GAMES.DEV.src_ranking
  
   as (
    with ranking as (
SELECT * FROM NBA_GAMES.RAW.ranking
)
SELECT 
CAST(TEAM_ID AS INT) as team_id,
CAST(LEAGUE_ID AS INT) as league_id,
CAST(SEASON_ID AS INT) as season_id,
CAST(STANDINGSDATE AS DATE) as standings_date,
CONFERENCE as conference, 
TEAM as team,
G as g,
W as w,
L as l,
W_PCT as w_pct,
HOME_RECORD as home_record,
ROAD_RECORD as road_record,
RETURNTOPLAY as return_to_play
from ranking
  );
[0m14:56:06.786569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:08.422623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.633 seconds
[0m14:56:08.438715 [debug] [Thread-1 (]: On model.nba_analysis.src_ranking: Close
[0m14:56:09.029563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5a2d0>]}
[0m14:56:09.031551 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DEV.src_ranking ............................... [[32mSUCCESS 1[0m in 2.25s]
[0m14:56:09.032661 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_ranking
[0m14:56:09.033324 [debug] [Thread-1 (]: Began running node model.nba_analysis.src_teams
[0m14:56:09.034203 [info ] [Thread-1 (]: 5 of 8 START sql view model DEV.src_teams ...................................... [RUN]
[0m14:56:09.035211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_ranking, now model.nba_analysis.src_teams)
[0m14:56:09.035896 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.src_teams
[0m14:56:09.038364 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.src_teams"
[0m14:56:09.040919 [debug] [Thread-1 (]: Began executing node model.nba_analysis.src_teams
[0m14:56:09.046325 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.src_teams"
[0m14:56:09.047685 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.src_teams"
[0m14:56:09.048458 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.src_teams"} */
create or replace   view NBA_GAMES.DEV.src_teams
  
   as (
    with teams as (
SELECT * FROM NBA_GAMES.RAW.TEAMS
)
SELECT 
CAST(LEAGUE_ID AS INT) as league_id,
CAST(TEAM_ID AS INT) as team_id,
CAST(MIN_YEAR AS INT) as min_year,
CAST(MAX_YEAR AS INT) as max_year,
ABBREVIATION as team_abbreviation,
NICKNAME as team_nickname,
CAST(YEARFOUNDED AS INT) as year_founded,
CITY as city,
ARENA as arena,
ARENACAPACITY as arena_capacity,
OWNER as team_owner,
GENERALMANAGER as general_manager,
HEADCOACH as head_coach,
DLEAGUEAFFILIATION as dleague_affiliation

from teams
  );
[0m14:56:09.049048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:10.771672 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.722 seconds
[0m14:56:10.777105 [debug] [Thread-1 (]: On model.nba_analysis.src_teams: Close
[0m14:56:11.329611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f2cf50>]}
[0m14:56:11.330816 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DEV.src_teams ................................. [[32mSUCCESS 1[0m in 2.29s]
[0m14:56:11.331680 [debug] [Thread-1 (]: Finished running node model.nba_analysis.src_teams
[0m14:56:11.332294 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_seasons
[0m14:56:11.333141 [info ] [Thread-1 (]: 6 of 8 START sql view model DEV.dim_seasons .................................... [RUN]
[0m14:56:11.334029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.src_teams, now model.nba_analysis.dim_seasons)
[0m14:56:11.334423 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_seasons
[0m14:56:11.339461 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_seasons"
[0m14:56:11.342376 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_seasons
[0m14:56:11.345483 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_seasons"
[0m14:56:11.346389 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_seasons"
[0m14:56:11.346695 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_seasons"} */
create or replace   view NBA_GAMES.DEV.dim_seasons
  
   as (
    WITH seasons AS (
    SELECT * FROM NBA_GAMES.DEV.src_games
)
SELECT DISTINCT
    SEASON AS season_id,
    SEASON AS season_name,
    MIN(GAME_DATE_EST) AS start_date,
    MAX(GAME_DATE_EST) AS end_date
FROM seasons
GROUP BY SEASON
  );
[0m14:56:11.346970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:13.059352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.712 seconds
[0m14:56:13.065917 [debug] [Thread-1 (]: On model.nba_analysis.dim_seasons: Close
[0m14:56:13.630970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf36d0>]}
[0m14:56:13.632110 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DEV.dim_seasons ............................... [[32mSUCCESS 1[0m in 2.30s]
[0m14:56:13.632856 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_seasons
[0m14:56:13.633407 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_players_cleansed
[0m14:56:13.633977 [info ] [Thread-1 (]: 7 of 8 START sql view model DEV.dim_players_cleansed ........................... [RUN]
[0m14:56:13.634442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_seasons, now model.nba_analysis.dim_players_cleansed)
[0m14:56:13.634803 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_players_cleansed
[0m14:56:13.639497 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_players_cleansed"
[0m14:56:13.640782 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_players_cleansed
[0m14:56:13.644324 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_players_cleansed"
[0m14:56:13.645513 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_players_cleansed"
[0m14:56:13.645987 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_players_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_players_cleansed
  
   as (
    with players as (
SELECT * FROM NBA_GAMES.DEV.src_players
)
SELECT 
PLAYER_NAME as player_name,
CAST(TEAM_ID AS INT) as team_id,
CAST(PLAYER_ID as INT) as player_id,
CAST(SEASON as INT) as season

from players
  );
[0m14:56:13.646424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:15.252785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.606 seconds
[0m14:56:15.255757 [debug] [Thread-1 (]: On model.nba_analysis.dim_players_cleansed: Close
[0m14:56:15.834021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d01c10>]}
[0m14:56:15.835750 [info ] [Thread-1 (]: 7 of 8 OK created sql view model DEV.dim_players_cleansed ...................... [[32mSUCCESS 1[0m in 2.20s]
[0m14:56:15.836905 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_players_cleansed
[0m14:56:15.837697 [debug] [Thread-1 (]: Began running node model.nba_analysis.dim_teams_cleansed
[0m14:56:15.838239 [info ] [Thread-1 (]: 8 of 8 START sql view model DEV.dim_teams_cleansed ............................. [RUN]
[0m14:56:15.838991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba_analysis.dim_players_cleansed, now model.nba_analysis.dim_teams_cleansed)
[0m14:56:15.839385 [debug] [Thread-1 (]: Began compiling node model.nba_analysis.dim_teams_cleansed
[0m14:56:15.844681 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba_analysis.dim_teams_cleansed"
[0m14:56:15.846607 [debug] [Thread-1 (]: Began executing node model.nba_analysis.dim_teams_cleansed
[0m14:56:15.849549 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba_analysis.dim_teams_cleansed"
[0m14:56:15.850474 [debug] [Thread-1 (]: Using snowflake connection "model.nba_analysis.dim_teams_cleansed"
[0m14:56:15.850720 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "model.nba_analysis.dim_teams_cleansed"} */
create or replace   view NBA_GAMES.DEV.dim_teams_cleansed
  
   as (
    WITH teams AS (
    SELECT * FROM NBA_GAMES.DEV.src_teams
)
SELECT
    CASE
        WHEN LEAGUE_ID REGEXP '^[0-9]+$' THEN CAST(LEAGUE_ID AS INT)
        ELSE NULL
    END AS league_id,
    CASE
        WHEN TEAM_ID REGEXP '^[0-9]+$' THEN CAST(TEAM_ID AS INT)
        ELSE NULL
    END AS team_id,
    CASE
        WHEN MIN_YEAR REGEXP '^[0-9]+$' THEN CAST(MIN_YEAR AS INT)
        ELSE NULL
    END AS min_year,
    CASE
        WHEN MAX_YEAR REGEXP '^[0-9]+$' THEN CAST(MAX_YEAR AS INT)
        ELSE NULL
    END AS max_year,
    TEAM_ABBREVIATION AS team_abbreviation,
    TEAM_NICKNAME AS team_nickname,
    CASE
        WHEN year_founded REGEXP '^[0-9]+$' THEN CAST(year_founded AS INT)
        ELSE NULL
    END AS year_founded,
    CITY AS city,
    ARENA AS arena,
    NVL(arena_capacity, 0) AS arena_capacity,
    team_owner AS team_owner,
    general_manager AS general_manager,
    head_coach AS head_coach,
    dleague_affiliation AS dleague_affiliation
FROM teams
  );
[0m14:56:15.850957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:17.485327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.634 seconds
[0m14:56:17.490465 [debug] [Thread-1 (]: On model.nba_analysis.dim_teams_cleansed: Close
[0m14:56:18.039337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8364736b-7881-4a02-85cb-b45f3b63e1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036d3b50>]}
[0m14:56:18.040816 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DEV.dim_teams_cleansed ........................ [[32mSUCCESS 1[0m in 2.20s]
[0m14:56:18.041785 [debug] [Thread-1 (]: Finished running node model.nba_analysis.dim_teams_cleansed
[0m14:56:18.044461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:18.045089 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m14:56:18.045454 [debug] [MainThread]: Connection 'model.nba_analysis.dim_teams_cleansed' was properly closed.
[0m14:56:18.046036 [info ] [MainThread]: 
[0m14:56:18.046416 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 22.65 seconds (22.65s).
[0m14:56:18.048499 [debug] [MainThread]: Command end result
[0m14:56:18.100625 [info ] [MainThread]: 
[0m14:56:18.100993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:18.101200 [info ] [MainThread]: 
[0m14:56:18.101415 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:56:18.104026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.649601, "process_user_time": 1.930123, "process_kernel_time": 0.437487, "process_mem_max_rss": "184090624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:56:18.104480 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:18.104424 after 23.65 seconds
[0m14:56:18.104756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043be710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a1db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009795d0>]}
[0m14:56:18.104961 [debug] [MainThread]: Flushing usage events
[0m23:55:43.724483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f5cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa9a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb7fd0>]}


============================== 23:55:43.728663 | ebed6fee-5193-43da-9fa5-8a5a2327b073 ==============================
[0m23:55:43.728663 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:55:43.729144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:55:44.775158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebed6fee-5193-43da-9fa5-8a5a2327b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156d1f10>]}
[0m23:55:44.808391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebed6fee-5193-43da-9fa5-8a5a2327b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111745d90>]}
[0m23:55:44.809129 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:55:44.906365 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:55:44.982673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:55:44.983110 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m23:55:45.065088 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m23:55:45.091889 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.4186927, "process_user_time": 1.542707, "process_kernel_time": 0.404875, "process_mem_max_rss": "188481536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:55:45.092369 [debug] [MainThread]: Command `dbt snapshot` failed at 23:55:45.092290 after 1.42 seconds
[0m23:55:45.092685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f5eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103416a10>]}
[0m23:55:45.092964 [debug] [MainThread]: Flushing usage events
[0m23:57:26.181721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106505590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106513e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106513dd0>]}


============================== 23:57:26.185581 | 03fd0688-d068-49cd-9784-d402d987c909 ==============================
[0m23:57:26.185581 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:57:26.186050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:26.936586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03fd0688-d068-49cd-9784-d402d987c909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d6d90>]}
[0m23:57:26.969869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03fd0688-d068-49cd-9784-d402d987c909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f65d90>]}
[0m23:57:26.970623 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:57:27.067099 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:57:27.141670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:57:27.142085 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m23:57:27.223755 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m23:57:27.226478 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0898265, "process_user_time": 1.526062, "process_kernel_time": 0.302166, "process_mem_max_rss": "189628416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:57:27.226901 [debug] [MainThread]: Command `dbt snapshot` failed at 23:57:27.226828 after 1.09 seconds
[0m23:57:27.227202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106513cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e9350>]}
[0m23:57:27.227478 [debug] [MainThread]: Flushing usage events
[0m00:00:28.459748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111706f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111707710>]}


============================== 00:00:28.464222 | c8af4722-4c96-4827-8399-fc3609fa865c ==============================
[0m00:00:28.464222 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:00:28.464685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:29.505403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8af4722-4c96-4827-8399-fc3609fa865c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121488e10>]}
[0m00:00:29.538215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8af4722-4c96-4827-8399-fc3609fa865c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111145d50>]}
[0m00:00:29.538950 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:00:29.642318 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:00:29.719487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:00:29.719972 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:00:29.801765 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m00:00:29.804639 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.3919569, "process_user_time": 1.550701, "process_kernel_time": 0.375125, "process_mem_max_rss": "187809792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:00:29.805158 [debug] [MainThread]: Command `dbt snapshot` failed at 00:00:29.805005 after 1.39 seconds
[0m00:00:29.805475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116e5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505d5d0>]}
[0m00:00:29.805770 [debug] [MainThread]: Flushing usage events
[0m00:00:39.224136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b7fd0>]}


============================== 00:00:39.227642 | 6bbf0fac-3d2d-4ef8-9dc7-22e7af4dbd98 ==============================
[0m00:00:39.227642 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:00:39.228105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:39.998706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbf0fac-3d2d-4ef8-9dc7-22e7af4dbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec81d10>]}
[0m00:00:40.032322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbf0fac-3d2d-4ef8-9dc7-22e7af4dbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f45d50>]}
[0m00:00:40.033047 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:00:40.128725 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:00:40.199187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:00:40.199602 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:00:40.280691 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  invalid syntax for function call expression
    line 3
      {{config(
[0m00:00:40.282489 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0995405, "process_user_time": 1.557744, "process_kernel_time": 0.297744, "process_mem_max_rss": "184090624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:00:40.282914 [debug] [MainThread]: Command `dbt snapshot` failed at 00:00:40.282840 after 1.10 seconds
[0m00:00:40.283232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076db8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f306690>]}
[0m00:00:40.283553 [debug] [MainThread]: Flushing usage events
[0m00:01:34.870415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108710c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877bf90>]}


============================== 00:01:34.874450 | 49f8e70b-27af-4adb-b3ed-73fcd276eb62 ==============================
[0m00:01:34.874450 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:01:34.874930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:01:35.618527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f8e70b-27af-4adb-b3ed-73fcd276eb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878fd50>]}
[0m00:01:35.651695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f8e70b-27af-4adb-b3ed-73fcd276eb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bde10>]}
[0m00:01:35.652450 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:35.749034 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:01:35.822568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:01:35.822980 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:01:35.948964 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.nba_analysis.scd_raw_players' (snapshots/scd_raw_players.sql) depends on a source named 'nba_games.players' which was not found
[0m00:01:35.952454 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1320323, "process_user_time": 1.564408, "process_kernel_time": 0.297028, "process_mem_max_rss": "188055552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:01:35.952892 [debug] [MainThread]: Command `dbt snapshot` failed at 00:01:35.952822 after 1.13 seconds
[0m00:01:35.953207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108712cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe82ad0>]}
[0m00:01:35.953492 [debug] [MainThread]: Flushing usage events
[0m00:01:58.950502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107103f90>]}


============================== 00:01:58.954190 | 834d3a8d-10a4-441a-9d61-a372c8eb78c3 ==============================
[0m00:01:58.954190 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:01:58.954711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:59.630428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '834d3a8d-10a4-441a-9d61-a372c8eb78c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117afcb90>]}
[0m00:01:59.663467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '834d3a8d-10a4-441a-9d61-a372c8eb78c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b55ed0>]}
[0m00:01:59.664274 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:59.761168 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:01:59.833269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:01:59.833712 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:01:59.958371 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.nba_analysis.scd_raw_players' (snapshots/scd_raw_players.sql) depends on a source named 'nba_games.raw_players' which was not found
[0m00:01:59.961586 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0513107, "process_user_time": 1.56016, "process_kernel_time": 0.267663, "process_mem_max_rss": "189808640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:01:59.962016 [debug] [MainThread]: Command `dbt snapshot` failed at 00:01:59.961947 after 1.05 seconds
[0m00:01:59.962317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070aac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117aeca10>]}
[0m00:01:59.962602 [debug] [MainThread]: Flushing usage events
[0m00:02:22.045747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f7fd0>]}


============================== 00:02:22.049746 | 46486b6a-7b74-4e25-acc6-0d0e03145e56 ==============================
[0m00:02:22.049746 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:02:22.050250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:02:22.784761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46486b6a-7b74-4e25-acc6-0d0e03145e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188e1cd0>]}
[0m00:02:22.817942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46486b6a-7b74-4e25-acc6-0d0e03145e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b39cd0>]}
[0m00:02:22.818670 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:02:22.916803 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:02:22.993335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:02:22.993786 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:02:23.119482 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.nba_analysis.scd_raw_players' (snapshots/scd_raw_players.sql) depends on a source named 'nba_games.raw.players' which was not found
[0m00:02:23.122769 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1205237, "process_user_time": 1.567998, "process_kernel_time": 0.300931, "process_mem_max_rss": "191414272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:02:23.123201 [debug] [MainThread]: Command `dbt snapshot` failed at 00:02:23.123132 after 1.12 seconds
[0m00:02:23.123503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d22490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ef37d0>]}
[0m00:02:23.123777 [debug] [MainThread]: Flushing usage events
[0m00:02:44.444938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af3f90>]}


============================== 00:02:44.448598 | f98e8dfd-b58a-4066-b0b3-a637e6c2dae4 ==============================
[0m00:02:44.448598 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:02:44.449104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:02:45.412232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f98e8dfd-b58a-4066-b0b3-a637e6c2dae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a837d0>]}
[0m00:02:45.445076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f98e8dfd-b58a-4066-b0b3-a637e6c2dae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b5dd0>]}
[0m00:02:45.446435 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:02:45.543832 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:02:45.618582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:02:45.619053 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:02:45.745381 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.nba_analysis.scd_raw_players' (snapshots/scd_raw_players.sql) depends on a source named 'NBA_GAMES.RAW.PLAYERS' which was not found
[0m00:02:45.748791 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.3491503, "process_user_time": 1.572977, "process_kernel_time": 0.365087, "process_mem_max_rss": "189693952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:02:45.749252 [debug] [MainThread]: Command `dbt snapshot` failed at 00:02:45.749173 after 1.35 seconds
[0m00:02:45.749565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116092790>]}
[0m00:02:45.749850 [debug] [MainThread]: Flushing usage events
[0m00:02:56.518210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f667d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbe8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fcbf90>]}


============================== 00:02:56.521828 | 46494146-6cb8-438c-a66a-25230140a176 ==============================
[0m00:02:56.521828 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:02:56.522294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:02:57.230683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46494146-6cb8-438c-a66a-25230140a176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e99350>]}
[0m00:02:57.263562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46494146-6cb8-438c-a66a-25230140a176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1de10>]}
[0m00:02:57.264300 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:02:57.362339 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:02:57.433330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:02:57.433744 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:02:57.516244 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  source() takes exactly two arguments (3 given)
[0m00:02:57.518766 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0418972, "process_user_time": 1.527707, "process_kernel_time": 0.267457, "process_mem_max_rss": "188628992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:02:57.519211 [debug] [MainThread]: Command `dbt snapshot` failed at 00:02:57.519136 after 1.04 seconds
[0m00:02:57.519533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f72bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016795d0>]}
[0m00:02:57.519812 [debug] [MainThread]: Flushing usage events
[0m00:03:21.538487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104503ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452bf90>]}


============================== 00:03:21.542162 | b811ccad-0e6d-4aa2-8397-70c59568a8f7 ==============================
[0m00:03:21.542162 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:03:21.542614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:03:22.291407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b811ccad-0e6d-4aa2-8397-70c59568a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454a9d0>]}
[0m00:03:22.326578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b811ccad-0e6d-4aa2-8397-70c59568a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f7dd90>]}
[0m00:03:22.327458 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:03:22.426662 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:03:22.500907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:03:22.501348 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:03:22.627777 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.nba_analysis.scd_raw_players' (snapshots/scd_raw_players.sql) depends on a source named 'nba_games.players' which was not found
[0m00:03:22.631148 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1368529, "process_user_time": 1.581947, "process_kernel_time": 0.28702, "process_mem_max_rss": "190775296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:03:22.631612 [debug] [MainThread]: Command `dbt snapshot` failed at 00:03:22.631537 after 1.14 seconds
[0m00:03:22.631929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d2d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bd95d0>]}
[0m00:03:22.632262 [debug] [MainThread]: Flushing usage events
[0m00:07:36.256611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ebbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ebf90>]}


============================== 00:07:36.260524 | c17ec93b-e0ab-44c2-b294-16b6eb9a9dd5 ==============================
[0m00:07:36.260524 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:07:36.261002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:36.358794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c17ec93b-e0ab-44c2-b294-16b6eb9a9dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d07d0>]}
[0m00:07:36.373804 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:07:36.374576 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:07:36.376490 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.16509642, "process_user_time": 0.910871, "process_kernel_time": 0.153282, "process_mem_max_rss": "102842368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:07:36.376936 [debug] [MainThread]: Command `dbt deps` succeeded at 00:07:36.376846 after 0.17 seconds
[0m00:07:36.377219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106209090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106192ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10293dd10>]}
[0m00:07:36.377502 [debug] [MainThread]: Flushing usage events
[0m00:07:45.965959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106506190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106506910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106507910>]}


============================== 00:07:45.969387 | 5f68632a-d83a-4147-8e3c-ac539b9760f0 ==============================
[0m00:07:45.969387 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:07:45.969859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:46.702184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f68632a-d83a-4147-8e3c-ac539b9760f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a83d0>]}
[0m00:07:46.735067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f68632a-d83a-4147-8e3c-ac539b9760f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb1d50>]}
[0m00:07:46.735855 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:07:46.834369 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:07:46.910356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m00:07:46.910817 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/sources.yml
[0m00:07:46.911076 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:07:47.138159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f68632a-d83a-4147-8e3c-ac539b9760f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be5d710>]}
[0m00:07:47.267265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f68632a-d83a-4147-8e3c-ac539b9760f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfe70d0>]}
[0m00:07:47.267712 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 source, 459 macros
[0m00:07:47.267983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f68632a-d83a-4147-8e3c-ac539b9760f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdeb3d0>]}
[0m00:07:47.269203 [info ] [MainThread]: 
[0m00:07:47.269596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:47.270184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m00:07:47.279579 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m00:07:47.279884 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m00:07:47.280108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:49.027009 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.747 seconds
[0m00:07:49.030843 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m00:07:49.777714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m00:07:49.788179 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m00:07:49.788597 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m00:07:49.788912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:51.232821 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.444 seconds
[0m00:07:51.237766 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m00:07:51.747079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now list_NBA_GAMES_dev)
[0m00:07:51.753147 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_dev"
[0m00:07:51.753698 [debug] [ThreadPool]: On list_NBA_GAMES_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_dev"} */
show objects in NBA_GAMES.dev limit 10000
[0m00:07:51.754068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:53.232509 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.478 seconds
[0m00:07:53.236894 [debug] [ThreadPool]: On list_NBA_GAMES_dev: Close
[0m00:07:53.840383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f68632a-d83a-4147-8e3c-ac539b9760f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd86a90>]}
[0m00:07:53.841151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:53.841571 [info ] [MainThread]: 
[0m00:07:53.845334 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_players
[0m00:07:53.845982 [info ] [Thread-1 (]: 1 of 1 START snapshot dev.scd_raw_players ...................................... [RUN]
[0m00:07:53.846523 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.nba_analysis.scd_raw_players'
[0m00:07:53.846895 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_players
[0m00:07:53.855450 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_players
[0m00:07:53.915389 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:07:53.915785 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.dev.players

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:53.916099 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:07:55.473158 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86353-0102-3313-0006-c35e0004a04e
[0m00:07:55.473938 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'NBA_GAMES.DEV.PLAYERS' does not exist or not authorized.
[0m00:07:55.474716 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: Close
[0m00:07:56.000069 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  002003 (42S02): SQL compilation error:
  Object 'NBA_GAMES.DEV.PLAYERS' does not exist or not authorized.
[0m00:07:56.002058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68632a-d83a-4147-8e3c-ac539b9760f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe7c50>]}
[0m00:07:56.003114 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting dev.scd_raw_players .................................. [[31mERROR[0m in 2.15s]
[0m00:07:56.003835 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_players
[0m00:07:56.005961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:56.006297 [debug] [MainThread]: Connection 'list_NBA_GAMES_dev' was properly closed.
[0m00:07:56.006565 [debug] [MainThread]: Connection 'snapshot.nba_analysis.scd_raw_players' was properly closed.
[0m00:07:56.006877 [info ] [MainThread]: 
[0m00:07:56.007194 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m00:07:56.007956 [debug] [MainThread]: Command end result
[0m00:07:56.038124 [info ] [MainThread]: 
[0m00:07:56.038482 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:07:56.038702 [info ] [MainThread]: 
[0m00:07:56.038953 [error] [MainThread]:   Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  002003 (42S02): SQL compilation error:
  Object 'NBA_GAMES.DEV.PLAYERS' does not exist or not authorized.
[0m00:07:56.039162 [info ] [MainThread]: 
[0m00:07:56.039368 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:07:56.041687 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 10.117387, "process_user_time": 2.275007, "process_kernel_time": 0.3547, "process_mem_max_rss": "196820992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:07:56.042094 [debug] [MainThread]: Command `dbt snapshot` failed at 00:07:56.042032 after 10.12 seconds
[0m00:07:56.042381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c0d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c0cd10>]}
[0m00:07:56.042631 [debug] [MainThread]: Flushing usage events
[0m00:09:22.415796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f3f90>]}


============================== 00:09:22.419592 | 76af8315-c62b-407d-9332-94fcf2b4f1f9 ==============================
[0m00:09:22.419592 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:09:22.420060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:09:23.163903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76af8315-c62b-407d-9332-94fcf2b4f1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098524d0>]}
[0m00:09:23.197366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76af8315-c62b-407d-9332-94fcf2b4f1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104045cd0>]}
[0m00:09:23.198156 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:09:23.296974 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:09:23.394254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:09:23.394810 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/sources.yml
[0m00:09:23.612893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76af8315-c62b-407d-9332-94fcf2b4f1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de7ed0>]}
[0m00:09:23.741701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76af8315-c62b-407d-9332-94fcf2b4f1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de0f10>]}
[0m00:09:23.742341 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 source, 459 macros
[0m00:09:23.742610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76af8315-c62b-407d-9332-94fcf2b4f1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee5c90>]}
[0m00:09:23.743846 [info ] [MainThread]: 
[0m00:09:23.744243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:09:23.744837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m00:09:23.754275 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m00:09:23.754545 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m00:09:23.754754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:25.417416 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.662 seconds
[0m00:09:25.420767 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m00:09:25.930740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m00:09:25.940484 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m00:09:25.940845 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m00:09:25.941113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:09:27.388048 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.447 seconds
[0m00:09:27.392438 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m00:09:28.051246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now list_NBA_GAMES_dev)
[0m00:09:28.058662 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_dev"
[0m00:09:28.059193 [debug] [ThreadPool]: On list_NBA_GAMES_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_dev"} */
show objects in NBA_GAMES.dev limit 10000
[0m00:09:28.059593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:09:29.498605 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.439 seconds
[0m00:09:29.501532 [debug] [ThreadPool]: On list_NBA_GAMES_dev: Close
[0m00:09:30.048583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76af8315-c62b-407d-9332-94fcf2b4f1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a0bb10>]}
[0m00:09:30.049531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:09:30.050078 [info ] [MainThread]: 
[0m00:09:30.053249 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_players
[0m00:09:30.053819 [info ] [Thread-1 (]: 1 of 1 START snapshot dev.scd_raw_players ...................................... [RUN]
[0m00:09:30.054373 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.nba_analysis.scd_raw_players'
[0m00:09:30.054667 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_players
[0m00:09:30.062643 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_players
[0m00:09:30.124301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:09:30.124719 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:30.125892 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:09:32.355290 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 2.229 seconds
[0m00:09:32.362872 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:09:32.363568 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:32.652822 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.288 seconds
[0m00:09:32.654498 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_players"
[0m00:09:32.659342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:09:32.659840 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
create or replace transient table NBA_GAMES.dev.scd_raw_players
         as
        (
    

    select *,
        md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players

    ) sbq



        );
[0m00:09:34.088417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.428 seconds
[0m00:09:34.117959 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: Close
[0m00:09:34.885770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76af8315-c62b-407d-9332-94fcf2b4f1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f51810>]}
[0m00:09:34.886966 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dev.scd_raw_players ...................................... [[32mSUCCESS 1[0m in 4.83s]
[0m00:09:34.887731 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_players
[0m00:09:34.889157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:09:34.889588 [debug] [MainThread]: Connection 'list_NBA_GAMES_dev' was properly closed.
[0m00:09:34.889925 [debug] [MainThread]: Connection 'snapshot.nba_analysis.scd_raw_players' was properly closed.
[0m00:09:34.890382 [info ] [MainThread]: 
[0m00:09:34.890712 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m00:09:34.891313 [debug] [MainThread]: Command end result
[0m00:09:34.922372 [info ] [MainThread]: 
[0m00:09:34.922739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:09:34.922962 [info ] [MainThread]: 
[0m00:09:34.923186 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:09:34.925718 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.55548, "process_user_time": 2.324484, "process_kernel_time": 0.387056, "process_mem_max_rss": "196149248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:09:34.926103 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:09:34.926048 after 12.56 seconds
[0m00:09:34.926373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a194150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d45c90>]}
[0m00:09:34.926625 [debug] [MainThread]: Flushing usage events
[0m00:11:39.230022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb7ed0>]}


============================== 00:11:39.234082 | dc2366bf-f8af-41f5-9de8-4ce4605cf395 ==============================
[0m00:11:39.234082 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:11:39.234546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:39.987918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc2366bf-f8af-41f5-9de8-4ce4605cf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f96d50>]}
[0m00:11:40.022630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc2366bf-f8af-41f5-9de8-4ce4605cf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fdd90>]}
[0m00:11:40.023535 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:40.121583 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:11:40.219044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:11:40.219501 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_teams.sql
[0m00:11:40.315466 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_teams (snapshots/scd_raw_teams.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m00:11:40.322423 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1379054, "process_user_time": 1.587782, "process_kernel_time": 0.306626, "process_mem_max_rss": "189988864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:11:40.324418 [debug] [MainThread]: Command `dbt snapshot` failed at 00:11:40.323969 after 1.14 seconds
[0m00:11:40.325139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b52d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012595d0>]}
[0m00:11:40.325929 [debug] [MainThread]: Flushing usage events
[0m00:12:31.680895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109752b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7f90>]}


============================== 00:12:31.684850 | 9377f187-c564-412a-b112-50af2469723d ==============================
[0m00:12:31.684850 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:12:31.685329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:32.449355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9377f187-c564-412a-b112-50af2469723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d69d0>]}
[0m00:12:32.482540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9377f187-c564-412a-b112-50af2469723d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f45e10>]}
[0m00:12:32.483365 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:12:32.581763 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:12:32.680131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:12:32.680592 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_teams.sql
[0m00:12:32.796577 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.nba_analysis.scd_raw_teams' (snapshots/scd_raw_teams.sql) depends on a source named 'nba_games.teams' which was not found
[0m00:12:32.799655 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1639088, "process_user_time": 1.585309, "process_kernel_time": 0.311629, "process_mem_max_rss": "185090048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:12:32.800106 [debug] [MainThread]: Command `dbt snapshot` failed at 00:12:32.800030 after 1.16 seconds
[0m00:12:32.800416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d9b10>]}
[0m00:12:32.800705 [debug] [MainThread]: Flushing usage events
[0m00:13:04.018987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca3f90>]}


============================== 00:13:04.022772 | d37eebd9-81b2-4919-b372-f772a7952f14 ==============================
[0m00:13:04.022772 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:13:04.023283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:13:04.725612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd37eebd9-81b2-4919-b372-f772a7952f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0edb10>]}
[0m00:13:04.758930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd37eebd9-81b2-4919-b372-f772a7952f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f5cd0>]}
[0m00:13:04.759728 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:13:04.857147 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:13:04.952096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:13:04.952558 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_teams.sql
[0m00:13:04.952944 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/sources.yml
[0m00:13:05.131851 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.nba_analysis.scd_raw_teams' (snapshots/scd_raw_teams.sql) depends on a source named 'nba_games.teams' which was not found
[0m00:13:05.134640 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1586357, "process_user_time": 1.655427, "process_kernel_time": 0.278263, "process_mem_max_rss": "193380352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:13:05.135070 [debug] [MainThread]: Command `dbt snapshot` failed at 00:13:05.135000 after 1.16 seconds
[0m00:13:05.135378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a617fd0>]}
[0m00:13:05.135654 [debug] [MainThread]: Flushing usage events
[0m00:13:56.715110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105172c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d7f90>]}


============================== 00:13:56.719191 | 3addbfaa-206e-48b7-bf37-7e0e7032b4f7 ==============================
[0m00:13:56.719191 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:13:56.719676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:13:57.463259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3addbfaa-206e-48b7-bf37-7e0e7032b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c95db10>]}
[0m00:13:57.496610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3addbfaa-206e-48b7-bf37-7e0e7032b4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104309c90>]}
[0m00:13:57.497351 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:13:57.594076 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:13:57.663179 [error] [MainThread]: Encountered an error:
'str' object has no attribute 'get'
[0m00:13:57.664944 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 87, in load_source_file
    dfy = yaml_from_file(source_file)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/schemas.py", line 127, in yaml_from_file
    for table in source.get("tables", []):
                 ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'

[0m00:13:57.667831 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.9967698, "process_user_time": 1.472147, "process_kernel_time": 0.300503, "process_mem_max_rss": "185614336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:13:57.668252 [debug] [MainThread]: Command `dbt snapshot` failed at 00:13:57.668175 after 1.00 seconds
[0m00:13:57.668559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105172c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cb66110>]}
[0m00:13:57.668837 [debug] [MainThread]: Flushing usage events
[0m00:15:13.778063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb7f90>]}


============================== 00:15:13.782068 | d69bc13c-2e6b-435c-8b3d-88558e148f54 ==============================
[0m00:15:13.782068 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:15:13.782567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:15:14.539016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd69bc13c-2e6b-435c-8b3d-88558e148f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf8750>]}
[0m00:15:14.572244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd69bc13c-2e6b-435c-8b3d-88558e148f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105445e10>]}
[0m00:15:14.573004 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:15:14.671476 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:15:14.743775 [error] [MainThread]: Encountered an error:
'str' object has no attribute 'get'
[0m00:15:14.746122 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 87, in load_source_file
    dfy = yaml_from_file(source_file)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/schemas.py", line 127, in yaml_from_file
    for table in source.get("tables", []):
                 ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'

[0m00:15:14.748869 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0217729, "process_user_time": 1.477682, "process_kernel_time": 0.299119, "process_mem_max_rss": "189087744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:15:14.749278 [debug] [MainThread]: Command `dbt snapshot` failed at 00:15:14.749208 after 1.02 seconds
[0m00:15:14.749593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb7d90>]}
[0m00:15:14.749873 [debug] [MainThread]: Flushing usage events
[0m00:15:38.593184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413bf90>]}


============================== 00:15:38.596829 | 30a2efb2-5413-4fc8-ba27-0c7e35cd1eba ==============================
[0m00:15:38.596829 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:15:38.597347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:15:39.285309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30a2efb2-5413-4fc8-ba27-0c7e35cd1eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6e710>]}
[0m00:15:39.318338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30a2efb2-5413-4fc8-ba27-0c7e35cd1eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b8dd90>]}
[0m00:15:39.319079 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:15:39.419983 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:15:39.488061 [error] [MainThread]: Encountered an error:
'str' object has no attribute 'get'
[0m00:15:39.489783 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 87, in load_source_file
    dfy = yaml_from_file(source_file)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/schemas.py", line 127, in yaml_from_file
    for table in source.get("tables", []):
                 ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'

[0m00:15:39.492612 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.9425391, "process_user_time": 1.457745, "process_kernel_time": 0.26695, "process_mem_max_rss": "190283776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:15:39.493043 [debug] [MainThread]: Command `dbt snapshot` failed at 00:15:39.492973 after 0.94 seconds
[0m00:15:39.493357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e2d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007e8cd0>]}
[0m00:15:39.493641 [debug] [MainThread]: Flushing usage events
[0m00:16:24.547805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37e50>]}


============================== 00:16:24.552469 | cc8dea42-70fa-4b5b-ad63-a1fe6d390ed1 ==============================
[0m00:16:24.552469 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:16:24.552951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:25.302733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc8dea42-70fa-4b5b-ad63-a1fe6d390ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109385310>]}
[0m00:16:25.335896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc8dea42-70fa-4b5b-ad63-a1fe6d390ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487dc90>]}
[0m00:16:25.336894 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:16:25.433569 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:16:25.506351 [error] [MainThread]: Encountered an error:
'str' object has no attribute 'get'
[0m00:16:25.508125 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/manifest.py", line 377, in load
    file_reader.read_files()
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 154, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/read_files.py", line 87, in load_source_file
    dfy = yaml_from_file(source_file)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yogisharosarumaha/Documents/nba_analysis/venv/lib/python3.11/site-packages/dbt/parser/schemas.py", line 127, in yaml_from_file
    for table in source.get("tables", []):
                 ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'

[0m00:16:25.510906 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0057964, "process_user_time": 1.467312, "process_kernel_time": 0.275356, "process_mem_max_rss": "187891712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:16:25.511401 [debug] [MainThread]: Command `dbt snapshot` failed at 00:16:25.511328 after 1.01 seconds
[0m00:16:25.511722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a663d0>]}
[0m00:16:25.512016 [debug] [MainThread]: Flushing usage events
[0m00:17:30.189281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ab8d0>]}


============================== 00:17:30.193797 | 9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1 ==============================
[0m00:17:30.193797 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:17:30.194282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:17:31.203964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c82510>]}
[0m00:17:31.237496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110145bd0>]}
[0m00:17:31.238298 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:17:31.340642 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:17:31.440583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:17:31.441069 [debug] [MainThread]: Partial parsing: added file: nba_analysis://snapshots/scd_raw_teams.sql
[0m00:17:31.441459 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/sources.yml
[0m00:17:31.664364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c94890>]}
[0m00:17:31.800889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249df250>]}
[0m00:17:31.801336 [info ] [MainThread]: Found 10 models, 2 snapshots, 2 sources, 459 macros
[0m00:17:31.801605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124bace50>]}
[0m00:17:31.802921 [info ] [MainThread]: 
[0m00:17:31.803323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:31.806292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m00:17:31.816100 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m00:17:31.816381 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m00:17:31.816606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:33.675861 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.859 seconds
[0m00:17:33.679173 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m00:17:34.197637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m00:17:34.204526 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m00:17:34.204841 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m00:17:34.205063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:35.681909 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.477 seconds
[0m00:17:35.687233 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m00:17:36.249571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now list_NBA_GAMES_dev)
[0m00:17:36.256799 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_dev"
[0m00:17:36.257345 [debug] [ThreadPool]: On list_NBA_GAMES_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_dev"} */
show objects in NBA_GAMES.dev limit 10000
[0m00:17:36.257735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:37.673755 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.416 seconds
[0m00:17:37.678443 [debug] [ThreadPool]: On list_NBA_GAMES_dev: Close
[0m00:17:38.172905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12493de90>]}
[0m00:17:38.174429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:38.174941 [info ] [MainThread]: 
[0m00:17:38.178692 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_players
[0m00:17:38.179546 [info ] [Thread-1 (]: 1 of 2 START snapshot dev.scd_raw_players ...................................... [RUN]
[0m00:17:38.180374 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.nba_analysis.scd_raw_players'
[0m00:17:38.180936 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_players
[0m00:17:38.191125 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_players
[0m00:17:38.236641 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:38.237029 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select player_name, team_id, season from (
                



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:17:38.237325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:39.675279 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.437 seconds
[0m00:17:39.691803 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:39.692680 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:17:39.973117 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.280 seconds
[0m00:17:39.984000 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:39.984501 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:17:40.260103 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.275 seconds
[0m00:17:40.305392 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:40.305977 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:17:41.538806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.232 seconds
[0m00:17:41.546295 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:41.546925 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:17:41.827722 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.280 seconds
[0m00:17:41.838380 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:41.839062 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:17:42.096483 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.257 seconds
[0m00:17:42.106519 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:42.107189 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:17:42.382586 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.274 seconds
[0m00:17:42.389346 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:42.389945 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:17:42.643057 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.252 seconds
[0m00:17:42.656134 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:42.656633 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:17:42.952155 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.295 seconds
[0m00:17:42.979861 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:42.980559 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:17:43.295649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.314 seconds
[0m00:17:43.303754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:43.304475 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:17:43.561760 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.256 seconds
[0m00:17:43.563459 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_players"
[0m00:17:43.567610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:43.568386 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
BEGIN
[0m00:17:43.874658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m00:17:43.876262 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:17:43.876872 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:17:44.817240 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8635d-0102-3313-0006-c35e0004a0de
[0m00:17:44.818926 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m00:17:44.821224 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: Close
[0m00:17:45.337427 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:17:45.341781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fc6a90>]}
[0m00:17:45.343753 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting dev.scd_raw_players .................................. [[31mERROR[0m in 7.16s]
[0m00:17:45.344637 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_players
[0m00:17:45.345197 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_teams
[0m00:17:45.347313 [info ] [Thread-1 (]: 2 of 2 START snapshot dev.scd_raw_teams ........................................ [RUN]
[0m00:17:45.348009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.nba_analysis.scd_raw_players, now snapshot.nba_analysis.scd_raw_teams)
[0m00:17:45.348414 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_teams
[0m00:17:45.354224 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_teams
[0m00:17:45.361585 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:17:45.362011 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:17:45.362347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:46.777184 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.415 seconds
[0m00:17:46.780070 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:17:46.780724 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:17:47.054579 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.273 seconds
[0m00:17:47.055828 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_teams"
[0m00:17:47.058670 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:17:47.059272 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
create or replace transient table NBA_GAMES.dev.scd_raw_teams
         as
        (
    

    select *,
        md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams

    ) sbq



        );
[0m00:17:47.815183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m00:17:47.843655 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: Close
[0m00:17:48.355184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c991a37-6eb2-4ebe-82cf-cd9206ddfdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251f1b10>]}
[0m00:17:48.357108 [info ] [Thread-1 (]: 2 of 2 OK snapshotted dev.scd_raw_teams ........................................ [[32mSUCCESS 1[0m in 3.01s]
[0m00:17:48.358389 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_teams
[0m00:17:48.368127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:48.368804 [debug] [MainThread]: Connection 'list_NBA_GAMES_dev' was properly closed.
[0m00:17:48.369263 [debug] [MainThread]: Connection 'snapshot.nba_analysis.scd_raw_teams' was properly closed.
[0m00:17:48.369847 [info ] [MainThread]: 
[0m00:17:48.371394 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 16.57 seconds (16.57s).
[0m00:17:48.372882 [debug] [MainThread]: Command end result
[0m00:17:48.433727 [info ] [MainThread]: 
[0m00:17:48.434506 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:17:48.434846 [info ] [MainThread]: 
[0m00:17:48.435223 [error] [MainThread]:   Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:17:48.435559 [info ] [MainThread]: 
[0m00:17:48.436018 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:17:48.439106 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 18.2961, "process_user_time": 2.697868, "process_kernel_time": 0.549049, "process_mem_max_rss": "193036288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:17:48.439920 [debug] [MainThread]: Command `dbt snapshot` failed at 00:17:48.439803 after 18.30 seconds
[0m00:17:48.440586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108abc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c3d10>]}
[0m00:17:48.440932 [debug] [MainThread]: Flushing usage events
[0m00:18:35.168871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b162d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6ff90>]}


============================== 00:18:35.172911 | 91cd04e5-75dc-40e6-8c3f-965290183d8c ==============================
[0m00:18:35.172911 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:18:35.173381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:18:36.180493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fa7d0>]}
[0m00:18:36.214318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c1c90>]}
[0m00:18:36.215144 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:18:36.315016 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:18:36.413498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:18:36.413995 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:18:36.579841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1c2210>]}
[0m00:18:36.669384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e441fd0>]}
[0m00:18:36.672463 [info ] [MainThread]: Found 10 models, 2 snapshots, 2 sources, 459 macros
[0m00:18:36.672770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41c390>]}
[0m00:18:36.677272 [info ] [MainThread]: 
[0m00:18:36.678067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:18:36.681240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m00:18:36.691284 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m00:18:36.691584 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m00:18:36.691819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:38.267347 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.575 seconds
[0m00:18:38.270725 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m00:18:38.769310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m00:18:38.782525 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m00:18:38.782936 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m00:18:38.783177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:40.366280 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.582 seconds
[0m00:18:40.373110 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m00:18:40.866869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now list_NBA_GAMES_dev)
[0m00:18:40.875282 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_dev"
[0m00:18:40.875795 [debug] [ThreadPool]: On list_NBA_GAMES_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_dev"} */
show objects in NBA_GAMES.dev limit 10000
[0m00:18:40.876172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:42.324361 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.448 seconds
[0m00:18:42.329143 [debug] [ThreadPool]: On list_NBA_GAMES_dev: Close
[0m00:18:42.965998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3c2510>]}
[0m00:18:42.967891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:42.968760 [info ] [MainThread]: 
[0m00:18:42.973246 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_players
[0m00:18:42.974097 [info ] [Thread-1 (]: 1 of 2 START snapshot dev.scd_raw_players ...................................... [RUN]
[0m00:18:42.974759 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.nba_analysis.scd_raw_players'
[0m00:18:42.975378 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_players
[0m00:18:42.986496 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_players
[0m00:18:43.034698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:43.035099 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select player_name, season from (
                



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:18:43.035386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:44.425969 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.390 seconds
[0m00:18:44.439448 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:44.440713 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:18:44.720270 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.278 seconds
[0m00:18:44.728601 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:44.728967 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:18:44.988100 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.258 seconds
[0m00:18:45.031298 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:45.031918 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:18:46.233659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.201 seconds
[0m00:18:46.239218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:46.239811 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:18:46.515008 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.274 seconds
[0m00:18:46.522681 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:46.523298 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:18:46.787565 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.264 seconds
[0m00:18:46.795689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:46.796326 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:18:47.059708 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.263 seconds
[0m00:18:47.068362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:47.069135 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:18:47.360256 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.290 seconds
[0m00:18:47.368003 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:47.368432 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:18:48.079906 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.710 seconds
[0m00:18:48.103740 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:48.104503 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:18:48.415227 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.310 seconds
[0m00:18:48.420915 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:48.421433 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:18:48.676715 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.255 seconds
[0m00:18:48.678116 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_players"
[0m00:18:48.680619 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:48.681123 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
BEGIN
[0m00:18:49.000858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.319 seconds
[0m00:18:49.002212 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:18:49.002820 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:18:49.865363 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8635e-0102-3313-0006-c35e0004a0fa
[0m00:18:49.866411 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m00:18:49.867614 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: Close
[0m00:18:50.375982 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:18:50.379788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e55c950>]}
[0m00:18:50.381341 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting dev.scd_raw_players .................................. [[31mERROR[0m in 7.40s]
[0m00:18:50.382146 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_players
[0m00:18:50.382745 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_teams
[0m00:18:50.384587 [info ] [Thread-1 (]: 2 of 2 START snapshot dev.scd_raw_teams ........................................ [RUN]
[0m00:18:50.385172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.nba_analysis.scd_raw_players, now snapshot.nba_analysis.scd_raw_teams)
[0m00:18:50.385522 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_teams
[0m00:18:50.391083 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_teams
[0m00:18:50.395415 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:50.395805 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select league_id, min_year, max_year, team_abbreviation, team_nickname, year_founded, city, arena, arena_capacity, team_owner, general_manager, head_coach, dleague_affiliation from (
                



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:18:50.396136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:51.946803 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.550 seconds
[0m00:18:51.954581 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:51.955388 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:18:52.279274 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.323 seconds
[0m00:18:52.287060 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:52.287583 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:18:52.584625 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.296 seconds
[0m00:18:52.602078 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:52.603126 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:18:53.608839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.004 seconds
[0m00:18:53.613834 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:53.614435 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:18:53.912663 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.298 seconds
[0m00:18:53.917041 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:53.917448 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:18:54.224035 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.306 seconds
[0m00:18:54.232989 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:54.233843 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:18:54.528458 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.294 seconds
[0m00:18:54.535482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:54.536062 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:18:54.836978 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.300 seconds
[0m00:18:54.846666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:54.847332 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:18:55.144271 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.296 seconds
[0m00:18:55.163301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:55.164829 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:18:55.539433 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.373 seconds
[0m00:18:55.542559 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:55.543151 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:18:55.803162 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.259 seconds
[0m00:18:55.805827 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:55.810162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:55.810592 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
BEGIN
[0m00:18:56.108152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m00:18:56.109541 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:56.110046 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_TEAMS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:18:56.812935 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.702 seconds
[0m00:18:56.813825 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:18:56.814348 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
COMMIT
[0m00:18:57.902222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.087 seconds
[0m00:18:57.930758 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: Close
[0m00:18:58.978597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91cd04e5-75dc-40e6-8c3f-965290183d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e956710>]}
[0m00:18:58.980724 [info ] [Thread-1 (]: 2 of 2 OK snapshotted dev.scd_raw_teams ........................................ [[32mSUCCESS 0[0m in 8.59s]
[0m00:18:58.981757 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_teams
[0m00:18:58.984813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:58.985359 [debug] [MainThread]: Connection 'list_NBA_GAMES_dev' was properly closed.
[0m00:18:58.985698 [debug] [MainThread]: Connection 'snapshot.nba_analysis.scd_raw_teams' was properly closed.
[0m00:18:58.986218 [info ] [MainThread]: 
[0m00:18:58.986932 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 22.31 seconds (22.31s).
[0m00:18:58.987876 [debug] [MainThread]: Command end result
[0m00:18:59.023777 [info ] [MainThread]: 
[0m00:18:59.024179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:18:59.024490 [info ] [MainThread]: 
[0m00:18:59.024848 [error] [MainThread]:   Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:18:59.025119 [info ] [MainThread]: 
[0m00:18:59.025356 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:18:59.028133 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 23.906527, "process_user_time": 2.761875, "process_kernel_time": 0.553356, "process_mem_max_rss": "193085440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:18:59.028584 [debug] [MainThread]: Command `dbt snapshot` failed at 00:18:59.028527 after 23.91 seconds
[0m00:18:59.028933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b16c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b63d10>]}
[0m00:18:59.029209 [debug] [MainThread]: Flushing usage events
[0m00:19:37.026494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ff790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fff10>]}


============================== 00:19:37.030416 | e4bc0dcf-f7c4-4a75-b41d-f7efa7765276 ==============================
[0m00:19:37.030416 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:19:37.030880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:37.781032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4bc0dcf-f7c4-4a75-b41d-f7efa7765276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a12a90>]}
[0m00:19:37.813904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4bc0dcf-f7c4-4a75-b41d-f7efa7765276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e45e10>]}
[0m00:19:37.814657 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:19:37.912400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:19:38.009191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:38.009665 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:19:38.091345 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  expected token ',', got 'invalidate_hard_deletes'
    line 9
      invalidate_hard_deletes=True,
[0m00:19:38.094006 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1141044, "process_user_time": 1.545986, "process_kernel_time": 0.311729, "process_mem_max_rss": "189710336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:19:38.094420 [debug] [MainThread]: Command `dbt snapshot` failed at 00:19:38.094352 after 1.11 seconds
[0m00:19:38.094729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106517bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225b2f50>]}
[0m00:19:38.095005 [debug] [MainThread]: Flushing usage events
[0m00:19:51.499031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094aa150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c3e50>]}


============================== 00:19:51.502710 | baaa5f8c-92a6-4731-a9ca-7961819c5361 ==============================
[0m00:19:51.502710 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:19:51.503194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:52.197573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2e1a10>]}
[0m00:19:52.231087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d45c10>]}
[0m00:19:52.232380 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:19:52.332965 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:19:52.427366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:52.427874 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:19:52.590416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e6f6210>]}
[0m00:19:52.680124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e4a1750>]}
[0m00:19:52.680601 [info ] [MainThread]: Found 10 models, 2 snapshots, 2 sources, 459 macros
[0m00:19:52.680933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e794490>]}
[0m00:19:52.682473 [info ] [MainThread]: 
[0m00:19:52.682934 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:52.686039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m00:19:52.699075 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m00:19:52.699409 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m00:19:52.699631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:54.333251 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.633 seconds
[0m00:19:54.336958 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m00:19:54.951814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_dev)
[0m00:19:54.964463 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_dev"
[0m00:19:54.964919 [debug] [ThreadPool]: On list_NBA_GAMES_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_dev"} */
show objects in NBA_GAMES.dev limit 10000
[0m00:19:54.965245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:56.490858 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.525 seconds
[0m00:19:56.495465 [debug] [ThreadPool]: On list_NBA_GAMES_dev: Close
[0m00:19:56.996511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES_dev, now list_NBA_GAMES_DEV)
[0m00:19:57.001858 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m00:19:57.002271 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m00:19:57.002618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:58.397375 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.394 seconds
[0m00:19:58.401642 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m00:19:58.903498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093798d0>]}
[0m00:19:58.905064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:58.905660 [info ] [MainThread]: 
[0m00:19:58.910120 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_players
[0m00:19:58.910917 [info ] [Thread-1 (]: 1 of 2 START snapshot dev.scd_raw_players ...................................... [RUN]
[0m00:19:58.911725 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.nba_analysis.scd_raw_players'
[0m00:19:58.912299 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_players
[0m00:19:58.922457 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_players
[0m00:19:58.969625 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:19:58.970031 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select player_name, team_id, season from (
                



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:19:58.970380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:20:00.360604 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.390 seconds
[0m00:20:00.374267 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:00.374973 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:20:00.677383 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.302 seconds
[0m00:20:00.690057 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:00.690718 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:20:00.951417 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.260 seconds
[0m00:20:00.992858 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:00.993514 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:20:02.423525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.428 seconds
[0m00:20:02.430043 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:02.430683 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:20:02.727542 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.296 seconds
[0m00:20:02.736364 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:02.736978 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:20:03.003875 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.266 seconds
[0m00:20:03.011555 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:03.012142 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:20:03.341267 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.328 seconds
[0m00:20:03.349913 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:03.350736 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:20:03.651612 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.300 seconds
[0m00:20:03.663447 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:03.663946 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:20:03.956409 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.292 seconds
[0m00:20:03.983751 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:03.984419 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_NAME" != source_data."PLAYER_NAME"
        or
        (
            ((snapshotted_data."PLAYER_NAME" is null) and not (source_data."PLAYER_NAME" is null))
            or
            ((not snapshotted_data."PLAYER_NAME" is null) and (source_data."PLAYER_NAME" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:04.332839 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.347 seconds
[0m00:20:04.338874 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:04.339407 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:04.667955 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.328 seconds
[0m00:20:04.669530 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_players"
[0m00:20:04.673219 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:04.673776 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
BEGIN
[0m00:20:04.980534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m00:20:04.982234 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:20:04.983236 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:20:06.689342 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86360-0102-3313-0006-c35e0004a12a
[0m00:20:06.690286 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m00:20:06.691019 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: Close
[0m00:20:07.259079 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:20:07.261694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e618990>]}
[0m00:20:07.262900 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting dev.scd_raw_players .................................. [[31mERROR[0m in 8.35s]
[0m00:20:07.263651 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_players
[0m00:20:07.264156 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_teams
[0m00:20:07.265515 [info ] [Thread-1 (]: 2 of 2 START snapshot dev.scd_raw_teams ........................................ [RUN]
[0m00:20:07.266052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.nba_analysis.scd_raw_players, now snapshot.nba_analysis.scd_raw_teams)
[0m00:20:07.266411 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_teams
[0m00:20:07.271457 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_teams
[0m00:20:07.276124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:07.276585 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select league_id, min_year, max_year, team_abbreviation, team_nickname, year_founded, city, arena, arena_capacity, team_owner, general_manager, head_coach, dleague_affiliation from (
                



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:07.276929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:08.776993 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.500 seconds
[0m00:20:08.783117 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:08.783969 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:20:09.067952 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.283 seconds
[0m00:20:09.076871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:09.077527 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:20:09.346068 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.268 seconds
[0m00:20:09.365964 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:09.367043 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:20:10.470381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m00:20:10.475889 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:10.476449 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:20:10.751776 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.275 seconds
[0m00:20:10.759242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:10.759902 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:20:11.086093 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.325 seconds
[0m00:20:11.094763 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:11.095404 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:20:11.384027 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.288 seconds
[0m00:20:11.392494 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:11.393080 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:20:11.660128 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.266 seconds
[0m00:20:11.669471 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:11.670120 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:20:11.922836 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.252 seconds
[0m00:20:11.941155 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:11.942403 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:12.358044 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.413 seconds
[0m00:20:12.361847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:12.362822 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:12.664255 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.301 seconds
[0m00:20:12.666214 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:12.669609 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:12.670149 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
BEGIN
[0m00:20:13.005657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m00:20:13.006938 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:13.007601 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_TEAMS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:20:13.685339 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.677 seconds
[0m00:20:13.686949 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:20:13.687495 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
COMMIT
[0m00:20:14.133836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m00:20:14.165785 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: Close
[0m00:20:14.720141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baaa5f8c-92a6-4731-a9ca-7961819c5361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e7e8f50>]}
[0m00:20:14.722739 [info ] [Thread-1 (]: 2 of 2 OK snapshotted dev.scd_raw_teams ........................................ [[32mSUCCESS 0[0m in 7.45s]
[0m00:20:14.723934 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_teams
[0m00:20:14.726920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:14.727414 [debug] [MainThread]: Connection 'list_NBA_GAMES_DEV' was properly closed.
[0m00:20:14.727703 [debug] [MainThread]: Connection 'snapshot.nba_analysis.scd_raw_teams' was properly closed.
[0m00:20:14.728203 [info ] [MainThread]: 
[0m00:20:14.728560 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 22.05 seconds (22.05s).
[0m00:20:14.729671 [debug] [MainThread]: Command end result
[0m00:20:14.772052 [info ] [MainThread]: 
[0m00:20:14.772555 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:20:14.772933 [info ] [MainThread]: 
[0m00:20:14.773323 [error] [MainThread]:   Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:20:14.773587 [info ] [MainThread]: 
[0m00:20:14.773868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:20:14.778104 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 23.319828, "process_user_time": 2.757011, "process_kernel_time": 0.409171, "process_mem_max_rss": "194166784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:20:14.778945 [debug] [MainThread]: Command `dbt snapshot` failed at 00:20:14.778858 after 23.32 seconds
[0m00:20:14.779392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094dbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e340390>]}
[0m00:20:14.779790 [debug] [MainThread]: Flushing usage events
[0m00:22:08.608379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108987a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a3f90>]}


============================== 00:22:08.612580 | 8f33c462-5a4a-4e51-ab2c-86f7b869329d ==============================
[0m00:22:08.612580 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:22:08.613059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:22:09.447571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108967e50>]}
[0m00:22:09.484462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e5e10>]}
[0m00:22:09.485675 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:22:09.589149 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:22:09.687833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:22:09.688413 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:22:09.853027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddfa090>]}
[0m00:22:09.937919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e245690>]}
[0m00:22:09.938348 [info ] [MainThread]: Found 10 models, 2 snapshots, 2 sources, 459 macros
[0m00:22:09.938623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfe9f90>]}
[0m00:22:09.939934 [info ] [MainThread]: 
[0m00:22:09.940338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:22:09.943263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m00:22:09.953526 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m00:22:09.953819 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m00:22:09.954035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:11.915011 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.960 seconds
[0m00:22:11.918840 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m00:22:12.438043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m00:22:12.449464 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m00:22:12.449886 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m00:22:12.450151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:14.332036 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.882 seconds
[0m00:22:14.337232 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m00:22:14.832994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now list_NBA_GAMES_dev)
[0m00:22:14.839023 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_dev"
[0m00:22:14.839408 [debug] [ThreadPool]: On list_NBA_GAMES_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_dev"} */
show objects in NBA_GAMES.dev limit 10000
[0m00:22:14.839699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:16.345817 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.506 seconds
[0m00:22:16.350337 [debug] [ThreadPool]: On list_NBA_GAMES_dev: Close
[0m00:22:16.855095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dabb50>]}
[0m00:22:16.856400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:22:16.856900 [info ] [MainThread]: 
[0m00:22:16.860802 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_players
[0m00:22:16.861419 [info ] [Thread-1 (]: 1 of 2 START snapshot dev.scd_raw_players ...................................... [RUN]
[0m00:22:16.862304 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.nba_analysis.scd_raw_players'
[0m00:22:16.862662 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_players
[0m00:22:16.871098 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_players
[0m00:22:16.920358 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:16.920773 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select player_id, team_id, season from (
                



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:16.921063 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:22:18.301592 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.379 seconds
[0m00:22:18.317362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:18.318077 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:22:18.576474 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.257 seconds
[0m00:22:18.590995 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:18.591580 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:22:18.905243 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.313 seconds
[0m00:22:18.950476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:18.951094 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:22:20.167714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.216 seconds
[0m00:22:20.175289 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:20.175995 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:22:20.434175 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.258 seconds
[0m00:22:20.441057 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:20.441580 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:22:20.825039 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.383 seconds
[0m00:22:20.833232 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:20.834090 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:22:21.175248 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.337 seconds
[0m00:22:21.182776 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:21.183406 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:22:21.501510 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.317 seconds
[0m00:22:21.514910 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:21.515526 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:22:21.852609 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.336 seconds
[0m00:22:21.880060 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:21.880780 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(player_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        player_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:22.218664 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.337 seconds
[0m00:22:22.224335 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:22.224933 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:22.536601 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.311 seconds
[0m00:22:22.538992 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_players"
[0m00:22:22.541833 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:22.542422 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
BEGIN
[0m00:22:22.890428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m00:22:22.891215 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:22:22.891681 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:22:23.776966 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86362-0102-3227-0006-c35e00049186
[0m00:22:23.777620 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m00:22:23.778446 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: Close
[0m00:22:24.286905 [debug] [Thread-1 (]: Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:22:24.289366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5b2890>]}
[0m00:22:24.290634 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting dev.scd_raw_players .................................. [[31mERROR[0m in 7.43s]
[0m00:22:24.291297 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_players
[0m00:22:24.291788 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_teams
[0m00:22:24.293148 [info ] [Thread-1 (]: 2 of 2 START snapshot dev.scd_raw_teams ........................................ [RUN]
[0m00:22:24.293549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.nba_analysis.scd_raw_players, now snapshot.nba_analysis.scd_raw_teams)
[0m00:22:24.293846 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_teams
[0m00:22:24.299041 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_teams
[0m00:22:24.304082 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:24.304547 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select league_id, min_year, max_year, team_abbreviation, team_nickname, year_founded, city, arena, arena_capacity, team_owner, general_manager, head_coach, dleague_affiliation from (
                



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:24.305066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:25.857912 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.552 seconds
[0m00:22:25.871244 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:25.872205 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:22:26.146876 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.273 seconds
[0m00:22:26.154428 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:26.154978 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:22:26.409259 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.254 seconds
[0m00:22:26.429087 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:26.430645 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:22:27.430542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.998 seconds
[0m00:22:27.439036 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:27.439658 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:22:27.713128 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.272 seconds
[0m00:22:27.728376 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:27.729072 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:22:28.000840 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.271 seconds
[0m00:22:28.006956 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:28.007520 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:22:28.269209 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.261 seconds
[0m00:22:28.275740 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:28.276378 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:22:28.590552 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.313 seconds
[0m00:22:28.599312 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:28.599916 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:22:28.913803 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.313 seconds
[0m00:22:28.929919 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:28.931646 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:29.326093 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.393 seconds
[0m00:22:29.328045 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:29.328595 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:29.609525 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.280 seconds
[0m00:22:29.611568 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:29.616485 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:29.617122 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
BEGIN
[0m00:22:29.938262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m00:22:29.939215 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:29.939727 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_TEAMS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:22:30.558155 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.618 seconds
[0m00:22:30.559284 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:22:30.559813 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
COMMIT
[0m00:22:30.965314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m00:22:30.995164 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: Close
[0m00:22:31.508232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f33c462-5a4a-4e51-ab2c-86f7b869329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f7dd0>]}
[0m00:22:31.510204 [info ] [Thread-1 (]: 2 of 2 OK snapshotted dev.scd_raw_teams ........................................ [[32mSUCCESS 0[0m in 7.21s]
[0m00:22:31.511145 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_teams
[0m00:22:31.513692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:31.514076 [debug] [MainThread]: Connection 'list_NBA_GAMES_dev' was properly closed.
[0m00:22:31.514367 [debug] [MainThread]: Connection 'snapshot.nba_analysis.scd_raw_teams' was properly closed.
[0m00:22:31.514801 [info ] [MainThread]: 
[0m00:22:31.515246 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 21.57 seconds (21.57s).
[0m00:22:31.516121 [debug] [MainThread]: Command end result
[0m00:22:31.560837 [info ] [MainThread]: 
[0m00:22:31.561324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:22:31.561563 [info ] [MainThread]: 
[0m00:22:31.561942 [error] [MainThread]:   Database Error in snapshot scd_raw_players (snapshots/scd_raw_players.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/nba_analysis/snapshots/scd_raw_players.sql
[0m00:22:31.562309 [info ] [MainThread]: 
[0m00:22:31.562669 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:22:31.569853 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 23.015013, "process_user_time": 2.71579, "process_kernel_time": 0.521469, "process_mem_max_rss": "189218816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:22:31.571126 [debug] [MainThread]: Command `dbt snapshot` failed at 00:22:31.571010 after 23.02 seconds
[0m00:22:31.571684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a2e50>]}
[0m00:22:31.571983 [debug] [MainThread]: Flushing usage events
[0m00:24:36.060048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965d1d0>]}


============================== 00:24:36.064059 | 115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a ==============================
[0m00:24:36.064059 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:24:36.064534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yogisharosarumaha/Documents/nba_analysis/logs', 'profiles_dir': '/Users/yogisharosarumaha/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:24:36.821506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194ede10>]}
[0m00:24:36.854613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f45d10>]}
[0m00:24:36.855353 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:24:36.952352 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:24:37.050272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:24:37.050763 [debug] [MainThread]: Partial parsing: updated file: nba_analysis://snapshots/scd_raw_players.sql
[0m00:24:37.213806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a18a810>]}
[0m00:24:37.296800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a36fcd0>]}
[0m00:24:37.297201 [info ] [MainThread]: Found 10 models, 2 snapshots, 2 sources, 459 macros
[0m00:24:37.297466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1d0ad0>]}
[0m00:24:37.298763 [info ] [MainThread]: 
[0m00:24:37.299155 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:37.302055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_GAMES'
[0m00:24:37.312089 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES"
[0m00:24:37.312409 [debug] [ThreadPool]: On list_NBA_GAMES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES"} */
show terse schemas in database NBA_GAMES
    limit 10000
[0m00:24:37.312640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:39.328450 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.016 seconds
[0m00:24:39.332074 [debug] [ThreadPool]: On list_NBA_GAMES: Close
[0m00:24:39.933796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES, now list_NBA_GAMES_DEV)
[0m00:24:39.946994 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_DEV"
[0m00:24:39.947490 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_DEV"} */
show objects in NBA_GAMES.DEV limit 10000
[0m00:24:39.947816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:41.381919 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.434 seconds
[0m00:24:41.386731 [debug] [ThreadPool]: On list_NBA_GAMES_DEV: Close
[0m00:24:41.913463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA_GAMES_DEV, now list_NBA_GAMES_dev)
[0m00:24:41.921629 [debug] [ThreadPool]: Using snowflake connection "list_NBA_GAMES_dev"
[0m00:24:41.922161 [debug] [ThreadPool]: On list_NBA_GAMES_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "connection_name": "list_NBA_GAMES_dev"} */
show objects in NBA_GAMES.dev limit 10000
[0m00:24:41.922537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:43.510570 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.588 seconds
[0m00:24:43.514807 [debug] [ThreadPool]: On list_NBA_GAMES_dev: Close
[0m00:24:44.134177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e7590>]}
[0m00:24:44.134884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:44.135222 [info ] [MainThread]: 
[0m00:24:44.138358 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_players
[0m00:24:44.138920 [info ] [Thread-1 (]: 1 of 2 START snapshot dev.scd_raw_players ...................................... [RUN]
[0m00:24:44.139439 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.nba_analysis.scd_raw_players'
[0m00:24:44.139729 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_players
[0m00:24:44.147102 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_players
[0m00:24:44.190472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:44.190820 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select player_id, team_id, season from (
                



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:44.191154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:24:45.661923 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.470 seconds
[0m00:24:45.678789 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:45.679597 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:24:45.971487 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.291 seconds
[0m00:24:45.983480 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:45.983931 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:24:46.276412 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.292 seconds
[0m00:24:46.321034 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:46.321632 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(concat(player_id, team_id, season) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:24:47.198045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.875 seconds
[0m00:24:47.204216 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:47.204843 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:24:47.467175 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.262 seconds
[0m00:24:47.477932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:47.478469 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:24:47.811434 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.332 seconds
[0m00:24:47.816894 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:47.817389 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:24:48.119091 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.301 seconds
[0m00:24:48.124694 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:48.125179 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
[0m00:24:48.379239 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.253 seconds
[0m00:24:48.388379 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:48.388754 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp"
[0m00:24:48.731468 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.342 seconds
[0m00:24:48.758491 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:48.759171 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    PLAYER_NAME AS player_name,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(PLAYER_ID AS INT) AS player_id,
    CAST(SEASON AS INT) AS season
FROM nba_games.raw.players


    ),

    snapshotted_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(concat(player_id, team_id, season) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        concat(player_id, team_id, season) as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PLAYER_ID" != source_data."PLAYER_ID"
        or
        (
            ((snapshotted_data."PLAYER_ID" is null) and not (source_data."PLAYER_ID" is null))
            or
            ((not snapshotted_data."PLAYER_ID" is null) and (source_data."PLAYER_ID" is null))
        ) or snapshotted_data."TEAM_ID" != source_data."TEAM_ID"
        or
        (
            ((snapshotted_data."TEAM_ID" is null) and not (source_data."TEAM_ID" is null))
            or
            ((not snapshotted_data."TEAM_ID" is null) and (source_data."TEAM_ID" is null))
        ) or snapshotted_data."SEASON" != source_data."SEASON"
        or
        (
            ((snapshotted_data."SEASON" is null) and not (source_data."SEASON" is null))
            or
            ((not snapshotted_data."SEASON" is null) and (source_data."SEASON" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:49.095945 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.336 seconds
[0m00:24:49.102719 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:49.103298 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:49.363744 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.260 seconds
[0m00:24:49.365128 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_players"
[0m00:24:49.368709 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:49.369303 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
BEGIN
[0m00:24:49.652185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m00:24:49.653701 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:49.654831 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_PLAYERS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PLAYER_NAME", "TEAM_ID", "PLAYER_ID", "SEASON", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:24:50.370863 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.715 seconds
[0m00:24:50.372195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_players"
[0m00:24:50.372742 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_players"} */
COMMIT
[0m00:24:50.772427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m00:24:50.794887 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_players: Close
[0m00:24:51.287261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a44de50>]}
[0m00:24:51.288420 [info ] [Thread-1 (]: 1 of 2 OK snapshotted dev.scd_raw_players ...................................... [[32mSUCCESS 0[0m in 7.15s]
[0m00:24:51.289171 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_players
[0m00:24:51.289679 [debug] [Thread-1 (]: Began running node snapshot.nba_analysis.scd_raw_teams
[0m00:24:51.290341 [info ] [Thread-1 (]: 2 of 2 START snapshot dev.scd_raw_teams ........................................ [RUN]
[0m00:24:51.290915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.nba_analysis.scd_raw_players, now snapshot.nba_analysis.scd_raw_teams)
[0m00:24:51.291348 [debug] [Thread-1 (]: Began compiling node snapshot.nba_analysis.scd_raw_teams
[0m00:24:51.296040 [debug] [Thread-1 (]: Began executing node snapshot.nba_analysis.scd_raw_teams
[0m00:24:51.300607 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:51.301033 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select league_id, min_year, max_year, team_abbreviation, team_nickname, year_founded, city, arena, arena_capacity, team_owner, general_manager, head_coach, dleague_affiliation from (
                



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:51.301429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:52.617557 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.316 seconds
[0m00:24:52.625377 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:52.626216 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:24:52.908035 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.281 seconds
[0m00:24:52.916274 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:52.916832 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:24:53.177180 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.260 seconds
[0m00:24:53.200387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:53.201647 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
create or replace temporary table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:24:54.057140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m00:24:54.062703 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:54.063208 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:24:54.363507 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.300 seconds
[0m00:24:54.369712 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:54.370135 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:24:54.674498 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.304 seconds
[0m00:24:54.682750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:54.683499 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:24:54.953829 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.269 seconds
[0m00:24:54.962763 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:54.963287 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
[0m00:24:55.223968 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.260 seconds
[0m00:24:55.231881 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:55.232451 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
describe table "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp"
[0m00:24:55.488069 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.255 seconds
[0m00:24:55.502239 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:55.503274 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    CAST(LEAGUE_ID AS INT) AS league_id,
    CAST(TEAM_ID AS INT) AS team_id,
    CAST(MIN_YEAR AS INT) AS min_year,
    CAST(MAX_YEAR AS INT) AS max_year,
    ABBREVIATION AS team_abbreviation,
    NICKNAME AS team_nickname,
    CAST(YEARFOUNDED AS INT) AS year_founded,
    CITY AS city,
    ARENA AS arena,
    ARENACAPACITY AS arena_capacity,
    OWNER AS team_owner,
    GENERALMANAGER AS general_manager,
    HEADCOACH AS head_coach,
    DLEAGUEAFFILIATION AS dleague_affiliation
FROM nba_games.raw.teams


    ),

    snapshotted_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from "NBA_GAMES"."DEV"."SCD_RAW_TEAMS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(team_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        team_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."LEAGUE_ID" != source_data."LEAGUE_ID"
        or
        (
            ((snapshotted_data."LEAGUE_ID" is null) and not (source_data."LEAGUE_ID" is null))
            or
            ((not snapshotted_data."LEAGUE_ID" is null) and (source_data."LEAGUE_ID" is null))
        ) or snapshotted_data."MIN_YEAR" != source_data."MIN_YEAR"
        or
        (
            ((snapshotted_data."MIN_YEAR" is null) and not (source_data."MIN_YEAR" is null))
            or
            ((not snapshotted_data."MIN_YEAR" is null) and (source_data."MIN_YEAR" is null))
        ) or snapshotted_data."MAX_YEAR" != source_data."MAX_YEAR"
        or
        (
            ((snapshotted_data."MAX_YEAR" is null) and not (source_data."MAX_YEAR" is null))
            or
            ((not snapshotted_data."MAX_YEAR" is null) and (source_data."MAX_YEAR" is null))
        ) or snapshotted_data."TEAM_ABBREVIATION" != source_data."TEAM_ABBREVIATION"
        or
        (
            ((snapshotted_data."TEAM_ABBREVIATION" is null) and not (source_data."TEAM_ABBREVIATION" is null))
            or
            ((not snapshotted_data."TEAM_ABBREVIATION" is null) and (source_data."TEAM_ABBREVIATION" is null))
        ) or snapshotted_data."TEAM_NICKNAME" != source_data."TEAM_NICKNAME"
        or
        (
            ((snapshotted_data."TEAM_NICKNAME" is null) and not (source_data."TEAM_NICKNAME" is null))
            or
            ((not snapshotted_data."TEAM_NICKNAME" is null) and (source_data."TEAM_NICKNAME" is null))
        ) or snapshotted_data."YEAR_FOUNDED" != source_data."YEAR_FOUNDED"
        or
        (
            ((snapshotted_data."YEAR_FOUNDED" is null) and not (source_data."YEAR_FOUNDED" is null))
            or
            ((not snapshotted_data."YEAR_FOUNDED" is null) and (source_data."YEAR_FOUNDED" is null))
        ) or snapshotted_data."CITY" != source_data."CITY"
        or
        (
            ((snapshotted_data."CITY" is null) and not (source_data."CITY" is null))
            or
            ((not snapshotted_data."CITY" is null) and (source_data."CITY" is null))
        ) or snapshotted_data."ARENA" != source_data."ARENA"
        or
        (
            ((snapshotted_data."ARENA" is null) and not (source_data."ARENA" is null))
            or
            ((not snapshotted_data."ARENA" is null) and (source_data."ARENA" is null))
        ) or snapshotted_data."ARENA_CAPACITY" != source_data."ARENA_CAPACITY"
        or
        (
            ((snapshotted_data."ARENA_CAPACITY" is null) and not (source_data."ARENA_CAPACITY" is null))
            or
            ((not snapshotted_data."ARENA_CAPACITY" is null) and (source_data."ARENA_CAPACITY" is null))
        ) or snapshotted_data."TEAM_OWNER" != source_data."TEAM_OWNER"
        or
        (
            ((snapshotted_data."TEAM_OWNER" is null) and not (source_data."TEAM_OWNER" is null))
            or
            ((not snapshotted_data."TEAM_OWNER" is null) and (source_data."TEAM_OWNER" is null))
        ) or snapshotted_data."GENERAL_MANAGER" != source_data."GENERAL_MANAGER"
        or
        (
            ((snapshotted_data."GENERAL_MANAGER" is null) and not (source_data."GENERAL_MANAGER" is null))
            or
            ((not snapshotted_data."GENERAL_MANAGER" is null) and (source_data."GENERAL_MANAGER" is null))
        ) or snapshotted_data."HEAD_COACH" != source_data."HEAD_COACH"
        or
        (
            ((snapshotted_data."HEAD_COACH" is null) and not (source_data."HEAD_COACH" is null))
            or
            ((not snapshotted_data."HEAD_COACH" is null) and (source_data."HEAD_COACH" is null))
        ) or snapshotted_data."DLEAGUE_AFFILIATION" != source_data."DLEAGUE_AFFILIATION"
        or
        (
            ((snapshotted_data."DLEAGUE_AFFILIATION" is null) and not (source_data."DLEAGUE_AFFILIATION" is null))
            or
            ((not snapshotted_data."DLEAGUE_AFFILIATION" is null) and (source_data."DLEAGUE_AFFILIATION" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:55.957542 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.453 seconds
[0m00:24:55.960075 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:55.960674 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:56.299228 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.338 seconds
[0m00:24:56.300628 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:56.304375 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:56.304963 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
BEGIN
[0m00:24:56.617808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m00:24:56.619279 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:56.619935 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
merge into "NBA_GAMES"."DEV"."SCD_RAW_TEAMS" as DBT_INTERNAL_DEST
    using "NBA_GAMES"."DEV"."SCD_RAW_TEAMS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("LEAGUE_ID", "TEAM_ID", "MIN_YEAR", "MAX_YEAR", "TEAM_ABBREVIATION", "TEAM_NICKNAME", "YEAR_FOUNDED", "CITY", "ARENA", "ARENA_CAPACITY", "TEAM_OWNER", "GENERAL_MANAGER", "HEAD_COACH", "DLEAGUE_AFFILIATION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:24:57.224290 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.603 seconds
[0m00:24:57.225708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.nba_analysis.scd_raw_teams"
[0m00:24:57.226280 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba_analysis", "target_name": "dev", "node_id": "snapshot.nba_analysis.scd_raw_teams"} */
COMMIT
[0m00:24:57.663796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m00:24:57.668839 [debug] [Thread-1 (]: On snapshot.nba_analysis.scd_raw_teams: Close
[0m00:24:58.203274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115cbcdc-2320-4b0c-b1ed-2d9c80cf7b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197a1b10>]}
[0m00:24:58.204553 [info ] [Thread-1 (]: 2 of 2 OK snapshotted dev.scd_raw_teams ........................................ [[32mSUCCESS 0[0m in 6.91s]
[0m00:24:58.205293 [debug] [Thread-1 (]: Finished running node snapshot.nba_analysis.scd_raw_teams
[0m00:24:58.206776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:58.207218 [debug] [MainThread]: Connection 'list_NBA_GAMES_dev' was properly closed.
[0m00:24:58.207558 [debug] [MainThread]: Connection 'snapshot.nba_analysis.scd_raw_teams' was properly closed.
[0m00:24:58.207990 [info ] [MainThread]: 
[0m00:24:58.208380 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 20.91 seconds (20.91s).
[0m00:24:58.209136 [debug] [MainThread]: Command end result
[0m00:24:58.242071 [info ] [MainThread]: 
[0m00:24:58.242431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:24:58.242662 [info ] [MainThread]: 
[0m00:24:58.242913 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:24:58.245410 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 22.232962, "process_user_time": 2.748371, "process_kernel_time": 0.427124, "process_mem_max_rss": "195149824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:24:58.245820 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:24:58.245743 after 22.23 seconds
[0m00:24:58.246093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105301c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525cd10>]}
[0m00:24:58.246352 [debug] [MainThread]: Flushing usage events
